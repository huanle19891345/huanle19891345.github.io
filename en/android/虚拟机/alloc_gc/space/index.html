<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.80.0" />
    <meta name="description" content="Documentation for Hugo Learn Theme">
<meta name="author" content="Mathieu Cornic">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Space :: 郑欢的学习总结</title>

    
    <link href="/css/nucleus.css?1617797149" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1617797149" rel="stylesheet">
    <link href="/css/hybrid.css?1617797149" rel="stylesheet">
    <link href="/css/featherlight.min.css?1617797149" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1617797149" rel="stylesheet">
    <link href="/css/auto-complete.css?1617797149" rel="stylesheet">
    <link href="/css/atom-one-dark.css?1617797149" rel="stylesheet">
    <link href="/css/theme.css?1617797149" rel="stylesheet">
    <link href="/css/hugo-theme.css?1617797149" rel="stylesheet">
    
    <link href="/css/theme-mine.css?1617797149" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1617797149"></script>

    <script src="/js/auto_toc_scroll.js?1617797149"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    

  </head>
  <body class="" data-url="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/space/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='/en'>
    <img src="/avatar.png" width="60px" />
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1617797149"></script>
<script type="text/javascript" src="/js/auto-complete.js?1617797149"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/huanle19891345.github.io\/\/en";
    
</script>
<script type="text/javascript" src="/js/search.js?1617797149"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/en/android/" title="android" class="dd-item
        parent
        
        
        ">
      <a href="/en/android/">
          android
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/aop/" title="aop" class="dd-item
        
        
        
        ">
      <a href="/en/android/aop/">
          aop
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/aop/asm%E8%AE%BF%E5%AE%A2%E8%80%85%E6%A8%A1%E5%BC%8F/" title="ASM访客者模式" class="dd-item ">
        <a href="/en/android/aop/asm%E8%AE%BF%E5%AE%A2%E8%80%85%E6%A8%A1%E5%BC%8F/">
        ASM访客者模式
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/aop/jdk%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" title="JDK动态代理" class="dd-item ">
        <a href="/en/android/aop/jdk%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">
        JDK动态代理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/aop/%E7%BC%96%E8%AF%91%E6%8F%92%E6%A1%A9%E5%92%8C%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" title="编译插桩和动态代理" class="dd-item ">
        <a href="/en/android/aop/%E7%BC%96%E8%AF%91%E6%8F%92%E6%A1%A9%E5%92%8C%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">
        编译插桩和动态代理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/gradlejenkins/" title="gradlejenkins" class="dd-item
        
        
        
        ">
      <a href="/en/android/gradlejenkins/">
          gradlejenkins
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/androidplugin/" title="AndroidPlugin" class="dd-item ">
        <a href="/en/android/gradlejenkins/androidplugin/">
        AndroidPlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/gradlejenkins/android%E6%89%93%E5%8C%85/" title="android打包" class="dd-item
        
        
        
        ">
      <a href="/en/android/gradlejenkins/android%E6%89%93%E5%8C%85/">
          android打包
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/android%E6%89%93%E5%8C%85/android%E6%89%93%E5%8C%85/" title="Android打包" class="dd-item ">
        <a href="/en/android/gradlejenkins/android%E6%89%93%E5%8C%85/android%E6%89%93%E5%8C%85/">
        Android打包
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/gradledebug/" title="GradleDebug" class="dd-item ">
        <a href="/en/android/gradlejenkins/gradledebug/">
        GradleDebug
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/gradleplugin/" title="GradlePlugin" class="dd-item ">
        <a href="/en/android/gradlejenkins/gradleplugin/">
        GradlePlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/gradle%E6%89%93%E5%8C%85%E8%BF%87%E7%A8%8B/" title="Gradle打包过程" class="dd-item ">
        <a href="/en/android/gradlejenkins/gradle%E6%89%93%E5%8C%85%E8%BF%87%E7%A8%8B/">
        Gradle打包过程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/transform/" title="Transform" class="dd-item ">
        <a href="/en/android/gradlejenkins/transform/">
        Transform
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/" title="jetpack" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/">
          jetpack
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/" title="arch" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/">
          arch
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/coroutines/" title="Coroutines" class="dd-item ">
        <a href="/en/android/jetpack/arch/coroutines/">
        Coroutines
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/databinding/" title="databinding" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/databinding/">
          databinding
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/databinding/databinding/" title="Databinding" class="dd-item ">
        <a href="/en/android/jetpack/arch/databinding/databinding/">
        Databinding
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/databinding/twowaydatabinding/" title="TwoWayDataBinding" class="dd-item ">
        <a href="/en/android/jetpack/arch/databinding/twowaydatabinding/">
        TwoWayDataBinding
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/di/" title="di" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/di/">
          di
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/di/di/" title="DI" class="dd-item ">
        <a href="/en/android/jetpack/arch/di/di/">
        DI
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/di/hiltsource/" title="HiltSource" class="dd-item ">
        <a href="/en/android/jetpack/arch/di/hiltsource/">
        HiltSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/lifecycle/" title="lifecycle" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/lifecycle/">
          lifecycle
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/lifecycle/lifecycle/" title="Lifecycle" class="dd-item ">
        <a href="/en/android/jetpack/arch/lifecycle/lifecycle/">
        Lifecycle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/lifecycle/lifecyclecoroutine/" title="LifecycleCoroutine" class="dd-item ">
        <a href="/en/android/jetpack/arch/lifecycle/lifecyclecoroutine/">
        LifecycleCoroutine
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/livedata/" title="livedata" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/livedata/">
          livedata
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/livedata/livedata/" title="LiveData" class="dd-item ">
        <a href="/en/android/jetpack/arch/livedata/livedata/">
        LiveData
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/livedata/livedatacoroutine/" title="LiveDataCoroutine" class="dd-item ">
        <a href="/en/android/jetpack/arch/livedata/livedatacoroutine/">
        LiveDataCoroutine
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/livedata/mediatorlivedata/" title="MediatorLiveData" class="dd-item ">
        <a href="/en/android/jetpack/arch/livedata/mediatorlivedata/">
        MediatorLiveData
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/livedata/transformations/" title="Transformations" class="dd-item ">
        <a href="/en/android/jetpack/arch/livedata/transformations/">
        Transformations
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/viewmodel/" title="viewmodel" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/viewmodel/">
          viewmodel
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/viewmodel/saveandrestoreinstancestate/" title="SaveAndRestoreInstanceState" class="dd-item ">
        <a href="/en/android/jetpack/arch/viewmodel/saveandrestoreinstancestate/">
        SaveAndRestoreInstanceState
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/viewmodel/savedstatehandle/" title="SavedStateHandle" class="dd-item ">
        <a href="/en/android/jetpack/arch/viewmodel/savedstatehandle/">
        SavedStateHandle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/viewmodel/savingstates/" title="SavingStates" class="dd-item ">
        <a href="/en/android/jetpack/arch/viewmodel/savingstates/">
        SavingStates
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/viewmodel/viewmodel/" title="ViewModel" class="dd-item ">
        <a href="/en/android/jetpack/arch/viewmodel/viewmodel/">
        ViewModel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/viewmodel/viewmodelscope_delegate/" title="ViewModelScope_Delegate" class="dd-item ">
        <a href="/en/android/jetpack/arch/viewmodel/viewmodelscope_delegate/">
        ViewModelScope_Delegate
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/" title="架构实现" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/">
          架构实现
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/kaptgenerateviewmodel/" title="KaptGenerateViewModel" class="dd-item ">
        <a href="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/kaptgenerateviewmodel/">
        KaptGenerateViewModel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/%E6%9E%B6%E6%9E%84%E6%80%9D%E8%80%83%E5%92%8C%E5%AE%9E%E7%8E%B0/" title="架构思考和实现" class="dd-item ">
        <a href="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/%E6%9E%B6%E6%9E%84%E6%80%9D%E8%80%83%E5%92%8C%E5%AE%9E%E7%8E%B0/">
        架构思考和实现
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/compose/" title="compose" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/compose/">
          compose
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/compose/compose/" title="Compose" class="dd-item ">
        <a href="/en/android/jetpack/compose/compose/">
        Compose
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/compose/composesource/" title="ComposeSource" class="dd-item ">
        <a href="/en/android/jetpack/compose/composesource/">
        ComposeSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/compose/layoutnode/" title="LayoutNode" class="dd-item ">
        <a href="/en/android/jetpack/compose/layoutnode/">
        LayoutNode
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/compose/recomposition/" title="ReComposition" class="dd-item ">
        <a href="/en/android/jetpack/compose/recomposition/">
        ReComposition
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/supporttoandroidx/" title="SupportToAndroidx" class="dd-item ">
        <a href="/en/android/jetpack/supporttoandroidx/">
        SupportToAndroidx
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/ndk/" title="ndk" class="dd-item
        
        
        
        ">
      <a href="/en/android/ndk/">
          ndk
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/ndk/elf%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/" title="ELF文件结构" class="dd-item ">
        <a href="/en/android/ndk/elf%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/">
        ELF文件结构
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/ndk/jni/" title="JNI" class="dd-item ">
        <a href="/en/android/ndk/jni/">
        JNI
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/ndk/native_hook/" title="native_hook" class="dd-item ">
        <a href="/en/android/ndk/native_hook/">
        native_hook
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/ui/" title="ui" class="dd-item
        
        
        
        ">
      <a href="/en/android/ui/">
          ui
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/ui/webview/" title="webview" class="dd-item
        
        
        
        ">
      <a href="/en/android/ui/webview/">
          webview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/ui/webview/webview/" title="WebView" class="dd-item ">
        <a href="/en/android/ui/webview/webview/">
        WebView
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/ui/%E5%8A%A8%E7%94%BB/" title="动画" class="dd-item
        
        
        
        ">
      <a href="/en/android/ui/%E5%8A%A8%E7%94%BB/">
          动画
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/ui/%E5%8A%A8%E7%94%BB/animatorsource/" title="AnimatorSource" class="dd-item ">
        <a href="/en/android/ui/%E5%8A%A8%E7%94%BB/animatorsource/">
        AnimatorSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%8C%85%E4%BD%93%E7%A7%AF/" title="包体积" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%8C%85%E4%BD%93%E7%A7%AF/">
          包体积
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%8C%85%E4%BD%93%E7%A7%AF/%E5%8C%85%E4%BD%93%E7%A7%AF%E5%8E%8B%E7%BC%A9/" title="包体积压缩" class="dd-item ">
        <a href="/en/android/%E5%8C%85%E4%BD%93%E7%A7%AF/%E5%8C%85%E4%BD%93%E7%A7%AF%E5%8E%8B%E7%BC%A9/">
        包体积压缩
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%9F%8B%E7%82%B9/" title="埋点" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%9F%8B%E7%82%B9/">
          埋点
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%9F%8B%E7%82%B9/%E5%9F%8B%E7%82%B9/" title="埋点" class="dd-item ">
        <a href="/en/android/%E5%9F%8B%E7%82%B9/%E5%9F%8B%E7%82%B9/">
        埋点
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%9F%8B%E7%82%B9/%E6%98%93%E8%A7%82%E6%96%B9%E8%88%9F/" title="易观方舟" class="dd-item ">
        <a href="/en/android/%E5%9F%8B%E7%82%B9/%E6%98%93%E8%A7%82%E6%96%B9%E8%88%9F/">
        易观方舟
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%AD%98%E5%82%A8/" title="存储" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%AD%98%E5%82%A8/">
          存储
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%AD%98%E5%82%A8/sharedpreferences/" title="sharedpreferences" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%AD%98%E5%82%A8/sharedpreferences/">
          sharedpreferences
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%AD%98%E5%82%A8/sharedpreferences/sharedpreferences/" title="SharedPreferences" class="dd-item ">
        <a href="/en/android/%E5%AD%98%E5%82%A8/sharedpreferences/sharedpreferences/">
        SharedPreferences
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%AE%89%E5%85%A8/" title="安全" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%AE%89%E5%85%A8/">
          安全
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%AE%89%E5%85%A8/app%E7%AD%BE%E5%90%8D/" title="app签名" class="dd-item ">
        <a href="/en/android/%E5%AE%89%E5%85%A8/app%E7%AD%BE%E5%90%8D/">
        app签名
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%AE%89%E5%85%A8/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/" title="应用安全" class="dd-item ">
        <a href="/en/android/%E5%AE%89%E5%85%A8/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/">
        应用安全
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%AE%89%E5%85%A8/" title="网络请求安全" class="dd-item ">
        <a href="/en/android/%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%AE%89%E5%85%A8/">
        网络请求安全
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="性能优化" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">
          性能优化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/" title="apm" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/">
          apm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrixgradleplugin/" title="MatrixGradlePlugin" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrixgradleplugin/">
        MatrixGradlePlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrixsource/" title="MatrixSource" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrixsource/">
        MatrixSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrix%E6%8E%A5%E5%85%A5%E5%90%8E%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/" title="Matrix接入后遇到的问题" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrix%E6%8E%A5%E5%85%A5%E5%90%8E%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/">
        Matrix接入后遇到的问题
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrix%E7%A0%94%E7%A9%B6/" title="Matrix研究" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrix%E7%A0%94%E7%A9%B6/">
        Matrix研究
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/resource/" title="resource" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/resource/">
          resource
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/resource/matrixresourceplugin/" title="MatrixResourcePlugin" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/resource/matrixresourceplugin/">
        MatrixResourcePlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/" title="内存优化" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/">
          内存优化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/dumphprof/" title="DumpHprof" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/dumphprof/">
        DumpHprof
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/hprof_binary_dump_format/" title="Hprof_binary_dump_format" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/hprof_binary_dump_format/">
        Hprof_binary_dump_format
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/koomsource/" title="KOOMSource" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/koomsource/">
        KOOMSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/leakcanary2/" title="LeakCanary2" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/leakcanary2/">
        LeakCanary2
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/leakcanary2analyze/" title="LeakCanary2Analyze" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/leakcanary2analyze/">
        LeakCanary2Analyze
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/managememory/" title="manageMemory" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/managememory/">
        manageMemory
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/oom/" title="OOM" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/oom/">
        OOM
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/" title="布局优化" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/">
          布局优化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/" title="布局优化" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/">
        布局优化
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/" title="插件化" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/">
          插件化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/apk%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD/" title="apk安装和卸载" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/apk%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD/">
          apk安装和卸载
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/apk%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD/%E5%BA%94%E7%94%A8%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD%E8%BF%87%E7%A8%8B/" title="应用安装和卸载过程" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/apk%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD/%E5%BA%94%E7%94%A8%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD%E8%BF%87%E7%A8%8B/">
        应用安装和卸载过程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/hook/" title="Hook" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/hook/">
        Hook
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/qigsaw/" title="qigsaw" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/qigsaw/">
          qigsaw
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/qigsaw/qigsaw/" title="Qigsaw" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/qigsaw/qigsaw/">
        Qigsaw
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/" title="shadow" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/">
          shadow
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadow/" title="Shadow" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadow/">
        Shadow
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadowplugin/" title="ShadowPlugin" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadowplugin/">
        ShadowPlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadowsource/" title="ShadowSource" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadowsource/">
        ShadowSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/%E6%8F%92%E4%BB%B6%E5%8C%96%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B/" title="插件化技术选型" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/%E6%8F%92%E4%BB%B6%E5%8C%96%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B/">
        插件化技术选型
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/%E6%8F%92%E4%BB%B6%E5%8C%96%E9%9D%A2%E4%B8%B4%E7%9A%84%E9%97%AE%E9%A2%98/" title="插件化面临的问题" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/%E6%8F%92%E4%BB%B6%E5%8C%96%E9%9D%A2%E4%B8%B4%E7%9A%84%E9%97%AE%E9%A2%98/">
        插件化面临的问题
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/" title="热修复字节码" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/">
          热修复字节码
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/andfix/" title="AndFix" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/andfix/">
        AndFix
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/andfixsource/" title="AndFixSource" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/andfixsource/">
        AndFixSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/dex%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/" title="Dex文件格式" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/dex%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/">
        Dex文件格式
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/hotfixresearch/" title="hotfixResearch" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/hotfixresearch/">
        hotfixResearch
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/multidex/" title="MultiDex" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/multidex/">
        MultiDex
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/" title="tinker" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/">
          tinker
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" title="源码分析" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">
          源码分析
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/resource.arsc%E7%94%9F%E6%88%90%E5%92%8C%E7%BB%93%E6%9E%84/" title="Resource.arsc生成和结构" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/resource.arsc%E7%94%9F%E6%88%90%E5%92%8C%E7%BB%93%E6%9E%84/">
        Resource.arsc生成和结构
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkergradlepluginsource/" title="TinkerGradlePluginSource" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkergradlepluginsource/">
        TinkerGradlePluginSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkersource/" title="TinkerSource" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkersource/">
        TinkerSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/" title="稳定性" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/">
          稳定性
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/" title="异常" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/">
          异常
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/" title="anr" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/">
          anr
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/anr/" title="ANR" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/anr/">
        ANR
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/javacrash/" title="javacrash" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/javacrash/">
          javacrash
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/javacrash/javacrashsystemhandle/" title="JavaCrashSystemHandle" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/javacrash/javacrashsystemhandle/">
        JavaCrashSystemHandle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/" title="nativecrash" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/">
          nativecrash
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash1systemhandle/" title="nativeCrash1SystemHandle" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash1systemhandle/">
        nativeCrash1SystemHandle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash2collectstack/" title="nativeCrash2CollectStack" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash2collectstack/">
        nativeCrash2CollectStack
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash3symbolrecovery/" title="nativeCrash3SymbolRecovery" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash3symbolrecovery/">
        nativeCrash3SymbolRecovery
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash4analysisrootcause/" title="nativeCrash4AnalysisRootCause" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash4analysisrootcause/">
        nativeCrash4AnalysisRootCause
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash%E9%80%89%E5%9E%8B%E5%92%8C%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B/" title="nativeCrash选型和整体流程" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash%E9%80%89%E5%9E%8B%E5%92%8C%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B/">
        nativeCrash选型和整体流程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/" title="xcrash" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/">
          xcrash
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/linuxapi/" title="linuxApi" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/linuxapi/">
        linuxApi
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrashanr/" title="xCrashAnr" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrashanr/">
        xCrashAnr
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrashnativecrash/" title="xCrashNativeCrash" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrashnativecrash/">
        xCrashNativeCrash
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrash%E5%8E%9F%E7%90%86/" title="xCrash原理" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrash%E5%8E%9F%E7%90%86/">
        xCrash原理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/" title="系统机制原理" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/">
          系统机制原理
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/ashmem/" title="ashmem" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/ashmem/">
          ashmem
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/ashmem/%E5%8C%BF%E5%90%8D%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98ashmem/" title="匿名共享内存Ashmem" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/ashmem/%E5%8C%BF%E5%90%8D%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98ashmem/">
        匿名共享内存Ashmem
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/bitmap/" title="bitmap" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/bitmap/">
          bitmap
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/bitmap/bitmap/" title="Bitmap" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/bitmap/bitmap/">
        Bitmap
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/bitmap/bitmapsource/" title="BitmapSource" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/bitmap/bitmapsource/">
        BitmapSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/handler/" title="handler" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/handler/">
          handler
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/handler/epoll/" title="Epoll" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/handler/epoll/">
        Epoll
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/handler/looper/" title="Looper" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/handler/looper/">
        Looper
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/handler/threadlocal/" title="ThreadLocal" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/handler/threadlocal/">
        ThreadLocal
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/input/" title="input" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/input/">
          input
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/input/toucheventnative/" title="touchEventNative" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/input/toucheventnative/">
        touchEventNative
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/kernel/" title="kernel" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/kernel/">
          kernel
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/kernel/kernel/" title="kernel" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/kernel/kernel/">
        kernel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/layoutinflater/" title="layoutinflater" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/layoutinflater/">
          layoutinflater
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/layoutinflater/layoutinflater/" title="LayoutInflater" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/layoutinflater/layoutinflater/">
        LayoutInflater
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/thread/" title="thread" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/thread/">
          thread
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/thread/stacktraceelement/" title="StackTraceElement" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/thread/stacktraceelement/">
        StackTraceElement
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/thread/threadstate/" title="ThreadState" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/thread/threadstate/">
        ThreadState
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/zygote/" title="zygote" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/zygote/">
          zygote
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/zygote/systemserversource/" title="SystemServerSource" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/zygote/systemserversource/">
        SystemServerSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/zygote/zygotesource/" title="ZygoteSource" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/zygote/zygotesource/">
        ZygoteSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/zygote/zygote%E8%BF%9B%E7%A8%8B/" title="Zygote进程" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/zygote/zygote%E8%BF%9B%E7%A8%8B/">
        Zygote进程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/" title="后台任务" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/">
          后台任务
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1%E5%A4%84%E7%90%86/" title="后台任务处理" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1%E5%A4%84%E7%90%86/">
        后台任务处理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/" title="多进程" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/">
          多进程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/" title="binder" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/">
          binder
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderclient/" title="BinderClient" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderclient/">
        BinderClient
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderdeath/" title="BinderDeath" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderdeath/">
        BinderDeath
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderkernel/" title="BinderKernel" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderkernel/">
        BinderKernel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderserver/" title="BinderServer" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderserver/">
        BinderServer
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderservicemanager/" title="BinderServiceManager" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderservicemanager/">
        BinderServiceManager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binder%E5%8E%9F%E7%90%86/" title="Binder原理" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binder%E5%8E%9F%E7%90%86/">
        Binder原理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/mmkv/" title="mmkv" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/mmkv/">
          mmkv
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/mmkv/mmkv/" title="MMKV" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%A4%9A%E8%BF%9B%E7%A8%8B/mmkv/mmkv/">
        MMKV
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E9%80%80%E5%87%BA/" title="应用启动退出" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E9%80%80%E5%87%BA/">
          应用启动退出
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E9%80%80%E5%87%BA/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8/" title="应用启动" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E9%80%80%E5%87%BA/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8/">
        应用启动
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E6%BA%90%E7%A0%81%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95/" title="源码研究方法" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E6%BA%90%E7%A0%81%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95/">
          源码研究方法
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E6%BA%90%E7%A0%81%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95/syscall%E6%9F%A5%E6%89%BE%E6%96%B9%E5%BC%8F/" title="Syscall查找方式" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E6%BA%90%E7%A0%81%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95/syscall%E6%9F%A5%E6%89%BE%E6%96%B9%E5%BC%8F/">
        Syscall查找方式
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/" title="系统绘制" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/">
          系统绘制
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/graphics/" title="Graphics" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/graphics/">
        Graphics
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/measurelayoutdraw/" title="measurelayoutdraw" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/measurelayoutdraw/">
          measurelayoutdraw
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/measurelayoutdraw/measure/" title="measure" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/measurelayoutdraw/measure/">
        measure
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/vsync/" title="Vsync" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/vsync/">
        Vsync
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/vsync_surfaceflinger/" title="Vsync_SurfaceFlinger" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/vsync_surfaceflinger/">
        Vsync_SurfaceFlinger
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E7%A1%AC%E4%BB%B6%E5%8A%A0%E9%80%9F%E7%BB%98%E5%88%B6/" title="硬件加速绘制" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E7%A1%AC%E4%BB%B6%E5%8A%A0%E9%80%9F%E7%BB%98%E5%88%B6/">
        硬件加速绘制
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E7%BB%98%E5%88%B6%E5%8E%9F%E7%90%86/" title="绘制原理" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E7%BB%98%E5%88%B6%E5%8E%9F%E7%90%86/">
        绘制原理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E8%BD%AF%E4%BB%B6%E7%BB%98%E5%88%B6/" title="软件绘制" class="dd-item ">
        <a href="/en/android/%E7%B3%BB%E7%BB%9F%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E8%BD%AF%E4%BB%B6%E7%BB%98%E5%88%B6/">
        软件绘制
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" title="自动化测试" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/">
          自动化测试
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/android%E4%BB%A3%E7%A0%81%E8%87%AA%E6%B5%8B/" title="android代码自测" class="dd-item ">
        <a href="/en/android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/android%E4%BB%A3%E7%A0%81%E8%87%AA%E6%B5%8B/">
        android代码自测
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/" title="虚拟机" class="dd-item
        parent
        
        
        ">
      <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/">
          虚拟机
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/" title="alloc_gc" class="dd-item
        parent
        
        
        ">
      <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/">
          alloc_gc
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/alloc/" title="Alloc" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/alloc/">
        Alloc
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/allocrelated/" title="AllocRelated" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/allocrelated/">
        AllocRelated
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/gc/" title="GC" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/gc/">
        GC
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/gc_concurrentcopying/" title="GC_ConcurrentCopying" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/gc_concurrentcopying/">
        GC_ConcurrentCopying
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/gc_markcompact/" title="GC_MarkCompact" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/gc_markcompact/">
        GC_MarkCompact
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/gc_ms_cms/" title="GC_MS_CMS" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/gc_ms_cms/">
        GC_MS_CMS
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/gc_semi_space/" title="GC_Semi_Space" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/gc_semi_space/">
        GC_Semi_Space
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/runtime_visitroots/" title="Runtime_VisitRoots" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/runtime_visitroots/">
        Runtime_VisitRoots
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/space/" title="Space" class="dd-item active">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/space/">
        Space
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/art_lock/" title="ART_Lock" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/art_lock/">
        ART_Lock
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/" title="jni" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/">
          jni
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/c%E5%90%AF%E5%8A%A8java/" title="C启动Java" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/c%E5%90%AF%E5%8A%A8java/">
        C启动Java
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/java_jni%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E5%8E%9F%E7%90%86/" title="java_jni方法调用原理" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/java_jni%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E5%8E%9F%E7%90%86/">
        java_jni方法调用原理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/jni%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2/" title="Jni数据转换" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/jni%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2/">
        Jni数据转换
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/systemloadlibrary/" title="SystemLoadLibrary" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/systemloadlibrary/">
        SystemLoadLibrary
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/%E5%BC%82%E5%B8%B8/" title="异常" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/%E5%BC%82%E5%B8%B8/">
        异常
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/%E8%A7%A3%E9%87%8A%E6%89%A7%E8%A1%8C7_0/" title="解释执行7_0" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/jni/%E8%A7%A3%E9%87%8A%E6%89%A7%E8%A1%8C7_0/">
        解释执行7_0
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/" title="启动流程" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/">
          启动流程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/art%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/" title="ART启动流程" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/art%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/">
        ART启动流程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="基础数据结构" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
        基础数据结构
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/" title="混合编译_运行" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/">
          混合编译_运行
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/jvm_jit/" title="JVM_JIT" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/jvm_jit/">
        JVM_JIT
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/" title="混合编译_运行" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/">
        混合编译_运行
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" title="类加载" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E5%8A%A0%E8%BD%BD/">
          类加载
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E5%8A%A0%E8%BD%BD/android_n%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91%E4%B8%8E%E5%AF%B9%E7%83%AD%E8%A1%A5%E4%B8%81%E5%BD%B1%E5%93%8D%E8%A7%A3%E6%9E%90/" title="Android_N混合编译与对热补丁影响解析" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E5%8A%A0%E8%BD%BD/android_n%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91%E4%B8%8E%E5%AF%B9%E7%83%AD%E8%A1%A5%E4%B8%81%E5%BD%B1%E5%93%8D%E8%A7%A3%E6%9E%90/">
        Android_N混合编译与对热补丁影响解析
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E5%8A%A0%E8%BD%BD/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" title="类加载" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E5%8A%A0%E8%BD%BD/%E7%B1%BB%E5%8A%A0%E8%BD%BD/">
        类加载
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E5%8A%A0%E8%BD%BD/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B1%82/" title="类加载虚拟机层" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E5%8A%A0%E8%BD%BD/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B1%82/">
        类加载虚拟机层
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E7%BC%96%E8%AF%91/" title="类编译" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E7%BC%96%E8%AF%91/">
          类编译
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E7%BC%96%E8%AF%91/dex2oat/" title="dex2oat" class="dd-item ">
        <a href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/%E7%B1%BB%E7%BC%96%E8%AF%91/dex2oat/">
        dex2oat
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/java/" title="java" class="dd-item
        
        
        
        ">
      <a href="/en/java/">
          java
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/java/blockingqueue/" title="BlockingQueue" class="dd-item ">
        <a href="/en/java/blockingqueue/">
        BlockingQueue
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/java/java%E5%B9%B6%E5%8F%91/" title="java并发" class="dd-item ">
        <a href="/en/java/java%E5%B9%B6%E5%8F%91/">
        java并发
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/java/threadpoolexecutor/" title="ThreadPoolExecutor" class="dd-item ">
        <a href="/en/java/threadpoolexecutor/">
        ThreadPoolExecutor
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/kotlin/" title="kotlin" class="dd-item
        
        
        
        ">
      <a href="/en/kotlin/">
          kotlin
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/kotlin/coroutine/" title="coroutine" class="dd-item
        
        
        
        ">
      <a href="/en/kotlin/coroutine/">
          coroutine
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B/" title="kotlin协程" class="dd-item ">
        <a href="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B/">
        kotlin协程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8Bsource/" title="kotlin协程Source" class="dd-item ">
        <a href="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8Bsource/">
        kotlin协程Source
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B%E5%8F%96%E6%B6%88/" title="kotlin协程取消" class="dd-item ">
        <a href="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B%E5%8F%96%E6%B6%88/">
        kotlin协程取消
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B%E5%BC%82%E5%B8%B8/" title="kotlin协程异常" class="dd-item ">
        <a href="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B%E5%BC%82%E5%B8%B8/">
        kotlin协程异常
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/%E4%BD%BF%E7%94%A8%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0%E6%9D%A5%E5%B0%81%E8%A3%85%E5%9B%9E%E8%B0%83/" title="使用挂起函数来封装回调" class="dd-item ">
        <a href="/en/kotlin/coroutine/%E4%BD%BF%E7%94%A8%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0%E6%9D%A5%E5%B0%81%E8%A3%85%E5%9B%9E%E8%B0%83/">
        使用挂起函数来封装回调
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/linux/" title="linux" class="dd-item
        
        
        
        ">
      <a href="/en/linux/">
          linux
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/linux/linux_io/" title="linux_io" class="dd-item ">
        <a href="/en/linux/linux_io/">
        linux_io
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/%E6%80%9D%E6%83%B3/" title="思想" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%80%9D%E6%83%B3/">
          思想
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%80%9D%E6%83%B3/ioc/" title="IOC" class="dd-item ">
        <a href="/en/%E6%80%9D%E6%83%B3/ioc/">
        IOC
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%80%9D%E6%83%B3/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/" title="程序设计规范" class="dd-item ">
        <a href="/en/%E6%80%9D%E6%83%B3/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/">
        程序设计规范
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%80%9D%E6%83%B3/%E7%BB%A7%E6%89%BF%E5%92%8C%E7%BB%84%E5%90%88/" title="继承和组合" class="dd-item ">
        <a href="/en/%E6%80%9D%E6%83%B3/%E7%BB%A7%E6%89%BF%E5%92%8C%E7%BB%84%E5%90%88/">
        继承和组合
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/" title="跨平台" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">
          跨平台
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/" title="flutter" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/">
          flutter
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/" title="engine" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/">
          engine
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/engine/" title="Engine" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/engine/">
        Engine
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/startup/" title="startup" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/startup/">
          startup
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/startup/startup/" title="startup" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/startup/startup/">
        startup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/startup/startup_dart_framework/" title="startup_dart_framework" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/startup/startup_dart_framework/">
        startup_dart_framework
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/startup/startup_embedder_framwwork/" title="startup_embedder_framwwork" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/startup/startup_embedder_framwwork/">
        startup_embedder_framwwork
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/touch/" title="touch" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/touch/">
          touch
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/touch/touch/" title="Touch" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/touch/touch/">
        Touch
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%8A%A8%E7%94%BB/" title="动画" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%8A%A8%E7%94%BB/">
          动画
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%8A%A8%E7%94%BB/%E5%8A%A8%E7%94%BB/" title="动画" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%8A%A8%E7%94%BB/%E5%8A%A8%E7%94%BB/">
        动画
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/" title="响应式架构" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/">
          响应式架构
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/provider/" title="Provider" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/provider/">
        Provider
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/%E8%B7%A8%E7%BB%84%E4%BB%B6%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE/" title="跨组件传递数据" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/%E8%B7%A8%E7%BB%84%E4%BB%B6%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE/">
        跨组件传递数据
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/" title="混合开发" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/">
          混合开发
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/flutterboost/" title="FlutterBoost" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/flutterboost/">
        FlutterBoost
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/" title="混合开发" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/">
        混合开发
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/" title="渲染" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/">
          渲染
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/widget/" title="Widget" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/widget/">
        Widget
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/%E6%B8%B2%E6%9F%93/" title="渲染" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/%E6%B8%B2%E6%9F%93/">
        渲染
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E8%B7%AF%E7%94%B1/" title="路由" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E8%B7%AF%E7%94%B1/">
          路由
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E8%B7%AF%E7%94%B1/%E8%B7%AF%E7%94%B1/" title="路由" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E8%B7%AF%E7%94%B1/%E8%B7%AF%E7%94%B1/">
        路由
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/" title="通信" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/">
          通信
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/messageloop/" title="MessageLoop" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/messageloop/">
        MessageLoop
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/methodchannel/" title="MethodChannel" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/methodchannel/">
        MethodChannel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/huanle19891345"><i class='fab fa-fw fa-github'></i> GitHub repo</a>
              </li>
          
              <li>
                  <a class="padding" href="https://huanle19891345.github.io/en/showcase"><i class='fas fa-fw fa-camera'></i> Showcases</a>
              </li>
          
              <li>
                  <a class="padding" href="https://gohugo.io/"><i class='fas fa-fw fa-bookmark'></i> Hugo Documentation</a>
              </li>
          
              <li>
                  <a class="padding" href="https://huanle19891345.github.io/en/credits"><i class='fas fa-fw fa-bullhorn'></i> Credits</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      

      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/en/'>技术探索总结</a> > <a href='/en/android/'>android</a> > <a href='/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/'>虚拟机</a> > <a href='/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/'>alloc_gc</a> > Space
          
        
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#类设计">类设计</a></li>
    <li><a href="#spacebitmap">SpaceBitmap</a>
      <ul>
        <li><a href="#setconst-mirrorobject-obj">Set(const mirror::Object* obj)</a></li>
        <li><a href="#modifyconst-mirrorobject-obj">Modify(const mirror::Object* obj)</a></li>
        <li><a href="#walkobjectcallback-callback-void-arg">Walk(ObjectCallback* callback, void* arg)</a></li>
      </ul>
    </li>
    <li><a href="#space">Space</a></li>
    <li><a href="#continuousspace">ContinuousSpace</a></li>
    <li><a href="#memmapspace">MemMapSpace</a></li>
    <li><a href="#continuousmemmapallocspace">ContinuousMemMapAllocSpace</a></li>
    <li><a href="#bumppointerspace">BumpPointerSpace</a>
      <ul>
        <li><a href="#create">Create</a></li>
        <li><a href="#alloc">Alloc</a>
          <ul>
            <li><a href="#allocnonvirtual">AllocNonvirtual</a></li>
            <li><a href="#allocnonvirtualwithoutaccounting">AllocNonvirtualWithoutAccounting</a></li>
          </ul>
        </li>
        <li><a href="#allocnewtlab">AllocNewTlab</a>
          <ul>
            <li><a href="#allocblock">AllocBlock</a></li>
          </ul>
        </li>
        <li><a href="#freethread-mirrorobject">Free(Thread*, mirror::Object*)</a></li>
        <li><a href="#clear">Clear</a></li>
        <li><a href="#walkobjectcallback-callback-void-arg-1">Walk(ObjectCallback* callback, void* arg)</a>
          <ul>
            <li><a href="#getnextobjectmirrorobject-obj">GetNextObject(mirror::Object* obj)</a></li>
          </ul>
        </li>
        <li><a href="#getbytesallocated">GetBytesAllocated</a></li>
      </ul>
    </li>
    <li><a href="#regionspace">RegionSpace</a>
      <ul>
        <li><a href="#create-1">Create</a></li>
        <li><a href="#alloc-1">Alloc</a></li>
        <li><a href="#allocnewtlab-1">AllocNewTlab</a></li>
        <li><a href="#freethread-mirrorobject-1">Free(Thread*, mirror::Object*)</a></li>
        <li><a href="#clear-1">Clear</a></li>
        <li><a href="#walkobjectcallback-callback-void-arg-2">Walk(ObjectCallback* callback, void* arg)</a></li>
        <li><a href="#regionspaceregion">RegionSpace::Region</a>
          <ul>
            <li><a href="#alloc-2">Alloc</a></li>
            <li><a href="#clear-2">Clear</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#mallocspace">MallocSpace</a></li>
    <li><a href="#heapcreatemallocspacefrommemmap">Heap::CreateMallocSpaceFromMemMap</a></li>
    <li><a href="#dlmallocspace">DlMallocSpace</a>
      <ul>
        <li><a href="#create-2">Create</a>
          <ul>
            <li><a href="#createfrommemmap">CreateFromMemMap</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#rosallocspace">RosAllocSpace</a>
      <ul>
        <li><a href="#create-3">Create</a>
          <ul>
            <li><a href="#createfrommemmap-1">CreateFromMemMap</a></li>
          </ul>
        </li>
        <li><a href="#alloccommon">AllocCommon</a></li>
        <li><a href="#rosallocalloc">RosAlloc::Alloc</a>
          <ul>
            <li><a href="#rosallocallocfromrun">RosAlloc::AllocFromRun</a></li>
            <li><a href="#rosalloc原理图">RosAlloc原理图</a></li>
            <li><a href="#rosallcallocfromrun流程图">RosAllc::AllocFromRun流程图</a></li>
            <li><a href="#rosallocrefillrun">RosAlloc::RefillRun</a>
              <ul>
                <li><a href="#rosallocallocpages">RosAlloc::AllocPages</a></li>
                <li><a href="#initfreelist">InitFreeList</a></li>
              </ul>
            </li>
            <li><a href="#rosallocrunallocslot">RosAlloc::Run::AllocSlot</a></li>
          </ul>
        </li>
        <li><a href="#free">Free</a></li>
      </ul>
    </li>
    <li><a href="#discontinuousspace">DiscontinuousSpace</a></li>
    <li><a href="#largeobjectmapspace">LargeObjectMapSpace</a>
      <ul>
        <li><a href="#alloc-3">Alloc</a></li>
      </ul>
    </li>
    <li><a href="#thread">Thread</a>
      <ul>
        <li><a href="#settlab">SetTlab</a></li>
        <li><a href="#alloctlab">AllocTlab</a></li>
      </ul>
    </li>
    <li><a href="#tlab设计思路">TLAB设计思路</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Space
            </h1>
          

        


<h2 id="类设计">类设计</h2>
<p>ART虚拟机提供了多种内存分配手段，它们分别由LargeObjectSpace、BumpPointerSpace、ZygoteSpace、RegionSpace、DlMallocSpace和RosAllocSpace六个类(叶子节点)来实现。ImageSpace用于.art文件的加载</p>
<pre><code class="language-mermaid" data-lang="mermaid">classDiagram
class Space {
 +GetNames()
 +Contains()
 +IsImageSpace()
 +IsMallocSpace()
 +isZygoteSpace()
 +isBumpPointerSpace()
 +IsRegionSpace()
}
class AllocSpace {
 +GetByteAllocated()
 +GetObjectsAllocated()
 +Alloc()
 +AllocThreadSafe()
 +Free()
 +FreeList()
}

Space &lt;|-- ContinuousSpace
ContinuousSpace &lt;|-- MemMapSpace
MemMapSpace &lt;|-- ImageSpace
MemMapSpace &lt;|-- ContinuousMemMapAllocSpace
AllocSpace &lt;|-- ContinuousMemMapAllocSpace
AllocSpace &lt;|-- LargeObjectSpace
Space &lt;|-- DiscontinuousSpace
DiscontinuousSpace &lt;|-- LargeObjectSpace
ContinuousMemMapAllocSpace &lt;|-- BumpPointerSpace
ContinuousMemMapAllocSpace &lt;|-- RegionSpace
ContinuousMemMapAllocSpace &lt;|-- ZygoteSpace
ContinuousMemMapAllocSpace &lt;|-- MallocSpace
MallocSpace &lt;|-- DlMallocSpace
MallocSpace &lt;|-- RosAllocSpace
LargeObjectSpace &lt;|-- LargeObjectMapSpace
LargeObjectSpace &lt;|-- FreeListSpace
</code></pre><h2 id="spacebitmap">SpaceBitmap</h2>
<p><img src="/img/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/space.assets/image-20210212203136486.png" alt="image-20210212203136486"></p>
<p><img src="/img/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/space.assets/image-20210212203202063.png" alt="image-20210212203202063"></p>
<p>space_bitmap(-inl).h</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h"><span style="color:#66d9ef">static</span> constexpr <span style="color:#66d9ef">int</span> kBitsPerIntPtrT <span style="color:#f92672">=</span> <span style="color:#66d9ef">sizeof</span>(intptr_t) <span style="color:#f92672">*</span> kBitsPerByte;

<span style="color:#75715e">// System page size. We check this against sysconf(_SC_PAGE_SIZE) at runtime, but use a simple
</span><span style="color:#75715e">// compile-time constant so the compiler can generate better code.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> constexpr <span style="color:#66d9ef">int</span> kPageSize <span style="color:#f92672">=</span> <span style="color:#ae81ff">4096</span>;

<span style="color:#75715e">// Required object alignment
</span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> constexpr size_t kObjectAlignment <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>;
<span style="color:#66d9ef">static</span> constexpr size_t kLargeObjectAlignment <span style="color:#f92672">=</span> kPageSize;

<span style="color:#66d9ef">typedef</span> SpaceBitmap<span style="color:#f92672">&lt;</span>kObjectAlignment<span style="color:#f92672">&gt;</span> ContinuousSpaceBitmap;
<span style="color:#66d9ef">typedef</span> SpaceBitmap<span style="color:#f92672">&lt;</span>kLargeObjectAlignment<span style="color:#f92672">&gt;</span> LargeObjectBitmap;

template<span style="color:#f92672">&lt;</span>size_t kAlignment<span style="color:#f92672">&gt;</span>
class SpaceBitmap {
  <span style="color:#75715e">// Backing storage for bitmap.
</span><span style="color:#75715e"></span>  std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>MemMap<span style="color:#f92672">&gt;</span> mem_map_;
  <span style="color:#75715e">// This bitmap itself, word sized for efficiency in scanning.
</span><span style="color:#75715e"></span>  uintptr_t<span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> bitmap_begin_;
</code></pre></div><h3 id="setconst-mirrorobject-obj">Set(const mirror::Object* obj)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h"><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">Set</span>(<span style="color:#66d9ef">const</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj) ALWAYS_INLINE {
    <span style="color:#66d9ef">return</span> Modify<span style="color:#f92672">&lt;</span>true<span style="color:#f92672">&gt;</span>(obj);<span style="color:#75715e">//obj是一个内存地址。Modify本身是又是一个模板函数
</span><span style="color:#75715e"></span>}
</code></pre></div><h3 id="modifyconst-mirrorobject-obj">Modify(const mirror::Object* obj)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h"><span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">bool</span> SpaceBitmap<span style="color:#f92672">&lt;</span>kAlignment<span style="color:#f92672">&gt;::</span>Modify(<span style="color:#66d9ef">const</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj) {
    uintptr_t addr <span style="color:#f92672">=</span> reinterpret_cast<span style="color:#f92672">&lt;</span>uintptr_t<span style="color:#f92672">&gt;</span>(obj);
    <span style="color:#75715e">//offset是obj和heap_begin_（内存基地址）的偏移量
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> uintptr_t offset <span style="color:#f92672">=</span> addr <span style="color:#f92672">-</span> heap_begin_;
    <span style="color:#75715e">//先计算这个偏移量落在哪个字节中
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> size_t index <span style="color:#f92672">=</span> OffsetToIndex(offset);
    <span style="color:#75715e">//再计算这个偏移量落在字节的哪个比特位上
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> uintptr_t mask <span style="color:#f92672">=</span> OffsetToMask(offset);
    <span style="color:#75715e">//用index取出位图对应的字节（注意，位图存储空间是以字节为单位的，而不是以比特位为单位）
</span><span style="color:#75715e"></span>    uintptr_t<span style="color:#f92672">*</span> address <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>bitmap_begin_[index];<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>    uintptr_t old_word <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>address;
    <span style="color:#66d9ef">if</span> (kSetBit) {<span style="color:#75715e">//kSetBit为true的话，表示往位图中存储某个地址
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> ((old_word <span style="color:#f92672">&amp;</span> mask) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {<span style="color:#75715e">//如果该比特位还未设置，才设置
</span><span style="color:#75715e"></span>            <span style="color:#f92672">*</span>address <span style="color:#f92672">=</span> old_word <span style="color:#f92672">|</span> mask;<span style="color:#75715e">//设置mask比特位
</span><span style="color:#75715e"></span>        }
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">//取消mask比特位，这相当于从位图中去除对应位置所保存的地址
</span><span style="color:#75715e"></span>        <span style="color:#f92672">*</span>address <span style="color:#f92672">=</span> old_word <span style="color:#f92672">&amp;</span> <span style="color:#f92672">~</span>mask;
    }
    <span style="color:#66d9ef">return</span> (old_word <span style="color:#f92672">&amp;</span> mask) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>;
}

  <span style="color:#75715e">// &lt;offset&gt; is the difference from .base to a pointer address.
</span><span style="color:#75715e"></span>  <span style="color:#75715e">// &lt;index&gt; is the index of .bits that contains the bit representing
</span><span style="color:#75715e"></span>  <span style="color:#75715e">// &lt;offset&gt;.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">static</span> constexpr size_t OffsetToIndex(size_t offset) {
    <span style="color:#66d9ef">return</span> (offset <span style="color:#f92672">/</span> kAlignment) <span style="color:#f92672">/</span> kBitsPerIntPtrT;<span style="color:#75715e">//先对齐
</span><span style="color:#75715e"></span>  }

  template<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
  <span style="color:#66d9ef">static</span> constexpr T IndexToOffset(T index) {
    <span style="color:#66d9ef">return</span> static_cast<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span>(index <span style="color:#f92672">*</span> kAlignment <span style="color:#f92672">*</span> kBitsPerIntPtrT);
  }

  <span style="color:#75715e">// Bits are packed in the obvious way.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">static</span> constexpr uintptr_t OffsetToMask(uintptr_t offset) {
    <span style="color:#66d9ef">return</span> (static_cast<span style="color:#f92672">&lt;</span>size_t<span style="color:#f92672">&gt;</span>(<span style="color:#ae81ff">1</span>)) <span style="color:#f92672">&lt;&lt;</span> ((offset <span style="color:#f92672">/</span> kAlignment) <span style="color:#f92672">%</span> kBitsPerIntPtrT);
  }
</code></pre></div><h3 id="walkobjectcallback-callback-void-arg">Walk(ObjectCallback* callback, void* arg)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">template<span style="color:#f92672">&lt;</span>size_t kAlignment<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">void</span> SpaceBitmap<span style="color:#f92672">&lt;</span>kAlignment<span style="color:#f92672">&gt;::</span>Walk(ObjectCallback<span style="color:#f92672">*</span> callback, <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> arg) {
    <span style="color:#75715e">//注意这个函数的参数，callback是回调函数，每次从位图中确定一个对象的地址后将回调它,main
</span><span style="color:#75715e"></span>    uintptr_t end <span style="color:#f92672">=</span> OffsetToIndex(HeapLimit() <span style="color:#f92672">-</span> heap_begin_ <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>);
    uintptr_t<span style="color:#f92672">*</span> bitmap_begin <span style="color:#f92672">=</span> bitmap_begin_;
    <span style="color:#66d9ef">for</span> (uintptr_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> end; <span style="color:#f92672">++</span>i) {
        uintptr_t w <span style="color:#f92672">=</span> bitmap_begin[i];
        <span style="color:#66d9ef">if</span> (w <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
            uintptr_t ptr_base <span style="color:#f92672">=</span> IndexToOffset(i) <span style="color:#f92672">+</span> heap_begin_;
            <span style="color:#66d9ef">do</span> {
                <span style="color:#66d9ef">const</span> size_t shift <span style="color:#f92672">=</span> CTZ(w);<span style="color:#75715e">//w中末尾为0的个数，也就是第一个值为1的索引位
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//计算该索引位所存储的对象地址值，注意下面代码行中计算对象地址的公式
</span><span style="color:#75715e"></span>                mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj <span style="color:#f92672">=</span> reinterpret_cast<span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*&gt;</span>(ptr_base <span style="color:#f92672">+</span> shift <span style="color:#f92672">*</span> kAlignment);
                (<span style="color:#f92672">*</span>callback)(obj, arg);<span style="color:#75715e">//回调callback，arg是传入的参数
</span><span style="color:#75715e"></span>                w <span style="color:#f92672">^=</span> (static_cast<span style="color:#f92672">&lt;</span>uintptr_t<span style="color:#f92672">&gt;</span>(<span style="color:#ae81ff">1</span>)) <span style="color:#f92672">&lt;&lt;</span> shift;<span style="color:#75715e">//清除该索引位的1，继续循环
</span><span style="color:#75715e"></span>            } <span style="color:#66d9ef">while</span> (w <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>);
        }
    }
}
</code></pre></div><p>space.h</p>
<h2 id="space">Space</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">class Space {
    protected:
        std<span style="color:#f92672">::</span>string name_; <span style="color:#75715e">//表示一个Space对象的名称
</span><span style="color:#75715e"></span>        <span style="color:#75715e">/*GcRetentionPolicy是一个枚举变量，其定义如下：
</span><span style="color:#75715e">          enum GcRetentionPolicy {
</span><span style="color:#75715e">        //下面这个枚举值表示本空间无需GC
</span><span style="color:#75715e">          kGcRetentionPolicyNeverCollect,
</span><span style="color:#75715e">        //每次GC都需要回收本空间的垃圾对象
</span><span style="color:#75715e">          kGcRetentionPolicyAlwaysCollect,
</span><span style="color:#75715e">        //只在full GC的时候回收本空间的垃圾对象
</span><span style="color:#75715e">          kGcRetentionPolicyFullCollect,
</span><span style="color:#75715e">        }
</span><span style="color:#75715e">    */</span>
    GcRetentionPolicy gc_retention_policy_;
    ......
};
</code></pre></div><h2 id="continuousspace">ContinuousSpace</h2>
<p>Continuous spaces have bitmaps, and an address range. Although not required, objects within continuous spaces can be marked in the card table.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">  <span style="color:#75715e">// Address at which the space begins.
</span><span style="color:#75715e">//ContinuousSpace代表一块内存地址连续的空间，begin_为该内存空间的起始地址
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">Begin</span>() <span style="color:#66d9ef">const</span> {
    <span style="color:#66d9ef">return</span> begin_;
  }

  <span style="color:#75715e">// Current address at which the space ends, which may vary as the space is filled.
</span><span style="color:#75715e"></span>   <span style="color:#75715e">//可以将end_看作水位线。如果一个ContinuousSpace对象可分配内存的话，那么end_表示
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//当前内存分配到哪了。end_最大不能超过下面的limit_成员变量
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">End</span>() <span style="color:#66d9ef">const</span> {
    <span style="color:#66d9ef">return</span> end_.LoadRelaxed();
  }

  <span style="color:#75715e">// The end of the address range covered by the space.
</span><span style="color:#75715e">//limit_是这块内存空间的末尾地址。end_不能超过limit_
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">Limit</span>() <span style="color:#66d9ef">const</span> {
    <span style="color:#66d9ef">return</span> limit_;
  }
   <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
        <span style="color:#75715e">//Capacity函数返回该空间的容量，值为limit_- begin_
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">virtual</span> size_t Capacity() <span style="color:#66d9ef">const</span> {
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Limit</span>() <span style="color:#f92672">-</span> Begin();
    }
        <span style="color:#75715e">//Size函数返回该空间当前使用了多少，值为end_- begin_。
</span><span style="color:#75715e"></span>        size_t <span style="color:#a6e22e">Size</span>() <span style="color:#66d9ef">const</span> {
        <span style="color:#66d9ef">return</span> End() <span style="color:#f92672">-</span> Begin();
    }
}
</code></pre></div><h2 id="memmapspace">MemMapSpace</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MemMapSpace</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> ContinuousSpace {
    <span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
        std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>MemMap<span style="color:#f92672">&gt;</span>mem_map_;<span style="color:#75715e">//该成员变量指向所管理的MemMap对象
</span><span style="color:#75715e"></span>}
</code></pre></div><h2 id="continuousmemmapallocspace">ContinuousMemMapAllocSpace</h2>
<p>Used by the heap compaction interface to enable copying from one type of alloc space to another.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">class ContinuousMemMapAllocSpace : public MemMapSpace, public AllocSpace {
    protected:
    <span style="color:#75715e">/*ContinuousSpaceBitmap为数据类型别名，其定义如下：
</span><span style="color:#75715e">      typedef SpaceBitmap&lt;kObjectAlignment&gt; ContinuousSpaceBitmap;
</span><span style="color:#75715e">      kObjectAlignment取值为8。下文将解释这三个成员变量的取值情况。*/</span>
      std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>accounting<span style="color:#f92672">::</span>ContinuousSpaceBitmap<span style="color:#f92672">&gt;</span>live_bitmap_;
      std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>accounting<span style="color:#f92672">::</span>ContinuousSpaceBitmap<span style="color:#f92672">&gt;</span>mark_bitmap_;
      std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>accounting<span style="color:#f92672">::</span>ContinuousSpaceBitmap<span style="color:#f92672">&gt;</span>temp_bitmap_;
}
</code></pre></div><h2 id="bumppointerspace">BumpPointerSpace</h2>
<ul>
<li>
<p>Sequential Allocation或Linear Allocation, 正因为BumpPointerSpace采用了如此简单的内存分配算法，所以它压根就不能释放某一次所分配的内存（和ZygoteSpace一样，Free等函数没有真正的实现），而只支持一次性释放所有已分配的内存（实现了AllocSpace的Clear函数）。</p>
</li>
<li>
<p>BumpPointer-Space非常适合做线程本地内存分配——Thread Local Allocation Blocks，简写为TLAB，它代表一块专属某个线程的内存资源</p>
</li>
</ul>
<h3 id="create">Create</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#75715e">// A bump pointer space allocates by incrementing a pointer, it doesn&#39;t provide a free
</span><span style="color:#75715e">// implementation as its intended to be evacuated.
</span><span style="color:#75715e"></span>BumpPointerSpace<span style="color:#f92672">*</span> BumpPointerSpace<span style="color:#f92672">::</span>Create(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> name,
            size_t capacity, <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> requested_begin) {
    capacity <span style="color:#f92672">=</span> RoundUp(capacity, kPageSize);
    std<span style="color:#f92672">::</span>string error_msg;
    <span style="color:#75715e">//创建MemMap对象
</span><span style="color:#75715e"></span>    std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>MemMap<span style="color:#f92672">&gt;</span> mem_map(MemMap<span style="color:#f92672">::</span>MapAnonymous(name.c_str(),
        requested_begin, capacity,...));
    .....
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> BumpPointerSpace(name, mem_map.release());
}
BumpPointerSpace<span style="color:#f92672">::</span>BumpPointerSpace(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> name, MemMap<span style="color:#f92672">*</span> mem_map)
    <span style="color:#f92672">:</span> ContinuousMemMapAllocSpace(name, mem_map, mem_map<span style="color:#f92672">-&gt;</span>Begin(),
        mem_map<span style="color:#f92672">-&gt;</span>Begin(), mem_map<span style="color:#f92672">-&gt;</span>End(),GcRetentionPolicyAlwaysCollect),
    growth_end_(mem_map<span style="color:#f92672">-&gt;</span>End()),<span style="color:#75715e">//内存资源的尾部。分配的内存不允许超过该位置
</span><span style="color:#75715e"></span>    objects_allocated_(<span style="color:#ae81ff">0</span>),<span style="color:#75715e">//创建了多少个mirror Object对象
</span><span style="color:#75715e"></span>    bytes_allocated_(<span style="color:#ae81ff">0</span>), <span style="color:#75715e">//分配了多少字节的内存
</span><span style="color:#75715e"></span>    block_lock_(<span style="color:#e6db74">&#34;Block lock&#34;</span>, kBumpPointerSpaceBlockLock),
    main_block_size_(<span style="color:#ae81ff">0</span>),<span style="color:#75715e">//main_block_size_和num_blocks_的作用见下文代码分析
</span><span style="color:#75715e"></span>    num_blocks_(<span style="color:#ae81ff">0</span>) {
}
</code></pre></div><h3 id="alloc">Alloc</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">Alloc用于为某个mirror Object对象分配所需的内存<span style="color:#960050;background-color:#1e0010">。</span>
<span style="color:#66d9ef">inline</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> BumpPointerSpace<span style="color:#f92672">::</span>Alloc(Thread<span style="color:#f92672">*</span>, size_t num_bytes,
                        size_t<span style="color:#f92672">*</span> bytes_allocated, size_t<span style="color:#f92672">*</span> usable_size,
                        size_t<span style="color:#f92672">*</span> bytes_tl_bulk_allocated) {
    <span style="color:#75715e">/* Alloc函数的原型由AllocSpace类定义，其参数的含义为：
</span><span style="color:#75715e">       self：第一个参数。代表调用线程的线程对象，由于BumpPointerSpace没有使用这个参数，
</span><span style="color:#75715e">       所以上面的参数列表中并没有它（注意，第一个参数有参数类型，但没有参数名）。
</span><span style="color:#75715e">       num_bytes:第二个参数。此次内存分配所需的内存大小
</span><span style="color:#75715e">       bytes_allocated：实际分配了多少内存。它是一个输出参数。如果内存分配成功的话，该参数
</span><span style="color:#75715e">       大于或等于num_bytes。有一些内存分配算法会在实际所需内存大小上额外多分配一些内存用以
</span><span style="color:#75715e">       存储该算法所需的特殊信息。
</span><span style="color:#75715e">       usable_size：输出参数。如上文所说，实际分配的内存可能比所需内存要多。该变量表示所分配
</span><span style="color:#75715e">       的内存资源中可被外界使用的大小。显然，如果内存分配成功的话，该变量大于或等于num_bytes。
</span><span style="color:#75715e">       bytes_tl_bulk_allocated：它和thread local内存分配有关，其作用见下文代码分析。
</span><span style="color:#75715e">       另外，Alloc函数返回值的类型为mirror Object*。所以，Alloc就是用于为一个
</span><span style="color:#75715e">       Java Object对象（虚拟机中对应一个mirror Object对象）分配所需内存的函数。  */</span>

       <span style="color:#75715e">//num_bytes按8字节向上对齐（kAlignment为8）
</span><span style="color:#75715e"></span>       num_bytes <span style="color:#f92672">=</span> RoundUp(num_bytes, kAlignment);
       mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> ret <span style="color:#f92672">=</span> AllocNonvirtual(num_bytes);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>       <span style="color:#75715e">//设置返回值参数
</span><span style="color:#75715e"></span>       <span style="color:#66d9ef">if</span> (LIKELY(ret <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>)) {
       <span style="color:#75715e">//BumpPointerSpace内存分配算法无需额外信息。所以实际分配内存大小就是num_bytes
</span><span style="color:#75715e"></span>       <span style="color:#75715e">//当然，num_bytes已经按8字节向上对齐
</span><span style="color:#75715e"></span>       <span style="color:#f92672">*</span>bytes_allocated <span style="color:#f92672">=</span> num_bytes;
       <span style="color:#66d9ef">if</span> (usable_size <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) {
           <span style="color:#f92672">*</span>usable_size <span style="color:#f92672">=</span> num_bytes;
       }
       <span style="color:#f92672">*</span>bytes_tl_bulk_allocated <span style="color:#f92672">=</span> num_bytes;
       }
    <span style="color:#66d9ef">return</span> ret;
}
</code></pre></div><h4 id="allocnonvirtual">AllocNonvirtual</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">inline</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> BumpPointerSpace<span style="color:#f92672">::</span>AllocNonvirtual(size_t num_bytes) {
    <span style="color:#75715e">//具体的内存分配由下面这个函数完成
</span><span style="color:#75715e"></span>    mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> ret <span style="color:#f92672">=</span> AllocNonvirtualWithoutAccounting(num_bytes);
    <span style="color:#66d9ef">if</span> (ret <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) {
    <span style="color:#75715e">/*objects_allocated_和bytes_allocated_的类型为AtomicInteger，可在多个线程中实现原子操作。其中；
</span><span style="color:#75715e">        objects_allocated_：表示当前所分配的Object对象的个数。
</span><span style="color:#75715e">        bytes_allocated_：当前所分配的总内存大小。
</span><span style="color:#75715e">        下面的FetchAndAddSequentiallyConsistent函数为原子操作，相当于做加法。 */</span>
        objects_allocated_.FetchAndAddSequentiallyConsistent(<span style="color:#ae81ff">1</span>);
        bytes_allocated_.FetchAndAddSequentiallyConsistent(num_bytes);
    }
    <span style="color:#66d9ef">return</span> ret;
}
</code></pre></div><h4 id="allocnonvirtualwithoutaccounting">AllocNonvirtualWithoutAccounting</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">inline</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> BumpPointerSpace<span style="color:#f92672">::</span>AllocNonvirtualWithoutAccounting(
                    size_t num_bytes) {
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> old_end;
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> new_end;
    <span style="color:#75715e">/*end_类型为Atomic&lt;uint8_t*&gt;，它是ContinuousSpace类的成员变量，它表示上一次内
</span><span style="color:#75715e">      存分配的末尾位置。也就是Bump Pointer的位置。BumpPointerSpace构造函数中，该成员变
</span><span style="color:#75715e">      量取值等于内存的起始位置。由于BumpPointerSpace的分配算法很简单，所以只需使用原子变量
</span><span style="color:#75715e">      即可实现多线程并发操作。  */</span>
    <span style="color:#66d9ef">do</span> {
        old_end <span style="color:#f92672">=</span> end_.LoadRelaxed();<span style="color:#75715e">//获取当前末尾位置
</span><span style="color:#75715e"></span>        new_end <span style="color:#f92672">=</span> old_end <span style="color:#f92672">+</span> num_bytes;<span style="color:#75715e">//计算新的末尾位置
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (UNLIKELY(new_end <span style="color:#f92672">&gt;</span>growth_end_)) {<span style="color:#75715e">//如果超过内存资源的大小，则返回空指针
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nullptr</span>;
        }
    } <span style="color:#66d9ef">while</span> (<span style="color:#f92672">!</span>end_.CompareExchangeWeakSequentiallyConsistent(
              old_end, new_end));
    <span style="color:#75715e">//while循环退出后，end_将指向最新的末尾位置new_end。此次内存分配得到的内存起始地址为old_end,main
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*&gt;</span>(old_end);
}
</code></pre></div><h3 id="allocnewtlab">AllocNewTlab</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#75715e">//AllocNewTlab：当ART虚拟机决定从调用线程的本地存储空间中分配内存时将调用此函数。
</span><span style="color:#75715e"></span><span style="color:#66d9ef">bool</span> BumpPointerSpace<span style="color:#f92672">::</span>AllocNewTlab(Thread<span style="color:#f92672">*</span> self, size_t bytes) {
    <span style="color:#75715e">//注意参数，self代表调用线程，bytes代表此次内存分配的大小
</span><span style="color:#75715e"></span>    MutexLock <span style="color:#a6e22e">mu</span>(Thread<span style="color:#f92672">::</span>Current(), block_lock_);
    <span style="color:#75715e">//先释放self线程原来的TLAB（Thread Local Allocation Buffer），TLAB其实就代表一块内存
</span><span style="color:#75715e"></span>    RevokeThreadLocalBuffersLocked(self);
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> start <span style="color:#f92672">=</span> AllocBlock(bytes);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (start <span style="color:#f92672">==</span> <span style="color:#66d9ef">nullptr</span>) {
        <span style="color:#66d9ef">return</span> false;
    }
    <span style="color:#75715e">//设置self线程的TLAB，起始位置为start，结束位置为start+bytes。TLAB的详情见下文介绍。
</span><span style="color:#75715e"></span>    self<span style="color:#f92672">-&gt;</span>SetTlab(start, start <span style="color:#f92672">+</span> bytes);
    <span style="color:#66d9ef">return</span> true;
}
</code></pre></div><h4 id="allocblock">AllocBlock</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#75715e">// Returns the start of the storage.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> BumpPointerSpace<span style="color:#f92672">::</span>AllocBlock(size_t bytes) {
    bytes <span style="color:#f92672">=</span> RoundUp(bytes, kAlignment);
    <span style="color:#75715e">/*num_blocks_表示当前分配了多少内存块。每次调用AllocBlock都对应一个内存块。
</span><span style="color:#75715e">      BumpPointerSpace中，这样的内存块由BlockHeader数据结构来描述，其内容为：
</span><span style="color:#75715e">      struct BlockHeader {
</span><span style="color:#75715e">      size_t size_; //内存块总大小
</span><span style="color:#75715e">      size_t unused_; //还剩多少空余内存
</span><span style="color:#75715e">    }; */</span>
    <span style="color:#75715e">//如果是第一次分配内存块，则需要设置main_block_size_的值。UpdateMainBlock
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//的实现很简单，就是将当前已经分配的内存大小（由end_减去begin_）赋值给main_block_size_
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>num_blocks_) {
        UpdateMainBlock();<span style="color:#75715e">//内部的代码为：main_block_size_ = Size();
</span><span style="color:#75715e"></span>    }
    <span style="color:#75715e">//分配内存，在原来所需内存大小的基础上加上BlockHeader结构体所需内存
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> storage <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*&gt;</span>(
        AllocNonvirtualWithoutAccounting(bytes <span style="color:#f92672">+</span> <span style="color:#66d9ef">sizeof</span>(BlockHeader)));<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (LIKELY(storage <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>)) {
        BlockHeader<span style="color:#f92672">*</span> header <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>BlockHeader<span style="color:#f92672">*&gt;</span>(storage);
        header<span style="color:#f92672">-&gt;</span>size_ <span style="color:#f92672">=</span> bytes;<span style="color:#75715e">//设置BlockHeader的信息。
</span><span style="color:#75715e"></span>        storage <span style="color:#f92672">+=</span> <span style="color:#66d9ef">sizeof</span>(BlockHeader);<span style="color:#75715e">//返回给外部使用者的内存不包括BlockHeader部分
</span><span style="color:#75715e"></span>        <span style="color:#f92672">++</span>num_blocks_;<span style="color:#75715e">//num_blocks_递增1
</span><span style="color:#75715e"></span>    }
    <span style="color:#66d9ef">return</span> storage;
}
</code></pre></div><h3 id="freethread-mirrorobject">Free(Thread*, mirror::Object*)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">size_t <span style="color:#a6e22e">Free</span>(Thread<span style="color:#f92672">*</span>, mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span>) OVERRIDE {
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;<span style="color:#75715e">//直接返回0，说明BumpPointerSpace不能释放某一个Object所占据的内存
</span><span style="color:#75715e"></span>}
</code></pre></div><h3 id="clear">Clear</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> BumpPointerSpace<span style="color:#f92672">::</span>Clear() {
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>kMadviseZeroes) {<span style="color:#75715e">//Linux平台上该值为true。
</span><span style="color:#75715e"></span>        memset(Begin(), <span style="color:#ae81ff">0</span>, Limit() <span style="color:#f92672">-</span> Begin());<span style="color:#75715e">//将对应内存资源的内容清零
</span><span style="color:#75715e"></span>    }
    <span style="color:#75715e">//下面这个函数的作用和上面代码中调用memset清零内存空间的效果类似，我们在11.4.7节中介绍过它
</span><span style="color:#75715e"></span>    madvise(Begin(), Limit() <span style="color:#f92672">-</span> Begin(), MADV_DONTNEED), <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);

    SetEnd(Begin());<span style="color:#75715e">//设置end_等于begin_。
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//所有相关成员变量恢复为初值
</span><span style="color:#75715e"></span>    objects_allocated_.StoreRelaxed(<span style="color:#ae81ff">0</span>);
    bytes_allocated_.StoreRelaxed(<span style="color:#ae81ff">0</span>);
    growth_end_ <span style="color:#f92672">=</span> Limit();
    {
        MutexLock <span style="color:#a6e22e">mu</span>(Thread<span style="color:#f92672">::</span>Current(), block_lock_);
        num_blocks_ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        main_block_size_ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    }
</code></pre></div><h3 id="walkobjectcallback-callback-void-arg-1">Walk(ObjectCallback* callback, void* arg)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> BumpPointerSpace<span style="color:#f92672">::</span>Walk(ObjectCallback<span style="color:#f92672">*</span> callback, <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> arg) {
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> pos <span style="color:#f92672">=</span> Begin();
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> end <span style="color:#f92672">=</span> End();
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> main_end <span style="color:#f92672">=</span> pos;
{
    {
        MutexLock <span style="color:#a6e22e">mu</span>(Thread<span style="color:#f92672">::</span>Current(), block_lock_);
        <span style="color:#66d9ef">if</span> (num_blocks_ <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
            UpdateMainBlock();<span style="color:#75715e">//计算main block的大小。
</span><span style="color:#75715e"></span>        }
        main_end <span style="color:#f92672">=</span> Begin() <span style="color:#f92672">+</span> main_block_size_;
        <span style="color:#66d9ef">if</span> (num_blocks_ <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
            end <span style="color:#f92672">=</span> main_end;
        }
    }
    <span style="color:#75715e">//先遍历main block
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">while</span> (pos <span style="color:#f92672">&lt;</span> main_end) {
        mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*&gt;</span>(pos);
        <span style="color:#75715e">/*判断这个obj是不是真实存在。从内存角度来说obj本身是存在的，因为上面代码中obj直
</span><span style="color:#75715e">          接由内存地址转换而来。所以obj肯定不为空指针。但obj可能并不是真正的对象。下面的
</span><span style="color:#75715e">          GetClass函数将获取该obj对应的klass_（该对象所属的类）。如果为空，说明obj并
</span><span style="color:#75715e">          不存在。对BumpPointerSpace使用的内存分配算法而言，也就没必要继续遍历了。
</span><span style="color:#75715e">          所以下面的if条件满足后，函数就直接返回了。*/</span>
        <span style="color:#66d9ef">if</span> (obj<span style="color:#f92672">-&gt;</span>GetClass<span style="color:#f92672">&lt;</span>kDefaultVerifyFlags, kWithoutReadBarrier<span style="color:#f92672">&gt;</span>() <span style="color:#f92672">==</span> <span style="color:#66d9ef">nullptr</span>) { <span style="color:#66d9ef">return</span>;}
        <span style="color:#66d9ef">else</span> {
            callback(obj, arg);<span style="color:#75715e">//调用callback,main
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//获取下一个对象的位置，
</span><span style="color:#75715e"></span>            pos <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*&gt;</span>(GetNextObject(obj));<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>        }
        }
        <span style="color:#75715e">//如果还有其他线程的TLAB的话，则继续遍历。此时就需要考虑BlockHeader的存在了
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">while</span> (pos <span style="color:#f92672">&lt;</span> end) {
            BlockHeader<span style="color:#f92672">*</span> header <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>BlockHeader<span style="color:#f92672">*&gt;</span>(pos);
            size_t block_size <span style="color:#f92672">=</span> header<span style="color:#f92672">-&gt;</span>size_;
            pos <span style="color:#f92672">+=</span> <span style="color:#66d9ef">sizeof</span>(BlockHeader);
            mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*&gt;</span>(pos);
            <span style="color:#66d9ef">const</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> end_obj <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">const</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*&gt;</span>(pos <span style="color:#f92672">+</span> block_size);

            <span style="color:#66d9ef">while</span> (obj <span style="color:#f92672">&lt;</span> end_obj <span style="color:#f92672">&amp;&amp;</span> obj<span style="color:#f92672">-&gt;</span>GetClass<span style="color:#f92672">&lt;</span>kDefaultVerifyFlags,
                kWithoutReadBarrier<span style="color:#f92672">&gt;</span>() <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) {
            callback(obj, arg);
            obj <span style="color:#f92672">=</span> GetNextObject(obj);
        }
        pos <span style="color:#f92672">+=</span> block_size;
    }
}
</code></pre></div><h4 id="getnextobjectmirrorobject-obj">GetNextObject(mirror::Object* obj)</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> BumpPointerSpace<span style="color:#f92672">::</span>GetNextObject(mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj) {
<span style="color:#75715e">//obj表示当前所遍历的object对象的地址。那么，下一个对象的地址就是obj+obj的大小。
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> uintptr_t position <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>uintptr_t<span style="color:#f92672">&gt;</span>(obj) <span style="color:#f92672">+</span> obj<span style="color:#f92672">-&gt;</span>SizeOf();
    <span style="color:#75715e">//按8字节对齐
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*&gt;</span>(RoundUp(position, kAlignment));
}
</code></pre></div><h3 id="getbytesallocated">GetBytesAllocated</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">uint64_t</span> BumpPointerSpace<span style="color:#f92672">::</span>GetBytesAllocated() {
    <span style="color:#75715e">//由图13-2可知，bytes_allocated_表示main block部分所分配的内存大小
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint64_t</span> total <span style="color:#f92672">=</span> <span style="color:#66d9ef">static_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint64_t</span><span style="color:#f92672">&gt;</span>(bytes_allocated_.LoadRelaxed());
    Thread<span style="color:#f92672">*</span> self <span style="color:#f92672">=</span> Thread<span style="color:#f92672">::</span>Current();
    ......
    <span style="color:#75715e">/*如果有多个线程使用TLAB，则需要计算它们的TLAB大小。   */</span>
    std<span style="color:#f92672">::</span>list<span style="color:#f92672">&lt;</span>Thread<span style="color:#f92672">*&gt;</span>thread_list <span style="color:#f92672">=</span> Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>GetThreadList()<span style="color:#f92672">-&gt;</span>GetList();
 ......
    <span style="color:#66d9ef">if</span> (num_blocks_ <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
        <span style="color:#66d9ef">for</span> (Thread<span style="color:#f92672">*</span> <span style="color:#66d9ef">thread</span> <span style="color:#f92672">:</span> thread_list) {
            total <span style="color:#f92672">+=</span> <span style="color:#66d9ef">thread</span><span style="color:#f92672">-&gt;</span>GetThreadLocalBytesAllocated();<span style="color:#75715e">//Thread GetThreadLocalBytesAllocated返回值就是tlsPtr_.thread_local_end减去 tlsPtr_.thread_local_start的差。
</span><span style="color:#75715e"></span>        }
    }
    <span style="color:#66d9ef">return</span> total;
}
</code></pre></div><h2 id="regionspace">RegionSpace</h2>
<ul>
<li>RegionSpace的内存分配算法比BumpPointerSpace稍微高级一点。它先将内存资源划分成一个个固定大小（由kRegionSize指定，默认为1MB）的内存块。每一个内存块由一个Region对象表示。进行内存分配时，先找到满足要求的Region，然后从这个Region中分配资源。</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">class RegionSpace FINAL : public ContinuousMemMapAllocSpace {
    ......
    <span style="color:#75715e">//枚举变量RegionType用于描述内存块的类型。有些内容需要结合内存回收的相关知识才能理解，
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//此处暂且不表
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">enum</span> class RegionType : uint8_t {
      kRegionTypeAll, kRegionTypeFromSpace,
      kRegionTypeUnevacFromSpace,  kRegionTypeToSpace,
      kRegionTypeNone,
    };
    <span style="color:#75715e">//枚举变量RegionState用于描述内存块的内存分配状态。
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">enum</span> class RegionState : uint8_t {
        kRegionStateFree, <span style="color:#75715e">//内存块还未分配过内存
</span><span style="color:#75715e"></span>        kRegionStateAllocated, <span style="color:#75715e">//内存块分配过一些内存
</span><span style="color:#75715e"></span>        <span style="color:#75715e">/*如果需要分配比如3.5MB空间的话，则需要动用四个内存块。第一个内存块的状态将设置为
</span><span style="color:#75715e">          kRegionStateLarge，表示该Region为一个超过kRegionSize大小的内存的起始部分。
</span><span style="color:#75715e">          后面三个内存块的状态均为kRegionStateLargeTail。注意，第四个内存块将只用到0.5MB
</span><span style="color:#75715e">          的空间，剩下的0.5MB空间不能再用于内存分配。 */</span>
        kRegionStateLarge,
        kRegionStateLargeTail,
    };
}
</code></pre></div><h3 id="create-1">Create</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">RegionSpace<span style="color:#f92672">*</span> RegionSpace<span style="color:#f92672">::</span>Create(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> name, size_t capacity,
                          <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> requested_begin) {
    capacity <span style="color:#f92672">=</span> RoundUp(capacity, kRegionSize);<span style="color:#75715e">//按1MB大小向上对齐
</span><span style="color:#75715e"></span>    std<span style="color:#f92672">::</span>string error_msg;
    <span style="color:#75715e">//创建一个MemMap对象
</span><span style="color:#75715e"></span>    std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>MemMap<span style="color:#f92672">&gt;</span> mem_map(MemMap<span style="color:#f92672">::</span>MapAnonymous(name.c_str(),
        requested_begin, capacity, ...));
    ......
    <span style="color:#75715e">//创建RegionSpace对象
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> RegionSpace(name, mem_map.release());
}

RegionSpace<span style="color:#f92672">::</span>RegionSpace(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> name, MemMap<span style="color:#f92672">*</span> mem_map)
    <span style="color:#f92672">:</span> ContinuousMemMapAllocSpace(name, mem_map, mem_map<span style="color:#f92672">-&gt;</span>Begin(),
            mem_map<span style="color:#f92672">-&gt;</span>End(), mem_map<span style="color:#f92672">-&gt;</span>End(),kGcRetentionPolicyAlwaysCollect),
      region_lock_(<span style="color:#e6db74">&#34;Region lock&#34;</span>, kRegionSpaceRegionLock), time_(<span style="color:#ae81ff">1U</span>) {
    size_t mem_map_size <span style="color:#f92672">=</span> mem_map<span style="color:#f92672">-&gt;</span>Size();
    <span style="color:#75715e">//计算有多少个Region,main
</span><span style="color:#75715e"></span>    num_regions_ <span style="color:#f92672">=</span> mem_map_size <span style="color:#f92672">/</span> kRegionSize;<span style="color:#75715e">//1MB
</span><span style="color:#75715e"></span>    num_non_free_regions_ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0U</span>;<span style="color:#75715e">//该成员变量表示已经占有的内存块个数
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//创建Region数组
</span><span style="color:#75715e"></span>    regions_.reset(<span style="color:#66d9ef">new</span> Region[num_regions_]);
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> region_addr <span style="color:#f92672">=</span> mem_map<span style="color:#f92672">-&gt;</span>Begin();
    <span style="color:#75715e">//初始化regions_数组的成员
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (size_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> num_regions_; <span style="color:#f92672">++</span>i, region_addr <span style="color:#f92672">+=</span> kRegionSize) {
        <span style="color:#75715e">//构造Region对象。region_addr表示该区域的起始地址，region_addr+kRegionSize
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//为该内存区域的尾部地址
</span><span style="color:#75715e"></span>        regions_[i] <span style="color:#f92672">=</span> Region(i, region_addr, region_addr <span style="color:#f92672">+</span> kRegionSize);
    }
    <span style="color:#75715e">//full_region_表示一个内存资源不足的内存块，其用法见下文代码分析
</span><span style="color:#75715e"></span>    full_region_ <span style="color:#f92672">=</span> Region();
    <span style="color:#75715e">//current_region_指向当前正在用的内存块,main
</span><span style="color:#75715e"></span>    current_region_ <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>full_region_;
    <span style="color:#75715e">//evac_region_成员变量的含义需要配合内存回收相关知识才能理解，我们后文碰到时再介绍
</span><span style="color:#75715e"></span>    evac_region_ <span style="color:#f92672">=</span> <span style="color:#66d9ef">nullptr</span>;
}
</code></pre></div><h3 id="alloc-1">Alloc</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">inline</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> RegionSpace<span style="color:#f92672">::</span>Alloc(Thread<span style="color:#f92672">*</span>, size_t num_bytes,
                  size_t<span style="color:#f92672">*</span> bytes_allocated, size_t<span style="color:#f92672">*</span> usable_size,
                  size_t<span style="color:#f92672">*</span> bytes_tl_bulk_allocated) {
    <span style="color:#75715e">//按8字节向上对齐
</span><span style="color:#75715e"></span>    num_bytes <span style="color:#f92672">=</span> RoundUp(num_bytes, kAlignment);
    <span style="color:#66d9ef">return</span> AllocNonvirtual<span style="color:#f92672">&lt;</span>false<span style="color:#f92672">&gt;</span>(num_bytes, bytes_allocated, usable_size,
                              bytes_tl_bulk_allocated);
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> kForEvac<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> RegionSpace<span style="color:#f92672">::</span>AllocNonvirtual(size_t num_bytes,
                         size_t<span style="color:#f92672">*</span> bytes_allocated, size_t<span style="color:#f92672">*</span> usable_size,
                         size_t<span style="color:#f92672">*</span> bytes_tl_bulk_allocated) {
    <span style="color:#75715e">//AllocNonvirtual函数有一个模板参数kForEvac。该参数和内存回收有关。我们先不讨论它。
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//Alloc调用AllocNonvirtual时，kForEvac取值为false
</span><span style="color:#75715e"></span>    mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj;
    <span style="color:#75715e">//如果所需内存小于kRegionSize，则从当前的region对象中分配
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (LIKELY(num_bytes <span style="color:#f92672">&lt;=</span> kRegionSize)) {
        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>kForEvac) {
        <span style="color:#75715e">//调用Region的Alloc函数。由RegionSpace的Create函数可知，current_region_
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//最初是指向full_region_的。所以，下面的Alloc肯定返回nullptr
</span><span style="color:#75715e"></span>        obj <span style="color:#f92672">=</span> current_region_<span style="color:#f92672">-&gt;</span>Alloc(num_bytes, bytes_allocated, usable_size,
                               bytes_tl_bulk_allocated);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>        } <span style="color:#66d9ef">else</span> {<span style="color:#75715e">//如果kForEvac为true，则从evac_region_指向的Region中分配
</span><span style="color:#75715e"></span>        obj <span style="color:#f92672">=</span> evac_region_<span style="color:#f92672">-&gt;</span>Alloc(num_bytes, bytes_allocated, usable_size,
                               bytes_tl_bulk_allocated);
        }
        <span style="color:#75715e">//如果obj创建成功，则返回它
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (LIKELY(obj <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>)) {  <span style="color:#66d9ef">return</span> obj; }

        <span style="color:#75715e">//如果执行到这，表明上面的内存分配失败。注意，上面的代码中并未使用锁同步。现在，
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//我们需要重新尝试分配（因为有可能别的线程设置了current_region_，使得它指向
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//一个新的内存块，而这个内存块里说不定就有空闲的内存资源）
</span><span style="color:#75715e"></span>        MutexLock <span style="color:#a6e22e">mu</span>(Thread<span style="color:#f92672">::</span>Current(), region_lock_);
        <span style="color:#75715e">//具体的内存分配代码和上面完全一样
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>kForEvac) {
        obj <span style="color:#f92672">=</span> current_region_<span style="color:#f92672">-&gt;</span>Alloc(num_bytes, bytes_allocated, usable_size,
                            bytes_tl_bulk_allocated);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>    } <span style="color:#66d9ef">else</span> {
        obj <span style="color:#f92672">=</span> evac_region_<span style="color:#f92672">-&gt;</span>Alloc(num_bytes, bytes_allocated, usable_size,
                            bytes_tl_bulk_allocated);
    }
    <span style="color:#66d9ef">if</span> (LIKELY(obj <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>)) {  <span style="color:#66d9ef">return</span> obj; }
    <span style="color:#75715e">//如果此时内存还分配失败（说明其他线程没有更新current_region_），则我们需要自己
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//来遍历regions_数组以找到一个空闲的内存块,main
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>kForEvac) {
        <span style="color:#75715e">/*RegionSpace的用法和Copying垃圾回收方法有关，该方法要求预留一半的内存作为
</span><span style="color:#75715e">        fromspace。所以，在下面的if条件中，如果已经被占用的内存块个数超过总内存块个数的
</span><span style="color:#75715e">        一半，则不再允许内存分配。*/</span>
    <span style="color:#66d9ef">if</span> ((num_non_free_regions_ <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">&gt;</span>num_regions_) { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nullptr</span>;}

        <span style="color:#75715e">//遍历内存块，找到一个空闲的内存块
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> (size_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span>num_regions_; <span style="color:#f92672">++</span>i) {
            Region<span style="color:#f92672">*</span> r <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>regions_[i];<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//Region IsFree返回region state_成员变量的值。regions_数组中各个Region
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//对象的state_初值为kRegionStateFree，表示内存块还未分配过内存
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> (r<span style="color:#f92672">-&gt;</span>IsFree()) {
                <span style="color:#75715e">//Region Unfree设置state_的值为kRegionStateAllocated，同时设置
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//type_为kRegionTypeToSpace
</span><span style="color:#75715e"></span>                r<span style="color:#f92672">-&gt;</span>Unfree(time_);
                r<span style="color:#f92672">-&gt;</span>SetNewlyAllocated();
                <span style="color:#f92672">++</span>num_non_free_regions_;
                obj <span style="color:#f92672">=</span> r<span style="color:#f92672">-&gt;</span>Alloc(num_bytes, bytes_allocated, usable_size,
                               bytes_tl_bulk_allocated);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>                current_region_ <span style="color:#f92672">=</span> r;<span style="color:#75715e">//更新current_region_
</span><span style="color:#75715e"></span>                <span style="color:#66d9ef">return</span> obj;
            }
        }
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">//kForEvac为true的处理
</span><span style="color:#75715e"></span>......
}
</code></pre></div><h3 id="allocnewtlab-1">AllocNewTlab</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">bool</span> RegionSpace<span style="color:#f92672">::</span>AllocNewTlab(Thread<span style="color:#f92672">*</span> self) {
    MutexLock <span style="color:#a6e22e">mu</span>(self, region_lock_);
    RevokeThreadLocalBuffersLocked(self);
    <span style="color:#75715e">//同Alloc函数里的注释一样，我们要预留一半的空间
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> ((num_non_free_regions_ <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">&gt;</span> num_regions_) {
        <span style="color:#66d9ef">return</span> false;
    }
    <span style="color:#75715e">//找到一个空闲的Region对象
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (size_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> num_regions_; <span style="color:#f92672">++</span>i) {
        Region<span style="color:#f92672">*</span> r <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>regions_[i];
        <span style="color:#66d9ef">if</span> (r<span style="color:#f92672">-&gt;</span>IsFree()) {
            r<span style="color:#f92672">-&gt;</span>Unfree(time_);
            <span style="color:#f92672">++</span>num_non_free_regions_;
            r<span style="color:#f92672">-&gt;</span>SetTop(r<span style="color:#f92672">-&gt;</span>End());
            <span style="color:#75715e">//将这个Region和对应的线程关联起来,main
</span><span style="color:#75715e"></span>            r<span style="color:#f92672">-&gt;</span>is_a_tlab_ <span style="color:#f92672">=</span> true;
            r<span style="color:#f92672">-&gt;</span>thread_ <span style="color:#f92672">=</span> self;
            <span style="color:#75715e">//对线程而言，它只需要关注TLAB是否存在。如果存在的话，这块内存有多大。线程并不关心
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//内存是由哪个Space以何种方式提供。
</span><span style="color:#75715e"></span>            self<span style="color:#f92672">-&gt;</span>SetTlab(r<span style="color:#f92672">-&gt;</span>Begin(), r<span style="color:#f92672">-&gt;</span>End());
            <span style="color:#66d9ef">return</span> true;
        }
    }
    <span style="color:#66d9ef">return</span> false;
}
</code></pre></div><h3 id="freethread-mirrorobject-1">Free(Thread*, mirror::Object*)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">size_t <span style="color:#a6e22e">Free</span>(Thread<span style="color:#f92672">*</span>, mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span>) OVERRIDE {
    UNIMPLEMENTED(FATAL);<span style="color:#75715e">//不能释放单个对象所分配的内存
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><h3 id="clear-1">Clear</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> RegionSpace<span style="color:#f92672">::</span>Clear() {
    MutexLock <span style="color:#a6e22e">mu</span>(Thread<span style="color:#f92672">::</span>Current(), region_lock_);
    <span style="color:#75715e">//遍历regions_数组
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (size_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> num_regions_; <span style="color:#f92672">++</span>i) {
        Region<span style="color:#f92672">*</span> r <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>regions_[i];
        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>r<span style="color:#f92672">-&gt;</span>IsFree()) {
            <span style="color:#f92672">--</span>num_non_free_regions_;
        }
        r<span style="color:#f92672">-&gt;</span>Clear();<span style="color:#75715e">//调用Region Clear
</span><span style="color:#75715e"></span>    }
    current_region_ <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>full_region_;
    evac_region_ <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>full_region_;
}
</code></pre></div><h3 id="walkobjectcallback-callback-void-arg-2">Walk(ObjectCallback* callback, void* arg)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Walk</span>(ObjectCallback<span style="color:#f92672">*</span> callback, <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> arg) {
    WalkInternal<span style="color:#f92672">&lt;</span>false<span style="color:#f92672">&gt;</span>(callback, arg);
}
</code></pre></div><h3 id="regionspaceregion">RegionSpace::Region</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Region</span> {
    <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
        Region()
        <span style="color:#75715e">//idx_为内存块在RegionSpace regions_数组中的索引
</span><span style="color:#75715e"></span>        <span style="color:#f92672">:</span> idx_(<span style="color:#66d9ef">static_cast</span><span style="color:#f92672">&lt;</span>size_t<span style="color:#f92672">&gt;</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)),
        <span style="color:#75715e">//begin_和end_代表内存资源的起始位置，top_为内存分配的水位线
</span><span style="color:#75715e"></span>        begin_(<span style="color:#66d9ef">nullptr</span>), top_(<span style="color:#66d9ef">nullptr</span>), end_(<span style="color:#66d9ef">nullptr</span>),
        state_(RegionState<span style="color:#f92672">::</span>kRegionStateAllocated),
        type_(RegionType<span style="color:#f92672">::</span>kRegionTypeToSpace),
        <span style="color:#75715e">//objects_allocated_表示创建了多少个Object对象，
</span><span style="color:#75715e"></span>        objects_allocated_(<span style="color:#ae81ff">0</span>),
        ......
        <span style="color:#75715e">//is_a_tlab_表示该内存块是否被用作TLAB，thread_表示用它作TLAB的线程
</span><span style="color:#75715e"></span>        is_a_tlab_(false), thread_(<span style="color:#66d9ef">nullptr</span>) {
        <span style="color:#75715e">//RegionSpace构造函数中，full_region_成员变量通过这个构造函数来创建
</span><span style="color:#75715e"></span>    }
    <span style="color:#75715e">//RegionSpace构造函数中，regions_数组中的Region元素通过下面这个构造函数来创建
</span><span style="color:#75715e"></span>    Region(size_t idx, <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> begin, <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> end)
        <span style="color:#f92672">:</span> idx_(idx), begin_(begin), top_(begin), end_(end),
        state_(RegionState<span style="color:#f92672">::</span>kRegionStateFree),
        type_(RegionType<span style="color:#f92672">::</span>kRegionTypeNone),
        ...... {}
}
</code></pre></div><h4 id="alloc-2">Alloc</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">inline</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> RegionSpace<span style="color:#f92672">::</span>Region<span style="color:#f92672">::</span>Alloc(size_t num_bytes,
          size_t<span style="color:#f92672">*</span> bytes_allocated, size_t<span style="color:#f92672">*</span> usable_size,
            size_t<span style="color:#f92672">*</span> bytes_tl_bulk_allocated) {
    <span style="color:#75715e">//atomic_top指向当前内存分配的位置
</span><span style="color:#75715e"></span>    Atomic<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*&gt;*</span> atomic_top <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>Atomic<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*&gt;*&gt;</span>(<span style="color:#f92672">&amp;</span>top_);
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> old_top;
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> new_top;
    <span style="color:#75715e">//更新分配后的内存位置
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">do</span> {
        old_top <span style="color:#f92672">=</span> atomic_top<span style="color:#f92672">-&gt;</span>LoadRelaxed();
        new_top <span style="color:#f92672">=</span> old_top <span style="color:#f92672">+</span> num_bytes;
        <span style="color:#66d9ef">if</span> (UNLIKELY(new_top <span style="color:#f92672">&gt;</span> end_)) { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nullptr</span>;  }
    } <span style="color:#66d9ef">while</span> (<span style="color:#f92672">!</span>atomic_top<span style="color:#f92672">-&gt;</span>CompareExchangeWeakSequentiallyConsistent(
            old_top, new_top));

    <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>Atomic<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint64_t</span><span style="color:#f92672">&gt;*&gt;</span>(<span style="color:#f92672">&amp;</span>objects_allocated_)<span style="color:#f92672">-&gt;</span>
                     FetchAndAddSequentiallyConsistent(<span style="color:#ae81ff">1</span>);
    <span style="color:#f92672">*</span>bytes_allocated <span style="color:#f92672">=</span> num_bytes;
    <span style="color:#66d9ef">if</span> (usable_size <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) {
        <span style="color:#f92672">*</span>usable_size <span style="color:#f92672">=</span> num_bytes;
    }
    <span style="color:#f92672">*</span>bytes_tl_bulk_allocated <span style="color:#f92672">=</span> num_bytes;
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*&gt;</span>(old_top);
}
</code></pre></div><h4 id="clear-2">Clear</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Clear</span>() {
    top_ <span style="color:#f92672">=</span> begin_;
    state_ <span style="color:#f92672">=</span> RegionState<span style="color:#f92672">::</span>kRegionStateFree;
    type_ <span style="color:#f92672">=</span> RegionType<span style="color:#f92672">::</span>kRegionTypeNone;
    objects_allocated_ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    alloc_time_ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    live_bytes_ <span style="color:#f92672">=</span> <span style="color:#66d9ef">static_cast</span><span style="color:#f92672">&lt;</span>size_t<span style="color:#f92672">&gt;</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>kMadviseZeroes) {memset(begin_, <span style="color:#ae81ff">0</span>, end_ <span style="color:#f92672">-</span> begin_);}
    madvise(begin_, end_ <span style="color:#f92672">-</span> begin_, MADV_DONTNEED);
    is_newly_allocated_ <span style="color:#f92672">=</span> false;
    is_a_tlab_ <span style="color:#f92672">=</span> false;
    thread_ <span style="color:#f92672">=</span> <span style="color:#66d9ef">nullptr</span>;
}
</code></pre></div><h2 id="mallocspace">MallocSpace</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">MallocSpace<span style="color:#f92672">::</span>MallocSpace(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> name, MemMap<span style="color:#f92672">*</span> mem_map,
        .....,  <span style="color:#66d9ef">bool</span> create_bitmaps,.....)
    <span style="color:#f92672">:</span> ContinuousMemMapAllocSpace(name, mem_map,....
            kGcRetentionPolicyAlwaysCollect),
        ...... {
    <span style="color:#75715e">//DlMallocSpace和RosAllocSpace创建时均设置create_bitmaps为true
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (create_bitmaps) {
         <span style="color:#75715e">//bitmap_index_是一个全局静态变量，用于给位图对象命名
</span><span style="color:#75715e"></span>        size_t bitmap_index <span style="color:#f92672">=</span> bitmap_index_<span style="color:#f92672">++</span>;
        ......
        <span style="color:#75715e">/*创建live_bitmap_和mark_bitmap_。我们不关心它们的命名。这两个位图对象覆盖的内存
</span><span style="color:#75715e">          范围从MemMap Begin开始，大小是MemMap Size（NonGrowthLimitCapacity函数内部
</span><span style="color:#75715e">          调用MemMap Size）。简单点说，live_bitmap_和mark_bitmap_位图对象所包含的位图数
</span><span style="color:#75715e">          组恰好覆盖了这个MallocSpace所关联的MemMap内存空间。*/</span>
        live_bitmap_.reset(accounting<span style="color:#f92672">::</span>ContinuousSpaceBitmap<span style="color:#f92672">::</span>Create(...,Begin(),NonGrowthLimitCapacity()));
        mark_bitmap_.reset(accounting<span style="color:#f92672">::</span>ContinuousSpaceBitmap<span style="color:#f92672">::</span>Create(..., Begin(), NonGrowthLimitCapacity()));
</code></pre></div><p>heap.cc</p>
<h2 id="heapcreatemallocspacefrommemmap">Heap::CreateMallocSpaceFromMemMap</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">space<span style="color:#f92672">::</span>MallocSpace<span style="color:#f92672">*</span> Heap<span style="color:#f92672">::</span>CreateMallocSpaceFromMemMap(MemMap<span style="color:#f92672">*</span> mem_map,
                size_t initial_size, size_t growth_limit, size_t capacity,
                <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> name, <span style="color:#66d9ef">bool</span> can_move_objects) {
    <span style="color:#75715e">/*注意参数，mem_map代表一块内存空间，内存的分配和释放均是在它上面发生的。
</span><span style="color:#75715e">      initial_size为内存空间初始分配大小。
</span><span style="color:#75715e">      growth_limit为最大的内存可分配位置，而capacity则为实际内存空间的容量。
</span><span style="color:#75715e">      growth_limit可以动态调整，但是不能超过capacity。
</span><span style="color:#75715e">      can_move_objects参数的含义和一种垃圾回收的算法有关。我们以后碰到相关代码时再
</span><span style="color:#75715e">      来介绍它。  */</span>
    space<span style="color:#f92672">::</span>MallocSpace<span style="color:#f92672">*</span> malloc_space <span style="color:#f92672">=</span> <span style="color:#66d9ef">nullptr</span>;
    <span style="color:#66d9ef">if</span> (kUseRosAlloc) {<span style="color:#75715e">//编译常量，默认为true，即ART优先使用rosalloc
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//kDefaultStartingSize为编译常量，大小为4K。下面将创建RosAllocSpace对象
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//low_memory_mode_表示是否为低内存模式。只有RosAllocSpace支持该模式
</span><span style="color:#75715e"></span>        malloc_space <span style="color:#f92672">=</span> space<span style="color:#f92672">::</span>RosAllocSpace<span style="color:#f92672">::</span>CreateFromMemMap(
                       mem_map, name, kDefaultStartingSize, initial_size,
                       growth_limit,apacity,low_memory_mode_,can_move_objects);
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">//使用DlMallocSpace。它不支持low memory模式
</span><span style="color:#75715e"></span>        malloc_space <span style="color:#f92672">=</span> space<span style="color:#f92672">::</span>DlMallocSpace<span style="color:#f92672">::</span>CreateFromMemMap(mem_map, name,
                            kDefaultStartingSize,initial_size, growth_limit,
                            capacity, can_move_objects);
}
    <span style="color:#75715e">//kUseRememberedSet值为true，下面这段if代码的相关知识留待13.8节介绍
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (collector<span style="color:#f92672">::</span>SemiSpace<span style="color:#f92672">::</span>kUseRememberedSet<span style="color:#f92672">&amp;&amp;</span>
                       non_moving_space_ <span style="color:#f92672">!=</span> main_space_) {
        <span style="color:#75715e">//创建一个RememberedSet对象。详情见13.8节的内容
</span><span style="color:#75715e"></span>        accounting<span style="color:#f92672">::</span>RememberedSet<span style="color:#f92672">*</span> rem_set  <span style="color:#f92672">=</span>
            <span style="color:#66d9ef">new</span> accounting<span style="color:#f92672">::</span>RememberedSet(std<span style="color:#f92672">::</span>string(name) <span style="color:#f92672">+</span>
                <span style="color:#e6db74">&#34; remembered set&#34;</span>, <span style="color:#66d9ef">this</span>, malloc_space);
        AddRememberedSet(rem_set);
    }
    malloc_space<span style="color:#f92672">-&gt;</span>SetFootprintLimit(malloc_space<span style="color:#f92672">-&gt;</span>Capacity());
    <span style="color:#66d9ef">return</span> malloc_space;
}
</code></pre></div><p>dlmalloc_space.cc</p>
<h2 id="dlmallocspace">DlMallocSpace</h2>
<h3 id="create-2">Create</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">DlMallocSpace<span style="color:#f92672">*</span> DlMallocSpace<span style="color:#f92672">::</span>Create(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> name,
        size_t initial_size, size_t growth_limit, size_t capacity,
        <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> requested_begin, <span style="color:#66d9ef">bool</span> can_move_objects) {
    <span style="color:#66d9ef">uint64_t</span> start_time <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    size_t starting_size <span style="color:#f92672">=</span> kPageSize;
    <span style="color:#75715e">//先创建内存资源
</span><span style="color:#75715e"></span>    MemMap<span style="color:#f92672">*</span> mem_map <span style="color:#f92672">=</span> CreateMemMap(name, starting_size, <span style="color:#f92672">&amp;</span>initial_size,
                   <span style="color:#f92672">&amp;</span>growth_limit, <span style="color:#f92672">&amp;</span>capacity, requested_begin);
    <span style="color:#75715e">//再创建DlMallocSpace对象。CreateFromMemMap的代码见下文
</span><span style="color:#75715e"></span>    DlMallocSpace<span style="color:#f92672">*</span> space <span style="color:#f92672">=</span> CreateFromMemMap(......);
    <span style="color:#66d9ef">return</span> space;
}
</code></pre></div><h4 id="createfrommemmap">CreateFromMemMap</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">DlMallocSpace<span style="color:#f92672">*</span> DlMallocSpace<span style="color:#f92672">::</span>CreateFromMemMap(MemMap<span style="color:#f92672">*</span> mem_map,
                   <span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> name, size_t starting_size,
                   size_t initial_size, size_t growth_limit, size_t capacity,
                   <span style="color:#66d9ef">bool</span> can_move_objects) {
    <span style="color:#75715e">//内部调用dlmalloc的接口，starting_size为初始大小，initial_size为dlmalloc的
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//limit水位线。CreateMspace返回的mspace为dlmalloc内部使用的结构，外界用void*
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//作为它的数据类型,main
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> mspace <span style="color:#f92672">=</span> CreateMspace(mem_map<span style="color:#f92672">-&gt;</span>Begin(), starting_size, initial_size);
    ....
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> end <span style="color:#f92672">=</span> mem_map<span style="color:#f92672">-&gt;</span>Begin() <span style="color:#f92672">+</span> starting_size;
    <span style="color:#75715e">//调用mprotect保护从starting_size水位线到capacity这段内存，后续将根据需要进行调整
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (capacity <span style="color:#f92672">-</span> starting_size <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
        CHECK_MEMORY_CALL(mprotect, (end, capacity <span style="color:#f92672">-</span> starting_size, PROT_NONE),name);
    }

    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> begin <span style="color:#f92672">=</span> mem_map<span style="color:#f92672">-&gt;</span>Begin();
    <span style="color:#66d9ef">if</span> (Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>IsRunningOnMemoryTool()) {
        ......
    } <span style="color:#66d9ef">else</span> {<span style="color:#75715e">//构造DlMallocSpace对象，它的参数比较多。将mspace传给DlMallocSPace,main
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">DlMallocSpace</span>(mem_map, initial_size, name, mspace, begin,
                        end, begin <span style="color:#f92672">+</span> capacity,growth_limit, can_move_objects,
                        starting_size);
    }
}

<span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> DlMallocSpace<span style="color:#f92672">::</span>CreateMspace(<span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> begin, size_t morecore_start,
              size_t initial_size) {
    errno <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#75715e">//create_mspace_with_base和mspace_set_footprint_limit均是dlmalloc的API
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> msp <span style="color:#f92672">=</span> create_mspace_with_base(begin, morecore_start, false);
    <span style="color:#66d9ef">if</span> (msp <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) {
        mspace_set_footprint_limit(msp, initial_size);
    }
    ......
    <span style="color:#66d9ef">return</span> msp;
}
</code></pre></div><p>rosalloc_space.cc</p>
<h2 id="rosallocspace">RosAllocSpace</h2>
<h3 id="create-3">Create</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">RosAllocSpace<span style="color:#f92672">*</span> RosAllocSpace<span style="color:#f92672">::</span>Create(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> name,
             size_t initial_size, size_t growth_limit, size_t capacity,
             <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> requested_begin, <span style="color:#66d9ef">bool</span> low_memory_mode,
             <span style="color:#66d9ef">bool</span> can_move_objects) {
    <span style="color:#66d9ef">uint64_t</span> start_time <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#75715e">//kDefaultStartingSize取值为一个内存页的大小，对x86 32位平台而言，其值为4KB
</span><span style="color:#75715e"></span>    size_t starting_size <span style="color:#f92672">=</span> Heap<span style="color:#f92672">::</span>kDefaultStartingSize;
    <span style="color:#75715e">//先创建一个MemMap对象
</span><span style="color:#75715e"></span>    MemMap<span style="color:#f92672">*</span> mem_map <span style="color:#f92672">=</span> CreateMemMap(name, starting_size, <span style="color:#f92672">&amp;</span>initial_size,
                <span style="color:#f92672">&amp;</span>growth_limit, <span style="color:#f92672">&amp;</span>capacity,   requested_begin);
    <span style="color:#75715e">//再创建RosAllocSpace对象
</span><span style="color:#75715e"></span>    RosAllocSpace<span style="color:#f92672">*</span> space <span style="color:#f92672">=</span> CreateFromMemMap(......);

    <span style="color:#66d9ef">return</span> space;
}
</code></pre></div><h4 id="createfrommemmap-1">CreateFromMemMap</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">RosAllocSpace<span style="color:#f92672">*</span> RosAllocSpace<span style="color:#f92672">::</span>CreateFromMemMap(MemMap<span style="color:#f92672">*</span> mem_map,
                <span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> name, size_t starting_size,
                size_t initial_size,size_t growth_limit, size_t capacity,
                <span style="color:#66d9ef">bool</span> low_memory_mode, <span style="color:#66d9ef">bool</span> can_move_objects) {
    <span style="color:#66d9ef">bool</span> running_on_memory_tool <span style="color:#f92672">=</span> Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>IsRunningOnMemoryTool();
    <span style="color:#75715e">//CreateRosAlloc将创建rosallc对象,main
</span><span style="color:#75715e"></span>    allocator<span style="color:#f92672">::</span>RosAlloc<span style="color:#f92672">*</span> rosalloc <span style="color:#f92672">=</span> CreateRosAlloc(
                mem_map<span style="color:#f92672">-&gt;</span>Begin(), starting_size, initial_size,
                capacity, low_memory_mode, running_on_memory_tool);
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> end <span style="color:#f92672">=</span> mem_map<span style="color:#f92672">-&gt;</span>Begin() <span style="color:#f92672">+</span> starting_size;
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> begin <span style="color:#f92672">=</span> mem_map<span style="color:#f92672">-&gt;</span>Begin();
    <span style="color:#66d9ef">if</span> (running_on_memory_tool) {
        ......
    } <span style="color:#66d9ef">else</span> {<span style="color:#75715e">//构造一个RosAllocSpace对象。RosAllocSpace构造函数和
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//DlMallocSpace构造函数类似，都很简单，笔者不拟介绍它。
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">RosAllocSpace</span>(mem_map, initial_size, name, rosalloc,...);
    }
}

allocator<span style="color:#f92672">::</span>RosAlloc<span style="color:#f92672">*</span> RosAllocSpace<span style="color:#f92672">::</span>CreateRosAlloc(<span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> begin,
             size_t morecore_start,size_t initial_size,
             size_t maximum_size, <span style="color:#66d9ef">bool</span> low_memory_mode,....) {
    errno <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#75715e">//new一个RosAlloc对象，它就是rosalloc模块。低内存模式将影响rosalloc内存释放的算法
</span><span style="color:#75715e"></span>    allocator<span style="color:#f92672">::</span>RosAlloc<span style="color:#f92672">*</span> rosalloc <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> art<span style="color:#f92672">::</span>gc<span style="color:#f92672">::</span>allocator<span style="color:#f92672">::</span>RosAlloc(
        begin, morecore_start, maximum_size,
        low_memory_mode <span style="color:#f92672">?</span>  art<span style="color:#f92672">::</span>gc<span style="color:#f92672">::</span>allocator<span style="color:#f92672">::</span>RosAlloc<span style="color:#f92672">::</span>kPageReleaseModeAll :
            art<span style="color:#f92672">::</span>gc<span style="color:#f92672">::</span>allocator<span style="color:#f92672">::</span>RosAlloc<span style="color:#f92672">::</span>kPageReleaseModeSizeAndEnd,
            running_on_memory_tool);
    <span style="color:#66d9ef">if</span> (rosalloc <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) {
        rosalloc<span style="color:#f92672">-&gt;</span>SetFootprintLimit(initial_size);
    } ......
    <span style="color:#66d9ef">return</span> rosalloc;
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">RosAlloc<span style="color:#f92672">::</span>RosAlloc(<span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> base, size_t capacity, size_t max_capacity,
          PageReleaseMode page_release_mode,
          <span style="color:#66d9ef">bool</span> running_on_memory_tool, size_t page_release_size_threshold)
    <span style="color:#f92672">:</span> base_(<span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*&gt;</span>(base)), footprint_(capacity),
      capacity_(capacity), max_capacity_(max_capacity),
      ...... {
    ....
    <span style="color:#75715e">/*图13-4、图13-5中的bracketSizes、headSizes和numOfPages等数组均为RosAlloc态
</span><span style="color:#75715e">      的静成员变量。下面的Initialize函数将初始化它们。初始化的结果已经绘制在图13-4、
</span><span style="color:#75715e">      图13-5中了。感兴趣的读者可自行研究该函数的代码。*/</span>
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>initialized_) { Initialize();  }

    <span style="color:#75715e">//创建同步锁，一共42个。当从不同粒度的内存资源池中分配内存时将使用不同的同步锁
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//对象进行保护。这样处理的好处是可提高内存分配的并发效率
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (size_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span>kNumOfSizeBrackets; i<span style="color:#f92672">++</span>) {
        size_bracket_lock_names_[i] <span style="color:#f92672">=</span>
            StringPrintf(<span style="color:#e6db74">&#34;an rosalloc size bracket %d lock&#34;</span>, <span style="color:#66d9ef">static_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>(i));
        size_bracket_locks_[i] <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Mutex(
                size_bracket_lock_names_[i].c_str(), kRosAllocBracketLock);
        <span style="color:#75715e">/*current_runs_为Run*定长数组，元素个数为42。下面的代码将设置数组的内容都指向
</span><span style="color:#75715e">          dedicated_full_run_。dedicated_full_run_是RosAlloc的静态成员变量，类型为
</span><span style="color:#75715e">          Run*。它代表一块没有内存可供分配的资源池。一般而言，可以将current_runs_各个元素
</span><span style="color:#75715e">          设置为nullptr。但使用current_runs_的地方就需要判断其元素是否为nullptr。所以，
</span><span style="color:#75715e">          此处的做法是将current_runs_各成员指向这个无法分配资源的Run对象。这样就可以消除
</span><span style="color:#75715e">          空指针的判断。而代码处理dedicated_full_run_时就和处理其他那些正常的资源分配殆尽的
</span><span style="color:#75715e">          Run对象一样即可，后续我们将看到相关的代码。*/</span>
        current_runs_[i] <span style="color:#f92672">=</span> dedicated_full_run_;
    }
    size_t num_of_pages <span style="color:#f92672">=</span> footprint_ <span style="color:#f92672">/</span> kPageSize;
    size_t max_num_of_pages <span style="color:#f92672">=</span> max_capacity_ <span style="color:#f92672">/</span> kPageSize;
    std<span style="color:#f92672">::</span>string error_msg;
    <span style="color:#75715e">//创建page_map_mem_map_ MemMap对象，参考图13-6
</span><span style="color:#75715e"></span>    page_map_mem_map_.reset(MemMap<span style="color:#f92672">::</span>MapAnonymous(<span style="color:#e6db74">&#34;rosalloc page map&#34;</span>, <span style="color:#66d9ef">nullptr</span>,
                            RoundUp(max_num_of_pages, kPageSize),.....));
    <span style="color:#75715e">//page_map_mem_map_基地址是page_map_
</span><span style="color:#75715e"></span>    page_map_ <span style="color:#f92672">=</span> page_map_mem_map_<span style="color:#f92672">-&gt;</span>Begin();
    page_map_size_ <span style="color:#f92672">=</span> num_of_pages;<span style="color:#75715e">//该RosAlloc所管理的内存页有多大，参考图13-6
</span><span style="color:#75715e"></span>    max_page_map_size_ <span style="color:#f92672">=</span> max_num_of_pages;<span style="color:#75715e">//内存最大有多少个内存页
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//free_page_run_size_map_为vector数组，类型为size_t。其作用我们下文再介绍
</span><span style="color:#75715e"></span>    free_page_run_size_map_.resize(num_of_pages);
    <span style="color:#75715e">//将base_强转成一个FreePageRun对象，可参考图13-6
</span><span style="color:#75715e"></span>    FreePageRun<span style="color:#f92672">*</span> free_pages <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>FreePageRun<span style="color:#f92672">*&gt;</span>(base_);
    <span style="color:#75715e">//设置本free_pages对象的大小并释放相关内存页。最开始时base_所对应的内存块全部
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//都是空闲的，所以第一个free_pages的大小为capacity_
</span><span style="color:#75715e"></span>    free_pages<span style="color:#f92672">-&gt;</span>SetByteSize(<span style="color:#66d9ef">this</span>, capacity_);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>    free_pages<span style="color:#f92672">-&gt;</span>ReleasePages(<span style="color:#66d9ef">this</span>);<span style="color:#75715e">//释放本free_pages所包含的内存,main
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//free_page_runs_为set&lt;FreePageRun*&gt;容器
</span><span style="color:#75715e"></span>    free_page_runs_.insert(free_pages);
}
</code></pre></div><p>RosAlloc::FreePageRun::SetByteSize</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SetByteSize</span>(RosAlloc<span style="color:#f92672">*</span> rosalloc, size_t byte_size) {
    <span style="color:#75715e">/*下面两行代码的含义如下：
</span><span style="color:#75715e">      先得到本FreePageRun的基地址fpr_base。根据上面RosAlloc的构造函数可知，FreePageRun
</span><span style="color:#75715e">      对象是将base_内存块上的地址强制转换数据类型得到的。
</span><span style="color:#75715e">      ToPageMapIndex函数用于返回fpr_base在page_map_中的索引号。参考图13-6可知，page_map_
</span><span style="color:#75715e">      一个元素代表base_中一个内存页。所以，ToPageMapIndex的实现就很容易想到了，即用fpr_base-
</span><span style="color:#75715e">      base_，然后除以内存页大小即可算出该FreePageRun对象对应哪个内存页 */</span>
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> fpr_base <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*&gt;</span>(<span style="color:#66d9ef">this</span>);
    size_t pm_idx <span style="color:#f92672">=</span> rosalloc<span style="color:#f92672">-&gt;</span>ToPageMapIndex(fpr_base);
    <span style="color:#75715e">//free_page_run_size_map_是一个数组，下面将设置对应索引的元素的值，
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//用于表示对应FreePageRun对象所管理的内存空间大小
</span><span style="color:#75715e"></span>    rosalloc<span style="color:#f92672">-&gt;</span>free_page_run_size_map_[pm_idx] <span style="color:#f92672">=</span> byte_size;
}
</code></pre></div><p>RosAlloc::FreePageRun::ReleasePages</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ReleasePages</span>(RosAlloc<span style="color:#f92672">*</span> rosalloc) {
    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> start <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*&gt;</span>(<span style="color:#66d9ef">this</span>);
    <span style="color:#75715e">//ByteSize函数是上文SetByteSize函数的对应，用于返回free_page_run_size_map_
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//对应元素的值。在RosAlloc构造函数调用流程中，byte_size返回为capacity_
</span><span style="color:#75715e"></span>    size_t byte_size <span style="color:#f92672">=</span> ByteSize(rosalloc);
    <span style="color:#75715e">//ShouldReleasePages判断是否需要释放内存页。我们下文再介绍它
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (ShouldReleasePages(rosalloc)) {
        <span style="color:#75715e">//直接看下面这个函数。start表示本FreePageRun对象在base_内存块中的起始位置
</span><span style="color:#75715e"></span>        rosalloc<span style="color:#f92672">-&gt;</span>ReleasePageRange(start, start <span style="color:#f92672">+</span> byte_size);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>    }
}
</code></pre></div><p>RosAlloc::ReleasePageRange</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">size_t RosAlloc<span style="color:#f92672">::</span>ReleasePageRange(<span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> start, <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> end) {
    <span style="color:#75715e">//start和end参数用于指明要释放的内存的起始和终点位置
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//清零这段内存
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>kMadviseZeroes) { memset(start, <span style="color:#ae81ff">0</span>, end <span style="color:#f92672">-</span> start);}
    CHECK_EQ(madvise(start, end <span style="color:#f92672">-</span> start, MADV_DONTNEED), <span style="color:#ae81ff">0</span>);
    <span style="color:#75715e">//调用者只是指明了内存段的起始和终点位置，我们需要将这个位置转换为RosAlloc内部的
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//内存页位置
</span><span style="color:#75715e"></span>    size_t pm_idx <span style="color:#f92672">=</span> ToPageMapIndex(start);<span style="color:#75715e">//返回start位置对应的内存页索引号
</span><span style="color:#75715e"></span>    size_t reclaimed_bytes <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#75715e">//返回end位置对应的内存页索引号
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> size_t max_idx <span style="color:#f92672">=</span> pm_idx <span style="color:#f92672">+</span> (end <span style="color:#f92672">-</span> start) <span style="color:#f92672">/</span> kPageSize;
    <span style="color:#66d9ef">for</span> (; pm_idx <span style="color:#f92672">&lt;</span> max_idx; <span style="color:#f92672">++</span>pm_idx) {
        <span style="color:#75715e">/*图13-6中曾说过，page_map_保存base_中各内存页的状态，kPageMapEmpty即为其中的
</span><span style="color:#75715e">          一种状态。内存页的初始状态为kPageMapReleased，表示内存在系统中还未分配。
</span><span style="color:#75715e">          kPageMapEmpty表示内存可以被回收。  */</span>
        <span style="color:#66d9ef">if</span> (page_map_[pm_idx] <span style="color:#f92672">==</span> kPageMapEmpty) {
            reclaimed_bytes <span style="color:#f92672">+=</span> kPageSize;<span style="color:#75715e">//reclaimed_bytes表示此次回收的内存大小
</span><span style="color:#75715e"></span>            page_map_[pm_idx] <span style="color:#f92672">=</span> kPageMapReleased;<span style="color:#75715e">//设置对应内存页的状态
</span><span style="color:#75715e"></span>        }
    }
    <span style="color:#66d9ef">return</span> reclaimed_bytes;
}
</code></pre></div><h3 id="alloccommon">AllocCommon</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">inline</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> RosAllocSpace<span style="color:#f92672">::</span>AllocCommon(Thread<span style="color:#f92672">*</span> self,
            size_t num_bytes, size_t<span style="color:#f92672">*</span> bytes_allocated, size_t<span style="color:#f92672">*</span> usable_size,
            size_t<span style="color:#f92672">*</span> bytes_tl_bulk_allocated) {
    size_t rosalloc_bytes_allocated <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    size_t rosalloc_usable_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    size_t rosalloc_bytes_tl_bulk_allocated <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    ......
    <span style="color:#75715e">//调用RosAlloc的Alloc函数分配内存。我们下文会详细介绍rosalloc内存分配算法
</span><span style="color:#75715e"></span>    mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*&gt;</span>(
        rosalloc_<span style="color:#f92672">-&gt;</span>Alloc<span style="color:#f92672">&lt;</span>kThreadSafe<span style="color:#f92672">&gt;</span>(self, num_bytes,
                    <span style="color:#f92672">&amp;</span>rosalloc_bytes_allocated, <span style="color:#f92672">&amp;</span>rosalloc_usable_size,
                    <span style="color:#f92672">&amp;</span>rosalloc_bytes_tl_bulk_allocated));
    ......
    <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><p>rosalloc.h</p>
<h3 id="rosallocalloc">RosAlloc::Alloc</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> kThreadSafe<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> ALWAYS_INLINE <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> RosAlloc<span style="color:#f92672">::</span>Alloc(Thread<span style="color:#f92672">*</span> self,
                   size_t size, size_t<span style="color:#f92672">*</span> bytes_allocated,size_t<span style="color:#f92672">*</span> usable_size,
                   size_t<span style="color:#f92672">*</span> bytes_tl_bulk_allocated) {
    <span style="color:#75715e">//Alloc是一个模板函数，包含模板参数kThreadSafe，默认值为true。ART虚拟机中
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//绝大部分情况下该模板参数都使用这个默认的true。我们重点介绍它的处理情况
</span><span style="color:#75715e"></span>
    <span style="color:#75715e">//kLargeSizeThreshold为2KB。如果所需的内存超过2KB，则使用AllocLargeObject
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//来处理。AllocLargeObject将留给读者自行阅读
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (UNLIKELY(size <span style="color:#f92672">&gt;</span>kLargeSizeThreshold)) {
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">AllocLargeObject</span>(self, size, bytes_allocated, usable_size,
                            bytes_tl_bulk_allocated);
    }
    <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> m;
    <span style="color:#75715e">//我们将着重介绍kThreadSafe为true的情况
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (kThreadSafe) {
        m <span style="color:#f92672">=</span> AllocFromRun(self, size, bytes_allocated, usable_size,
                    bytes_tl_bulk_allocated);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>    } <span style="color:#66d9ef">else</span> {
        .....<span style="color:#75715e">//kThreadSafe为false的情况，读者在学完本节的基础上可自行研究它
</span><span style="color:#75715e"></span>    }
    <span style="color:#66d9ef">return</span> m;
}
</code></pre></div><h4 id="rosallocallocfromrun">RosAlloc::AllocFromRun</h4>
<h4 id="rosalloc原理图">RosAlloc原理图</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h"><span style="color:#75715e">//RosAllocSpace
</span><span style="color:#75715e">//kNumOfSizeBrackets值为42,描述每种slot所支持的内存分配粒度
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">static</span> size_t bracketSizes[kNumOfSizeBrackets];
<span style="color:#75715e">//numOfPages则记录了每种slot对应的内存资源有多少（以4KB字节为单位）
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">static</span> size_t numOfPages[kNumOfSizeBrackets];
</code></pre></div><p><img src="/img/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/space.assets/image-20210213104820373.png" alt="image-20210213104820373"></p>
<p>一个Run对应一种粒度(一行)</p>
<p><img src="/img/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/space.assets/image-20210213104847484.png" alt="image-20210213104847484"></p>
<p><img src="/img/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/space.assets/image-20210213105309486.png" alt="image-20210213105309486"></p>
<p><img src="/img/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/space.assets/image-20210213105351429.png" alt="image-20210213105351429"></p>
<h4 id="rosallcallocfromrun流程图">RosAllc::AllocFromRun流程图</h4>
<pre><code class="language-mermaid" data-lang="mermaid">graph TB
SizeToIndex(&quot;size_t idx = SizeToIndexAndBracketSize(size, &amp;bracket_size)&quot;)--&gt;indexBelow16{&quot;idx &lt; 16?&quot;}
indexBelow16--&gt;|yes|getRosAllocRun(&quot;Run* thread_local_run = self-&gt;GetRosAllocRun(idx)&quot;)
getRosAllocRun--&gt;AllocSlot(&quot;slot_addr = thread_local_run-&gt;AllocSlot();&quot;)
AllocSlot--&gt;slotAddrIsNull{&quot;slot_addr == nullptr?&quot;}
slotAddrIsNull--&gt;|yes|RefillRun(&quot;thread_local_run = RefillRun(self, idx);&quot;)
RefillRun--&gt;AllocSlot2(&quot;slot_addr = thread_local_run-&gt;AllocSlot();&quot;)
indexBelow16--&gt;|no|AllocFromCurrentRunUnlocked(&quot;slot_addr = AllocFromCurrentRunUnlocked(self, idx);&quot;)
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> RosAlloc<span style="color:#f92672">::</span>AllocFromRun(Thread<span style="color:#f92672">*</span> self, size_t size,
                 size_t<span style="color:#f92672">*</span> bytes_allocated,size_t<span style="color:#f92672">*</span> usable_size, size_t<span style="color:#f92672">*</span>
                 bytes_tl_bulk_allocated) {
    size_t bracket_size;
    <span style="color:#75715e">/*SizeToIndexAndBracketSize将根据调用者所期望分配的内存大小来决定使用哪种粒度的资源池
</span><span style="color:#75715e">      （idx表示索引号）以及这种资源池中slot的大小（由bracket_size决定）。*/</span>
    size_t idx <span style="color:#f92672">=</span> SizeToIndexAndBracketSize(size, <span style="color:#f92672">&amp;</span>bracket_size);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> slot_addr;
    <span style="color:#75715e">//kNumThreadLocalSizeBrackets取值为16。由图13-4可知，idx小于16的话，对应的内
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//存分配粒度最大不超过128字节。所以，下面if条件满足的话，说明所要分配的内存大小小于
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//128字节
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (LIKELY(idx<span style="color:#f92672">&lt;</span>kNumThreadLocalSizeBrackets)) {
    <span style="color:#75715e">/*如果所需内存不超过128字节，我们会尝试从线程本地内存资源池中分配内存。注意，线程本地存储
</span><span style="color:#75715e">      内存池并不是前文提到的TLAB。但它和TLAB含义类似。只不过Thread类对rosalloc有单独的支持。下面的Thread GetRosAllocRun函数将返回tlsPtr_.rosalloc_runs数组对应索引的元
</span><span style="color:#75715e">      素。读者回顾7.5.2.1节可知，tlsPtr_有一个rosalloc_runs数组，包含16个元素，它们初始
</span><span style="color:#75715e">      化都指向RosAlloc的dedicated_full_run_对象。
</span><span style="color:#75715e">      这段if代码块表示当我们所需要的内存小于128字节时，RosAlloc将尝试从调用线程所拥有的本地
</span><span style="color:#75715e">      资源池中分配内存，这样就不需要同步锁的保护了，如此可提高内存分配的速度。
</span><span style="color:#75715e">      注意，由于初始值都指向dedicated_full_run_，下面的代码执行时将无须判断thread_local_
</span><span style="color:#75715e">      run是否为nullptr。*/</span>
    Run<span style="color:#f92672">*</span> thread_local_run <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>Run<span style="color:#f92672">*&gt;</span>(self<span style="color:#f92672">-&gt;</span>GetRosAllocRun(idx));
    <span style="color:#75715e">//tlsPtr_ rosallc_runs默认取值也是dedicated_full_run_，在这个Run对象中没有可分配内
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//的内存资源。所以，首次调用下面的AllocSlot必然返回nullptr，表明当前这个Run中没有空闲存了
</span><span style="color:#75715e"></span>    slot_addr <span style="color:#f92672">=</span> thread_local_run<span style="color:#f92672">-&gt;</span>AllocSlot();
      <span style="color:#66d9ef">if</span> (UNLIKELY(slot_addr <span style="color:#f92672">==</span> <span style="color:#66d9ef">nullptr</span>)) {
        <span style="color:#75715e">/*如果slot_addr为空指针，说明thread_local_run这个Run中没有空余内存。
</span><span style="color:#75715e">          下面我们就需要解决这个问题。此时就需要同步锁的保护了。但我们只需要使用目标索引的同步
</span><span style="color:#75715e">          锁就行了。比如，分配8字节内存不够用时，我们就用保护8字节资源的同步锁。如此，它就不会
</span><span style="color:#75715e">          和保护其他内存资源的同步锁竞争，从而可提高内存分配速度。*/</span>
        MutexLock <span style="color:#a6e22e">mu</span>(self, <span style="color:#f92672">*</span>size_bracket_locks_[idx]);
        <span style="color:#66d9ef">bool</span> is_all_free_after_merge;
        <span style="color:#75715e">/*参考图13-5，Run中有thread_local_free_list_和free_list_两个用于管理空闲slot
</span><span style="color:#75715e">          的SlotFreeList对象。MergeThreadLocalFreeListToFreeList函数将thread_local_
</span><span style="color:#75715e">          free_list_里的空闲资源合并到free_list_。
</span><span style="color:#75715e">          对于dedicate_full_run_来说，合并它们后，空闲资源并不会增加，所以该函数返回false。
</span><span style="color:#75715e">          请读者阅读掌握本章内容后再自行研究下面这个函数。*/</span>
        <span style="color:#66d9ef">if</span> (thread_local_run<span style="color:#f92672">-&gt;</span>MergeThreadLocalFreeListToFreeList(
                    <span style="color:#f92672">&amp;</span>is_all_free_after_merge)) {......
        } <span style="color:#66d9ef">else</span> {<span style="color:#75715e">//MergeThreadLocalFreeListToFreeList返回false的情况
</span><span style="color:#75715e"></span>            ......
            <span style="color:#75715e">//RefillRun是重点，它将给idx所对应的Run对象添加内存资源，所以叫Refill
</span><span style="color:#75715e"></span>            thread_local_run <span style="color:#f92672">=</span> RefillRun(self, idx);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>            .....
            <span style="color:#75715e">//将thread_local_run设置为调用线程的线程本地内存资源池
</span><span style="color:#75715e"></span>            thread_local_run<span style="color:#f92672">-&gt;</span>SetIsThreadLocal(true);
            self<span style="color:#f92672">-&gt;</span>SetRosAllocRun(idx, thread_local_run);
        }
        <span style="color:#75715e">//bytes_tl_bulk_allocated表示本资源池中剩余的内存
</span><span style="color:#75715e"></span>        <span style="color:#f92672">*</span>bytes_tl_bulk_allocated <span style="color:#f92672">=</span> thread_local_run<span style="color:#f92672">-&gt;</span>NumberOfFreeSlots() <span style="color:#f92672">*</span>
                    bracket_size;
        <span style="color:#75715e">//重新分配资源。AllocSlot非常简单，就是从free_list_中返回一个Slot对象。
</span><span style="color:#75715e"></span>        slot_addr <span style="color:#f92672">=</span> thread_local_run<span style="color:#f92672">-&gt;</span>AllocSlot();<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>      } <span style="color:#66d9ef">else</span> {<span style="color:#75715e">//slot_addr不为nullptr的处理
</span><span style="color:#75715e"></span>        <span style="color:#f92672">*</span>bytes_tl_bulk_allocated <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
      }
    <span style="color:#f92672">*</span>bytes_allocated <span style="color:#f92672">=</span> bracket_size;
    <span style="color:#f92672">*</span>usable_size <span style="color:#f92672">=</span> bracket_size;
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">/*当所需内存超过128字节时，将从RosAlloc内部的资源池中分配。这个时候也需要
</span><span style="color:#75715e">          同步锁来保护了。当然，如上面代码一样，不同大小的资源池会使用不同的同步锁来保护。
</span><span style="color:#75715e">          AllocFromCurrentRunUnlocked将从RosAlloc的current_runs_[idx]中进行分配。
</span><span style="color:#75715e">          如果current_runs_[idx]对应的资源池内存资源不足，将会调用RefillRun给对应的资源池重新加满内存资源。*/</span>
        MutexLock <span style="color:#a6e22e">mu</span>(self, <span style="color:#f92672">*</span>size_bracket_locks_[idx]);
        slot_addr <span style="color:#f92672">=</span> AllocFromCurrentRunUnlocked(self, idx);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (LIKELY(slot_addr <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>)) {
            <span style="color:#f92672">*</span>bytes_allocated <span style="color:#f92672">=</span> bracket_size;
            <span style="color:#f92672">*</span>usable_size <span style="color:#f92672">=</span> bracket_size;
            <span style="color:#f92672">*</span>bytes_tl_bulk_allocated <span style="color:#f92672">=</span> bracket_size;
        }
    }
    <span style="color:#66d9ef">return</span> slot_addr;
}
</code></pre></div><h4 id="rosallocrefillrun">RosAlloc::RefillRun</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">RosAlloc<span style="color:#f92672">::</span>Run<span style="color:#f92672">*</span> RosAlloc<span style="color:#f92672">::</span>RefillRun(Thread<span style="color:#f92672">*</span> self, size_t idx) {
 ......<span style="color:#75715e">//这里还有一段处理，读者以后可自行研究这段代码
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">return</span> AllocRun(self, idx);<span style="color:#75715e">//我们看这个函数
</span><span style="color:#75715e"></span>}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">RosAlloc<span style="color:#f92672">::</span>Run<span style="color:#f92672">*</span> RosAlloc<span style="color:#f92672">::</span>AllocRun(Thread<span style="color:#f92672">*</span> self, size_t idx) {
    RosAlloc<span style="color:#f92672">::</span>Run<span style="color:#f92672">*</span> new_run <span style="color:#f92672">=</span> <span style="color:#66d9ef">nullptr</span>;
    {
        MutexLock <span style="color:#a6e22e">mu</span>(self, lock_);
        <span style="color:#75715e">/*AllocPages函数将从base_所在的内存中分配一段内存空间。这内存空间对外由一个Run
</span><span style="color:#75715e">          对象来管理。该空间的大小（以4KB为单位）由numOfPages[idx]决定。kPageMapRun
</span><span style="color:#75715e">          是内存页状态中的一种。 */</span>
        new_run <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>Run<span style="color:#f92672">*&gt;</span>(AllocPages(self,
                                   numOfPages[idx], kPageMapRun));<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>    }
    <span style="color:#66d9ef">if</span> (LIKELY(new_run <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>)) {
        new_run<span style="color:#f92672">-&gt;</span>size_bracket_idx_ <span style="color:#f92672">=</span> idx;
        .....<span style="color:#75715e">//清理这块内存资源池
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//初始化Run对象中的free_list_成员。
</span><span style="color:#75715e"></span>        new_run<span style="color:#f92672">-&gt;</span>InitFreeList();
    }
    <span style="color:#66d9ef">return</span> new_run;
}
</code></pre></div><h5 id="rosallocallocpages">RosAlloc::AllocPages</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> RosAlloc<span style="color:#f92672">::</span>AllocPages(Thread<span style="color:#f92672">*</span> self, size_t num_pages,
                     <span style="color:#66d9ef">uint8_t</span> page_map_type) {
    <span style="color:#75715e">//AllocPages是以内存页为单位进行分配的
</span><span style="color:#75715e"></span>    lock_.AssertHeld(self);
    FreePageRun<span style="color:#f92672">*</span> res <span style="color:#f92672">=</span> <span style="color:#66d9ef">nullptr</span>;<span style="color:#75715e">//RosAlloc借助FreePageRun来管理内存分配
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//req_bytes_size是以字节为单位的内存大小
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> size_t req_byte_size <span style="color:#f92672">=</span> num_pages <span style="color:#f92672">*</span> kPageSize;
    <span style="color:#75715e">//free_pages_runs_为Set&lt;FreePageRun*&gt;，第一个元素在RosAlloc构造函数中添加，
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//这个元素位于base_，所包含的空闲内存大小为capacity_。
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> it <span style="color:#f92672">=</span> free_page_runs_.begin(); it <span style="color:#f92672">!=</span> free_page_runs_.end(); ) {
        FreePageRun<span style="color:#f92672">*</span> fpr <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>it;
        size_t fpr_byte_size <span style="color:#f92672">=</span> fpr<span style="color:#f92672">-&gt;</span>ByteSize(<span style="color:#66d9ef">this</span>);
        <span style="color:#75715e">//如果当前的FreePageRun对象所管理的空闲内存资源比所需内存要多，则对当前fpr对象进行拆分
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (req_byte_size <span style="color:#f92672">&lt;=</span> fpr_byte_size) {
            free_page_runs_.erase(it<span style="color:#f92672">++</span>);<span style="color:#75715e">//当前fpr对象从容器中移除
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> (req_byte_size <span style="color:#f92672">&lt;</span> fpr_byte_size) {
                <span style="color:#75715e">//新的fpr对象为当前fpr对象的起始位置+待分配内存大小
</span><span style="color:#75715e"></span>                FreePageRun<span style="color:#f92672">*</span> remainder <span style="color:#f92672">=</span>
                    <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>FreePageRun<span style="color:#f92672">*&gt;</span>(<span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*&gt;</span>(fpr) <span style="color:#f92672">+</span> req_byte_size);
                <span style="color:#75715e">//新fpr对象所管理的空闲内存资源大小等于原fpr的大小减去此次分配的内存大小
</span><span style="color:#75715e"></span>                remainder<span style="color:#f92672">-&gt;</span>SetByteSize(<span style="color:#66d9ef">this</span>, fpr_byte_size <span style="color:#f92672">-</span> req_byte_size);
                free_page_runs_.insert(remainder);<span style="color:#75715e">//把新的fpr对象加入容器
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//更新原fpr对象所管理的内存资源大小，它将作为返回值返回给调用者
</span><span style="color:#75715e"></span>                fpr<span style="color:#f92672">-&gt;</span>SetByteSize(<span style="color:#66d9ef">this</span>, req_byte_size);
            }
            res <span style="color:#f92672">=</span> fpr;
            <span style="color:#66d9ef">break</span>;
        } <span style="color:#66d9ef">else</span> {  <span style="color:#f92672">++</span>it; }
    }

    <span style="color:#75715e">/*如果free_page_runs_中没有合适的FreePageRun对象，则考虑是否需要进行扩容。
</span><span style="color:#75715e">      base_所在的内存块初始设置的大小是capacity_，当前可用的大小由footprint_    base_所在的内存块初始设置的大小是capacity_，当前可用的大小由footprint_控制。如果footprint_小于capacity_，则还能继续扩容。这部分代码比较复杂，建议读者
</span><span style="color:#75715e">      学完本节后再自行阅读它*/</span>
    ......
    <span style="color:#66d9ef">if</span> (LIKELY(res <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>)) {
        <span style="color:#75715e">//更新内存页的状态信息。page_map_idx表示res这块新分配内存所对应的状态信息所在数组的索引
</span><span style="color:#75715e"></span>        size_t page_map_idx <span style="color:#f92672">=</span> ToPageMapIndex(res);
        <span style="color:#66d9ef">switch</span> (page_map_type) {
        <span style="color:#66d9ef">case</span> kPageMapRun:
            <span style="color:#75715e">//如上文所述，page_map_保存了base_内存页的状态信息。如果一次分配了多个内存页的话，
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//第一个内存页的状态将设置为kPageMapRun，其余内存页的状态为kPageMapRunPart
</span><span style="color:#75715e"></span>            page_map_[page_map_idx] <span style="color:#f92672">=</span> kPageMapRun;
            <span style="color:#66d9ef">for</span> (size_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;</span> num_pages; i<span style="color:#f92672">++</span>) {
                page_map_[page_map_idx <span style="color:#f92672">+</span> i] <span style="color:#f92672">=</span> kPageMapRunPart;
            }
            <span style="color:#66d9ef">break</span>;
            ......
        }
    <span style="color:#66d9ef">return</span> res;
}
</code></pre></div><h5 id="initfreelist">InitFreeList</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">InitFreeList</span>() {
    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">uint8_t</span> idx <span style="color:#f92672">=</span> size_bracket_idx_;
    <span style="color:#66d9ef">const</span> size_t bracket_size <span style="color:#f92672">=</span> bracketSizes[idx];
  <span style="color:#66d9ef">const</span> size_t bracket_size <span style="color:#f92672">=</span> bracketSizes[idx];
    <span style="color:#75715e">/*结合图13-5可知，FirstSlot函数这个Run中第一个slot的位置。代码中，一个slot由Slot类
</span><span style="color:#75715e">      表示。Slot内部有一个next_成员变量，指向下一个Slot对象。所以，一个Run中的Slot对象可
</span><span style="color:#75715e">      构成一个链表来管理。*/</span>
    Slot<span style="color:#f92672">*</span> first_slot <span style="color:#f92672">=</span> FirstSlot();
    <span style="color:#75715e">/*LastSlot返回Run中最后一个Slot的位置。free_list_是Run的成员变量，其数据类型
</span><span style="color:#75715e">      为SlotFreeList&lt;false&gt;，它是RosAlloc实现的一个用于管理Slot的容器。下面的for
</span><span style="color:#75715e">      循环将把图13-5 Run中的Slot对象通过free_list_管理起来。虽然下面的代码是从末尾
</span><span style="color:#75715e">      Slot向前遍历，但最终结果就是free_list_ head_指向第一个Slot对象。而Run中的所有
</span><span style="color:#75715e">      Slot对象又通过上面提到的Slot next_成员变量构成一个链表。 */</span>
    <span style="color:#66d9ef">for</span> (Slot<span style="color:#f92672">*</span> slot <span style="color:#f92672">=</span> LastSlot(); slot <span style="color:#f92672">&gt;=</span> first_slot; slot <span style="color:#f92672">=</span>
               slot<span style="color:#f92672">-&gt;</span>Left(bracket_size)) {
          free_list_.Add(slot);
    }
}
</code></pre></div><h4 id="rosallocrunallocslot">RosAlloc::Run::AllocSlot</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> RosAlloc<span style="color:#f92672">::</span>Run<span style="color:#f92672">::</span>AllocSlot() {
    <span style="color:#75715e">/*Remove将free_list_中移除head_所指向的那个Slot单元。从这一点可以看出，Run对Slot的管
</span><span style="color:#75715e">      理是比较简单的。就是通过一个链表把Slot单元管理起来，每次要分配的时候取链表的头部返回给
</span><span style="color:#75715e">      外界。*/</span>
    Slot<span style="color:#f92672">*</span> slot <span style="color:#f92672">=</span> free_list_.Remove();
    .....
    <span style="color:#66d9ef">return</span> slot;
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">  <span style="color:#75715e">// Compute numOfSlots and slotOffsets.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">for</span> (size_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> kNumOfSizeBrackets; i<span style="color:#f92672">++</span>) {
    size_t bracket_size <span style="color:#f92672">=</span> bracketSizes[i];
    size_t run_size <span style="color:#f92672">=</span> kPageSize <span style="color:#f92672">*</span> numOfPages[i];   
    size_t max_num_of_slots <span style="color:#f92672">=</span> run_size <span style="color:#f92672">/</span> bracket_size;
         <span style="color:#75715e">// Search for the maximum number of slots that allows enough space
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// for the header.
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> s <span style="color:#f92672">=</span> max_num_of_slots; s <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; s<span style="color:#f92672">--</span>) {
             size_t tmp_slots_size <span style="color:#f92672">=</span> bracket_size <span style="color:#f92672">*</span> s;
              <span style="color:#66d9ef">if</span> (tmp_slots_size <span style="color:#f92672">+</span> tmp_header_size <span style="color:#f92672">&lt;=</span> run_size) {
            <span style="color:#75715e">// Found the right number of slots, that is, there was enough
</span><span style="color:#75715e"></span>            <span style="color:#75715e">// space for the header (including the bit maps.)
</span><span style="color:#75715e"></span>            num_of_slots <span style="color:#f92672">=</span> s;
            header_size <span style="color:#f92672">=</span> tmp_header_size;
            <span style="color:#66d9ef">break</span>;
          }
</code></pre></div><h3 id="free">Free</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">size_t RosAllocSpace<span style="color:#f92672">::</span>Free(Thread<span style="color:#f92672">*</span> self, mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> ptr) {
    ....
    <span style="color:#66d9ef">return</span> rosalloc_<span style="color:#f92672">-&gt;</span>Free(self, ptr);<span style="color:#75715e">//调用RosAlloc的Free函数释放内存
</span><span style="color:#75715e"></span>}
</code></pre></div><h2 id="discontinuousspace">DiscontinuousSpace</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DiscontinuousSpace</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Space {
    <span style="color:#66d9ef">protected</span><span style="color:#f92672">:</span>
    <span style="color:#75715e">/*LargeObjectBitmap为类型别名，其定义如下：
</span><span style="color:#75715e">      typedef SpaceBitmap&lt;kLargeObjectAlignment&gt;LargeObjectBitmap;
</span><span style="color:#75715e">      kLargeObjectAlignment为常量，值为内存页的大小（4KB）。SpaceBitmap的详情可回顾
</span><span style="color:#75715e">      7.6.1.1.1节的内容。简单来说，SpaceBitmap是一个位图数组，该数组以比特位为元素：
</span><span style="color:#75715e">      (1) 数组的每一位对应一段内存空间中一个内存单元的位置。内存单元的大小等于模板参数的值。
</span><span style="color:#75715e">          比如上面的kLargeObjectAlignment表示以一个内存单元大小为4KB
</span><span style="color:#75715e">      (2) 如果位图数组某个元素取值为1，则表明对应的内存单元中有内容。如果为0，则表示对应的内存单元没有内容。比如，我们在内存单元中创建了一个对象时，就需要修改位图数组中对应比特位元素的值为1。*/</span>
    std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>accounting<span style="color:#f92672">::</span>LargeObjectBitmap<span style="color:#f92672">&gt;</span>live_bitmap_;
    std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>accounting<span style="color:#f92672">::</span>LargeObjectBitmap<span style="color:#f92672">&gt;</span>mark_bitmap_;
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">DiscontinuousSpace<span style="color:#f92672">::</span>DiscontinuousSpace(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> name,
                        GcRetentionPolicy gc_retention_policy) <span style="color:#f92672">:</span>
        Space(name, gc_retention_policy) {
    <span style="color:#66d9ef">const</span> size_t capacity <span style="color:#f92672">=</span> <span style="color:#66d9ef">static_cast</span><span style="color:#f92672">&lt;</span>size_t<span style="color:#f92672">&gt;</span>(std<span style="color:#f92672">::</span>numeric_limits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">&gt;::</span>max());
    live_bitmap_.reset(accounting<span style="color:#f92672">::</span>LargeObjectBitmap<span style="color:#f92672">::</span>Create(<span style="color:#e6db74">&#34;large live objects&#34;</span>, <span style="color:#66d9ef">nullptr</span>, capacity));
    mark_bitmap_.reset(accounting<span style="color:#f92672">::</span>LargeObjectBitmap<span style="color:#f92672">::</span>Create(<span style="color:#e6db74">&#34;large marked objects&#34;</span>, <span style="color:#66d9ef">nullptr</span>, capacity));
}
</code></pre></div><h2 id="largeobjectmapspace">LargeObjectMapSpace</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">LargeObjectMapSpace<span style="color:#f92672">*</span> LargeObjectMapSpace<span style="color:#f92672">::</span>Create(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> name) {
    <span style="color:#66d9ef">if</span> (Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>IsRunningOnMemoryTool()) {......}
    <span style="color:#66d9ef">else</span> {<span style="color:#75715e">//构造一个LargeObjectMapSpace对象。其构造函数非常简单
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">LargeObjectMapSpace</span>(name);
    }
}
</code></pre></div><h3 id="alloc-3">Alloc</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> LargeObjectMapSpace<span style="color:#f92672">::</span>Alloc(Thread<span style="color:#f92672">*</span> self, size_t num_bytes,
                size_t<span style="color:#f92672">*</span> bytes_allocated, size_t<span style="color:#f92672">*</span> usable_size,
                size_t<span style="color:#f92672">*</span> bytes_tl_bulk_allocated) {
    std<span style="color:#f92672">::</span>string error_msg;
    <span style="color:#75715e">//这就是LargeObjectMapSpace的内存分配算法，直接创建一个MemMap对象
</span><span style="color:#75715e"></span>    MemMap<span style="color:#f92672">*</span> mem_map <span style="color:#f92672">=</span> MemMap<span style="color:#f92672">::</span>MapAnonymous(<span style="color:#e6db74">&#34;large object space allocation&#34;</span>,
                            <span style="color:#66d9ef">nullptr</span>, num_bytes, PROT_READ <span style="color:#f92672">|</span> PROT_WRITE,
                            true, false, <span style="color:#f92672">&amp;</span>error_msg);
    <span style="color:#75715e">//将这块内存映射空间的基地址转换为返回值的类型
</span><span style="color:#75715e"></span>    mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> obj <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*&gt;</span>(
                                mem_map<span style="color:#f92672">-&gt;</span>Begin());
    MutexLock <span style="color:#a6e22e">mu</span>(self, lock_);
    <span style="color:#75715e">/*large_objects_是LargeObjectMapSpace的成员变量，类型为
</span><span style="color:#75715e">        AllocationTrackingSafeMap&lt;mirror::Object*, LargeObject,
</span><span style="color:#75715e">            kAllocatorTagLOSMaps&gt;。读者不要被这个看起来很复杂的数据结构吓到，
</span><span style="color:#75715e">        AllocationTrakingSafeMap其实就是一个map，key的类型是Object*，value的类型是
</span><span style="color:#75715e">        LargeObject。LargeObject是LargeObjectMapSpace中的内部类，用于保存该内存映射
</span><span style="color:#75715e">        空间所对应的MemMap对象。 */</span>
    large_objects_.Put(obj, LargeObject {mem_map, false});
    ......<span style="color:#75715e">//其他一些处理，略过
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> obj;
}
</code></pre></div><p>thread.h</p>
<h2 id="thread">Thread</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h"><span style="color:#75715e">//虽然tlsPtr_是我们的老熟人了，但它还有一些成员变量的含义在前面的章节中没有介绍
</span><span style="color:#75715e"></span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">PACKED</span>(<span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">void</span><span style="color:#f92672">*</span>)) tls_ptr_sized_values {
    ......
    <span style="color:#75715e">//下面这个变量表示TLAB上分配了多个对象
</span><span style="color:#75715e"></span>    size_t thread_local_objects;
    <span style="color:#75715e">//指明TLAB的起始位置
</span><span style="color:#75715e"></span>    uint8_t<span style="color:#f92672">*</span> thread_local_start;
    <span style="color:#75715e">/*指明TLAB当前所分配的内存位置，它位于thread_local_start和thread_local_end
</span><span style="color:#75715e">      之间。[thread_local_start,thead_local_pos)这部分空间属于已经分配的内存，
</span><span style="color:#75715e">      [thead_local_pos,thread_local_end)这部分为空闲待分配的内存。*/</span>
    uint8_t<span style="color:#f92672">*</span> thread_local_pos;
    uint8_t<span style="color:#f92672">*</span> thread_local_end;<span style="color:#75715e">//指明TLAB的末尾位置
</span><span style="color:#75715e"></span>    ......
} tlsPtr_;
</code></pre></div><h3 id="settlab">SetTlab</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> Thread<span style="color:#f92672">::</span>SetTlab(<span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> start, <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> end) {
    tlsPtr_.thread_local_start <span style="color:#f92672">=</span> start;
    tlsPtr_.thread_local_pos  <span style="color:#f92672">=</span> tlsPtr_.thread_local_start;
    tlsPtr_.thread_local_end <span style="color:#f92672">=</span> end;
    tlsPtr_.thread_local_objects <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><h3 id="alloctlab">AllocTlab</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h"><span style="color:#66d9ef">inline</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> Thread<span style="color:#f92672">::</span>AllocTlab(size_t bytes) {
    <span style="color:#f92672">++</span>tlsPtr_.thread_local_objects;
    mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> ret <span style="color:#f92672">=</span>
        reinterpret_cast<span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*&gt;</span>(tlsPtr_.thread_local_pos);
    tlsPtr_.thread_local_pos <span style="color:#f92672">+=</span> bytes;<span style="color:#75715e">//更新内存水位线即可
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> ret;
}
</code></pre></div><h2 id="tlab设计思路">TLAB设计思路</h2>
<p><img src="/img/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/space.assets/image-20210213151737547.png" alt="image-20210213151737547"></p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/alloc_gc/runtime_visitroots/" title="Runtime_VisitRoots"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/en/android/%E8%99%9A%E6%8B%9F%E6%9C%BA/art_lock/" title="ART_Lock" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1617797149"></script>
    <script src="/js/perfect-scrollbar.min.js?1617797149"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1617797149"></script>
    <script src="/js/jquery.sticky.js?1617797149"></script>
    <script src="/js/featherlight.min.js?1617797149"></script>
    <script src="/js/highlight.pack.js?1617797149"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1617797149"></script>
    <script src="/js/learn.js?1617797149"></script>
    <script src="/js/hugo-learn.js?1617797149"></script>
    
        
            <script src="/mermaid/mermaid.js?1617797149"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

