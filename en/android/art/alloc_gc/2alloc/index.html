<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.80.0" />
    <meta name="description" content="Documentation for Hugo Learn Theme">
<meta name="author" content="Mathieu Cornic">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>2Alloc :: 郑欢的学习总结</title>

    
    <link href="/css/nucleus.css?1623151669" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1623151669" rel="stylesheet">
    <link href="/css/hybrid.css?1623151669" rel="stylesheet">
    <link href="/css/featherlight.min.css?1623151669" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1623151669" rel="stylesheet">
    <link href="/css/auto-complete.css?1623151669" rel="stylesheet">
    <link href="/css/atom-one-dark.css?1623151669" rel="stylesheet">
    <link href="/css/theme.css?1623151669" rel="stylesheet">
    <link href="/css/hugo-theme.css?1623151669" rel="stylesheet">
    
    <link href="/css/theme-mine.css?1623151669" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1623151669"></script>

    <script src="/js/auto_toc_scroll.js?1623151669"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    

  </head>
  <body class="" data-url="/en/android/art/alloc_gc/2alloc/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='/en'>
    <img src="/avatar.png" width="60px" />
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1623151669"></script>
<script type="text/javascript" src="/js/auto-complete.js?1623151669"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/huanle19891345.github.io\/\/en";
    
</script>
<script type="text/javascript" src="/js/search.js?1623151669"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/en/android/" title="android" class="dd-item
        parent
        
        
        ">
      <a href="/en/android/">
          android
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/aop/" title="aop" class="dd-item
        
        
        
        ">
      <a href="/en/android/aop/">
          aop
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/aop/asm%E8%AE%BF%E5%AE%A2%E8%80%85%E6%A8%A1%E5%BC%8F/" title="ASM访客者模式" class="dd-item ">
        <a href="/en/android/aop/asm%E8%AE%BF%E5%AE%A2%E8%80%85%E6%A8%A1%E5%BC%8F/">
        ASM访客者模式
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/aop/jdk%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" title="JDK动态代理" class="dd-item ">
        <a href="/en/android/aop/jdk%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">
        JDK动态代理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/aop/%E7%BC%96%E8%AF%91%E6%8F%92%E6%A1%A9%E5%92%8C%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" title="编译插桩和动态代理" class="dd-item ">
        <a href="/en/android/aop/%E7%BC%96%E8%AF%91%E6%8F%92%E6%A1%A9%E5%92%8C%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">
        编译插桩和动态代理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/" title="art" class="dd-item
        parent
        
        
        ">
      <a href="/en/android/art/">
          art
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/1%E7%B1%BB%E7%BC%96%E8%AF%91/" title="1类编译" class="dd-item
        
        
        
        ">
      <a href="/en/android/art/1%E7%B1%BB%E7%BC%96%E8%AF%91/">
          1类编译
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/1%E7%B1%BB%E7%BC%96%E8%AF%91/dex2oat/" title="dex2oat" class="dd-item ">
        <a href="/en/android/art/1%E7%B1%BB%E7%BC%96%E8%AF%91/dex2oat/">
        dex2oat
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/1%E7%B1%BB%E7%BC%96%E8%AF%91/dex2oat%E4%BB%8B%E7%BB%8D/" title="dex2oat介绍" class="dd-item ">
        <a href="/en/android/art/1%E7%B1%BB%E7%BC%96%E8%AF%91/dex2oat%E4%BB%8B%E7%BB%8D/">
        dex2oat介绍
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/" title="2类加载" class="dd-item
        
        
        
        ">
      <a href="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/">
          2类加载
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/android_n%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91%E4%B8%8E%E5%AF%B9%E7%83%AD%E8%A1%A5%E4%B8%81%E5%BD%B1%E5%93%8D%E8%A7%A3%E6%9E%90/" title="Android_N混合编译与对热补丁影响解析" class="dd-item ">
        <a href="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/android_n%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91%E4%B8%8E%E5%AF%B9%E7%83%AD%E8%A1%A5%E4%B8%81%E5%BD%B1%E5%93%8D%E8%A7%A3%E6%9E%90/">
        Android_N混合编译与对热补丁影响解析
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" title="类加载" class="dd-item ">
        <a href="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/%E7%B1%BB%E5%8A%A0%E8%BD%BD/">
        类加载
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B1%82/" title="类加载虚拟机层" class="dd-item ">
        <a href="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B1%82/">
        类加载虚拟机层
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/alloc_gc/" title="alloc_gc" class="dd-item
        parent
        
        
        ">
      <a href="/en/android/art/alloc_gc/">
          alloc_gc
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/1space/" title="1Space" class="dd-item ">
        <a href="/en/android/art/alloc_gc/1space/">
        1Space
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/2alloc/" title="2Alloc" class="dd-item active">
        <a href="/en/android/art/alloc_gc/2alloc/">
        2Alloc
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/allocrelated/" title="AllocRelated" class="dd-item ">
        <a href="/en/android/art/alloc_gc/allocrelated/">
        AllocRelated
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/gc/" title="GC" class="dd-item ">
        <a href="/en/android/art/alloc_gc/gc/">
        GC
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/gc1_ms_cms/" title="GC1_MS_CMS" class="dd-item ">
        <a href="/en/android/art/alloc_gc/gc1_ms_cms/">
        GC1_MS_CMS
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/gc2_concurrentcopying/" title="GC2_ConcurrentCopying" class="dd-item ">
        <a href="/en/android/art/alloc_gc/gc2_concurrentcopying/">
        GC2_ConcurrentCopying
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/gc3_markcompact/" title="GC3_MarkCompact" class="dd-item ">
        <a href="/en/android/art/alloc_gc/gc3_markcompact/">
        GC3_MarkCompact
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/gc4_semi_space/" title="GC4_Semi_Space" class="dd-item ">
        <a href="/en/android/art/alloc_gc/gc4_semi_space/">
        GC4_Semi_Space
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/runtime_visitroots/" title="Runtime_VisitRoots" class="dd-item ">
        <a href="/en/android/art/alloc_gc/runtime_visitroots/">
        Runtime_VisitRoots
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/art_lock/" title="ART_Lock" class="dd-item ">
        <a href="/en/android/art/art_lock/">
        ART_Lock
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/jni/" title="jni" class="dd-item
        
        
        
        ">
      <a href="/en/android/art/jni/">
          jni
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/jni/_%E8%A7%A3%E9%87%8A%E6%89%A7%E8%A1%8C7_0/" title="_解释执行7_0" class="dd-item ">
        <a href="/en/android/art/jni/_%E8%A7%A3%E9%87%8A%E6%89%A7%E8%A1%8C7_0/">
        _解释执行7_0
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/jni/java_jni%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E5%8E%9F%E7%90%86/" title="java_jni方法调用原理" class="dd-item ">
        <a href="/en/android/art/jni/java_jni%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E5%8E%9F%E7%90%86/">
        java_jni方法调用原理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/jni/jni%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2/" title="Jni数据转换" class="dd-item ">
        <a href="/en/android/art/jni/jni%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2/">
        Jni数据转换
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/jni/systemloadlibrary/" title="SystemLoadLibrary" class="dd-item ">
        <a href="/en/android/art/jni/systemloadlibrary/">
        SystemLoadLibrary
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/jni/%E5%BC%82%E5%B8%B8/" title="异常" class="dd-item ">
        <a href="/en/android/art/jni/%E5%BC%82%E5%B8%B8/">
        异常
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/" title="启动流程" class="dd-item
        
        
        
        ">
      <a href="/en/android/art/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/">
          启动流程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/art%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/" title="ART启动流程" class="dd-item ">
        <a href="/en/android/art/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/art%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/">
        ART启动流程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="基础数据结构" class="dd-item ">
        <a href="/en/android/art/%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
        基础数据结构
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/" title="混合编译_运行" class="dd-item
        
        
        
        ">
      <a href="/en/android/art/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/">
          混合编译_运行
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/jvm_jit/" title="JVM_JIT" class="dd-item ">
        <a href="/en/android/art/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/jvm_jit/">
        JVM_JIT
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/" title="混合编译_运行" class="dd-item ">
        <a href="/en/android/art/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/">
        混合编译_运行
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/gradlejenkins/" title="gradlejenkins" class="dd-item
        
        
        
        ">
      <a href="/en/android/gradlejenkins/">
          gradlejenkins
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/androidplugin/" title="AndroidPlugin" class="dd-item ">
        <a href="/en/android/gradlejenkins/androidplugin/">
        AndroidPlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/gradlejenkins/android%E6%89%93%E5%8C%85/" title="android打包" class="dd-item
        
        
        
        ">
      <a href="/en/android/gradlejenkins/android%E6%89%93%E5%8C%85/">
          android打包
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/android%E6%89%93%E5%8C%85/android%E6%89%93%E5%8C%85/" title="Android打包" class="dd-item ">
        <a href="/en/android/gradlejenkins/android%E6%89%93%E5%8C%85/android%E6%89%93%E5%8C%85/">
        Android打包
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/gradledebug/" title="GradleDebug" class="dd-item ">
        <a href="/en/android/gradlejenkins/gradledebug/">
        GradleDebug
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/gradleplugin/" title="GradlePlugin" class="dd-item ">
        <a href="/en/android/gradlejenkins/gradleplugin/">
        GradlePlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/gradle%E6%89%93%E5%8C%85%E8%BF%87%E7%A8%8B/" title="Gradle打包过程" class="dd-item ">
        <a href="/en/android/gradlejenkins/gradle%E6%89%93%E5%8C%85%E8%BF%87%E7%A8%8B/">
        Gradle打包过程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/transform/" title="Transform" class="dd-item ">
        <a href="/en/android/gradlejenkins/transform/">
        Transform
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/" title="jetpack" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/">
          jetpack
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/" title="arch" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/">
          arch
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/1lifecycle/" title="1lifecycle" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/1lifecycle/">
          1lifecycle
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/1lifecycle/lifecycle/" title="Lifecycle" class="dd-item ">
        <a href="/en/android/jetpack/arch/1lifecycle/lifecycle/">
        Lifecycle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/1lifecycle/lifecyclecoroutine/" title="LifecycleCoroutine" class="dd-item ">
        <a href="/en/android/jetpack/arch/1lifecycle/lifecyclecoroutine/">
        LifecycleCoroutine
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/2livedata/" title="2livedata" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/2livedata/">
          2livedata
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/2livedata/1mediatorlivedata/" title="1MediatorLiveData" class="dd-item ">
        <a href="/en/android/jetpack/arch/2livedata/1mediatorlivedata/">
        1MediatorLiveData
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/2livedata/livedata/" title="LiveData" class="dd-item ">
        <a href="/en/android/jetpack/arch/2livedata/livedata/">
        LiveData
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/2livedata/livedatacoroutine/" title="LiveDataCoroutine" class="dd-item ">
        <a href="/en/android/jetpack/arch/2livedata/livedatacoroutine/">
        LiveDataCoroutine
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/2livedata/transformations/" title="Transformations" class="dd-item ">
        <a href="/en/android/jetpack/arch/2livedata/transformations/">
        Transformations
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/3viewmodel/" title="3viewmodel" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/3viewmodel/">
          3viewmodel
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/3viewmodel/saveandrestoreinstancestate/" title="SaveAndRestoreInstanceState" class="dd-item ">
        <a href="/en/android/jetpack/arch/3viewmodel/saveandrestoreinstancestate/">
        SaveAndRestoreInstanceState
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/3viewmodel/savedstatehandle/" title="SavedStateHandle" class="dd-item ">
        <a href="/en/android/jetpack/arch/3viewmodel/savedstatehandle/">
        SavedStateHandle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/3viewmodel/savingstates/" title="SavingStates" class="dd-item ">
        <a href="/en/android/jetpack/arch/3viewmodel/savingstates/">
        SavingStates
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/3viewmodel/viewmodel/" title="ViewModel" class="dd-item ">
        <a href="/en/android/jetpack/arch/3viewmodel/viewmodel/">
        ViewModel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/3viewmodel/viewmodelscope_delegate/" title="ViewModelScope_Delegate" class="dd-item ">
        <a href="/en/android/jetpack/arch/3viewmodel/viewmodelscope_delegate/">
        ViewModelScope_Delegate
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/coroutines/" title="Coroutines" class="dd-item ">
        <a href="/en/android/jetpack/arch/coroutines/">
        Coroutines
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/databinding/" title="databinding" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/databinding/">
          databinding
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/databinding/databinding/" title="Databinding" class="dd-item ">
        <a href="/en/android/jetpack/arch/databinding/databinding/">
        Databinding
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/databinding/twowaydatabinding/" title="TwoWayDataBinding" class="dd-item ">
        <a href="/en/android/jetpack/arch/databinding/twowaydatabinding/">
        TwoWayDataBinding
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/di/" title="di" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/di/">
          di
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/di/di/" title="DI" class="dd-item ">
        <a href="/en/android/jetpack/arch/di/di/">
        DI
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/di/hiltsource/" title="HiltSource" class="dd-item ">
        <a href="/en/android/jetpack/arch/di/hiltsource/">
        HiltSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/" title="架构实现" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/">
          架构实现
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/kaptgenerateviewmodel/" title="KaptGenerateViewModel" class="dd-item ">
        <a href="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/kaptgenerateviewmodel/">
        KaptGenerateViewModel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/%E6%9E%B6%E6%9E%84%E6%80%9D%E8%80%83%E5%92%8C%E5%AE%9E%E7%8E%B0/" title="架构思考和实现" class="dd-item ">
        <a href="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/%E6%9E%B6%E6%9E%84%E6%80%9D%E8%80%83%E5%92%8C%E5%AE%9E%E7%8E%B0/">
        架构思考和实现
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/%E6%9E%B6%E6%9E%84%E6%80%9D%E8%80%83%E5%92%8C%E5%AE%9E%E7%8E%B0inner/" title="架构思考和实现Inner" class="dd-item ">
        <a href="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/%E6%9E%B6%E6%9E%84%E6%80%9D%E8%80%83%E5%92%8C%E5%AE%9E%E7%8E%B0inner/">
        架构思考和实现Inner
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/compose/" title="compose" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/compose/">
          compose
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/compose/compose/" title="Compose" class="dd-item ">
        <a href="/en/android/jetpack/compose/compose/">
        Compose
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/compose/composesource/" title="ComposeSource" class="dd-item ">
        <a href="/en/android/jetpack/compose/composesource/">
        ComposeSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/compose/layoutnode/" title="LayoutNode" class="dd-item ">
        <a href="/en/android/jetpack/compose/layoutnode/">
        LayoutNode
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/compose/recomposition/" title="ReComposition" class="dd-item ">
        <a href="/en/android/jetpack/compose/recomposition/">
        ReComposition
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/supporttoandroidx/" title="SupportToAndroidx" class="dd-item ">
        <a href="/en/android/jetpack/supporttoandroidx/">
        SupportToAndroidx
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/workmanager/" title="workmanager" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/workmanager/">
          workmanager
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/workmanager/workmanager/" title="WorkManager" class="dd-item ">
        <a href="/en/android/jetpack/workmanager/workmanager/">
        WorkManager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/ndk/" title="ndk" class="dd-item
        
        
        
        ">
      <a href="/en/android/ndk/">
          ndk
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/ndk/elf%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/" title="ELF文件结构" class="dd-item ">
        <a href="/en/android/ndk/elf%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/">
        ELF文件结构
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/ndk/jni/" title="JNI" class="dd-item ">
        <a href="/en/android/ndk/jni/">
        JNI
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/ndk/native_hook/" title="native_hook" class="dd-item ">
        <a href="/en/android/ndk/native_hook/">
        native_hook
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/" title="system" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/">
          system
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/ashmem/" title="ashmem" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/ashmem/">
          ashmem
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/ashmem/%E5%8C%BF%E5%90%8D%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98ashmem/" title="匿名共享内存Ashmem" class="dd-item ">
        <a href="/en/android/system/ashmem/%E5%8C%BF%E5%90%8D%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98ashmem/">
        匿名共享内存Ashmem
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/bitmap/" title="bitmap" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/bitmap/">
          bitmap
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/bitmap/bitmap/" title="Bitmap" class="dd-item ">
        <a href="/en/android/system/bitmap/bitmap/">
        Bitmap
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/bitmap/bitmapsource/" title="BitmapSource" class="dd-item ">
        <a href="/en/android/system/bitmap/bitmapsource/">
        BitmapSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/handler/" title="handler" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/handler/">
          handler
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/handler/epoll/" title="Epoll" class="dd-item ">
        <a href="/en/android/system/handler/epoll/">
        Epoll
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/handler/looper/" title="Looper" class="dd-item ">
        <a href="/en/android/system/handler/looper/">
        Looper
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/handler/threadlocal/" title="ThreadLocal" class="dd-item ">
        <a href="/en/android/system/handler/threadlocal/">
        ThreadLocal
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/input/" title="input" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/input/">
          input
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/input/toucheventnative/" title="touchEventNative" class="dd-item ">
        <a href="/en/android/system/input/toucheventnative/">
        touchEventNative
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/kernel/" title="kernel" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/kernel/">
          kernel
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/kernel/kernel/" title="kernel" class="dd-item ">
        <a href="/en/android/system/kernel/kernel/">
        kernel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/layoutinflater/" title="layoutinflater" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/layoutinflater/">
          layoutinflater
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/layoutinflater/layoutinflater/" title="LayoutInflater" class="dd-item ">
        <a href="/en/android/system/layoutinflater/layoutinflater/">
        LayoutInflater
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/surfaceview/" title="surfaceview" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/surfaceview/">
          surfaceview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/surfaceview/surfaceviewsource/" title="SurfaceViewSource" class="dd-item ">
        <a href="/en/android/system/surfaceview/surfaceviewsource/">
        SurfaceViewSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/textureview/" title="textureview" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/textureview/">
          textureview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/textureview/textureviewsource/" title="TextureViewSource" class="dd-item ">
        <a href="/en/android/system/textureview/textureviewsource/">
        TextureViewSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/thread/" title="thread" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/thread/">
          thread
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/thread/stacktraceelement/" title="StackTraceElement" class="dd-item ">
        <a href="/en/android/system/thread/stacktraceelement/">
        StackTraceElement
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/thread/threadstate/" title="ThreadState" class="dd-item ">
        <a href="/en/android/system/thread/threadstate/">
        ThreadState
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/zygote/" title="zygote" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/zygote/">
          zygote
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/zygote/systemserversource/" title="SystemServerSource" class="dd-item ">
        <a href="/en/android/system/zygote/systemserversource/">
        SystemServerSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/zygote/zygotesource/" title="ZygoteSource" class="dd-item ">
        <a href="/en/android/system/zygote/zygotesource/">
        ZygoteSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/zygote/zygote%E8%BF%9B%E7%A8%8B/" title="Zygote进程" class="dd-item ">
        <a href="/en/android/system/zygote/zygote%E8%BF%9B%E7%A8%8B/">
        Zygote进程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/" title="后台任务" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/">
          后台任务
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1%E5%A4%84%E7%90%86/" title="后台任务处理" class="dd-item ">
        <a href="/en/android/system/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1%E5%A4%84%E7%90%86/">
        后台任务处理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/" title="多进程" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/">
          多进程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/" title="binder" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/">
          binder
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/1binderservicemanager/" title="1BinderServiceManager" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/1binderservicemanager/">
        1BinderServiceManager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/2binderserver/" title="2BinderServer" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/2binderserver/">
        2BinderServer
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/3binderclient/" title="3BinderClient" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/3binderclient/">
        3BinderClient
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/4binderkernel/" title="4BinderKernel" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/4binderkernel/">
        4BinderKernel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderdeath/" title="BinderDeath" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderdeath/">
        BinderDeath
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binder%E5%8E%9F%E7%90%86/" title="Binder原理" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binder%E5%8E%9F%E7%90%86/">
        Binder原理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/mmkv/" title="mmkv" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/mmkv/">
          mmkv
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/mmkv/mmkv/" title="MMKV" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/mmkv/mmkv/">
        MMKV
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E9%80%80%E5%87%BA/" title="应用启动退出" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E9%80%80%E5%87%BA/">
          应用启动退出
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E9%80%80%E5%87%BA/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8/" title="应用启动" class="dd-item ">
        <a href="/en/android/system/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E9%80%80%E5%87%BA/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8/">
        应用启动
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E6%BA%90%E7%A0%81%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95/" title="源码研究方法" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E6%BA%90%E7%A0%81%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95/">
          源码研究方法
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E6%BA%90%E7%A0%81%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95/syscall%E6%9F%A5%E6%89%BE%E6%96%B9%E5%BC%8F/" title="Syscall查找方式" class="dd-item ">
        <a href="/en/android/system/%E6%BA%90%E7%A0%81%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95/syscall%E6%9F%A5%E6%89%BE%E6%96%B9%E5%BC%8F/">
        Syscall查找方式
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/" title="系统绘制" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/">
          系统绘制
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/graphics/" title="Graphics" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/graphics/">
        Graphics
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/measurelayoutdraw/" title="measurelayoutdraw" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/measurelayoutdraw/">
          measurelayoutdraw
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/measurelayoutdraw/measure/" title="measure" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/measurelayoutdraw/measure/">
        measure
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/vsync/" title="Vsync" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/vsync/">
        Vsync
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/vsync_surfaceflinger/" title="Vsync_SurfaceFlinger" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/vsync_surfaceflinger/">
        Vsync_SurfaceFlinger
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E7%A1%AC%E4%BB%B6%E5%8A%A0%E9%80%9F%E7%BB%98%E5%88%B6/" title="硬件加速绘制" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E7%A1%AC%E4%BB%B6%E5%8A%A0%E9%80%9F%E7%BB%98%E5%88%B6/">
        硬件加速绘制
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E7%BB%98%E5%88%B6%E5%8E%9F%E7%90%86/" title="绘制原理" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E7%BB%98%E5%88%B6%E5%8E%9F%E7%90%86/">
        绘制原理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E8%BD%AF%E4%BB%B6%E7%BB%98%E5%88%B6/" title="软件绘制" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E8%BD%AF%E4%BB%B6%E7%BB%98%E5%88%B6/">
        软件绘制
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/ui/" title="ui" class="dd-item
        
        
        
        ">
      <a href="/en/android/ui/">
          ui
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/ui/webview/" title="webview" class="dd-item
        
        
        
        ">
      <a href="/en/android/ui/webview/">
          webview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/ui/webview/webview/" title="WebView" class="dd-item ">
        <a href="/en/android/ui/webview/webview/">
        WebView
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/ui/%E5%8A%A8%E7%94%BB/" title="动画" class="dd-item
        
        
        
        ">
      <a href="/en/android/ui/%E5%8A%A8%E7%94%BB/">
          动画
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/ui/%E5%8A%A8%E7%94%BB/animatorsource/" title="AnimatorSource" class="dd-item ">
        <a href="/en/android/ui/%E5%8A%A8%E7%94%BB/animatorsource/">
        AnimatorSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%8C%85%E4%BD%93%E7%A7%AF/" title="包体积" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%8C%85%E4%BD%93%E7%A7%AF/">
          包体积
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%8C%85%E4%BD%93%E7%A7%AF/%E5%8C%85%E4%BD%93%E7%A7%AF%E5%8E%8B%E7%BC%A9/" title="包体积压缩" class="dd-item ">
        <a href="/en/android/%E5%8C%85%E4%BD%93%E7%A7%AF/%E5%8C%85%E4%BD%93%E7%A7%AF%E5%8E%8B%E7%BC%A9/">
        包体积压缩
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%9F%8B%E7%82%B9/" title="埋点" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%9F%8B%E7%82%B9/">
          埋点
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%9F%8B%E7%82%B9/%E5%9F%8B%E7%82%B9/" title="埋点" class="dd-item ">
        <a href="/en/android/%E5%9F%8B%E7%82%B9/%E5%9F%8B%E7%82%B9/">
        埋点
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%9F%8B%E7%82%B9/%E6%98%93%E8%A7%82%E6%96%B9%E8%88%9F/" title="易观方舟" class="dd-item ">
        <a href="/en/android/%E5%9F%8B%E7%82%B9/%E6%98%93%E8%A7%82%E6%96%B9%E8%88%9F/">
        易观方舟
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%AD%98%E5%82%A8/" title="存储" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%AD%98%E5%82%A8/">
          存储
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%AD%98%E5%82%A8/sharedpreferences/" title="sharedpreferences" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%AD%98%E5%82%A8/sharedpreferences/">
          sharedpreferences
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%AD%98%E5%82%A8/sharedpreferences/sharedpreferences/" title="SharedPreferences" class="dd-item ">
        <a href="/en/android/%E5%AD%98%E5%82%A8/sharedpreferences/sharedpreferences/">
        SharedPreferences
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%AE%89%E5%85%A8/" title="安全" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%AE%89%E5%85%A8/">
          安全
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%AE%89%E5%85%A8/app%E7%AD%BE%E5%90%8D/" title="app签名" class="dd-item ">
        <a href="/en/android/%E5%AE%89%E5%85%A8/app%E7%AD%BE%E5%90%8D/">
        app签名
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%AE%89%E5%85%A8/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/" title="应用安全" class="dd-item ">
        <a href="/en/android/%E5%AE%89%E5%85%A8/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/">
        应用安全
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%AE%89%E5%85%A8/" title="网络请求安全" class="dd-item ">
        <a href="/en/android/%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%AE%89%E5%85%A8/">
        网络请求安全
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="性能优化" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">
          性能优化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/" title="apm" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/">
          apm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrixgradleplugin/" title="MatrixGradlePlugin" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrixgradleplugin/">
        MatrixGradlePlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrixsource/" title="MatrixSource" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrixsource/">
        MatrixSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrix%E6%8E%A5%E5%85%A5%E5%90%8E%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/" title="Matrix接入后遇到的问题" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrix%E6%8E%A5%E5%85%A5%E5%90%8E%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/">
        Matrix接入后遇到的问题
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrix%E7%A0%94%E7%A9%B6/" title="Matrix研究" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrix%E7%A0%94%E7%A9%B6/">
        Matrix研究
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/resource/" title="resource" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/resource/">
          resource
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/resource/matrixresourceplugin/" title="MatrixResourcePlugin" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/resource/matrixresourceplugin/">
        MatrixResourcePlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/" title="内存优化" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/">
          内存优化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/1managememory/" title="1manageMemory" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/1managememory/">
        1manageMemory
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/2oom/" title="2OOM" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/2oom/">
        2OOM
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/3hprof_binary_dump_format/" title="3Hprof_binary_dump_format" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/3hprof_binary_dump_format/">
        3Hprof_binary_dump_format
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/4dumphprof/" title="4DumpHprof" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/4dumphprof/">
        4DumpHprof
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/5leakcanary2/" title="5LeakCanary2" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/5leakcanary2/">
        5LeakCanary2
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/6leakcanary2analyze/" title="6LeakCanary2Analyze" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/6leakcanary2analyze/">
        6LeakCanary2Analyze
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/7koomsource/" title="7KOOMSource" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/7koomsource/">
        7KOOMSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/" title="布局优化" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/">
          布局优化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/" title="布局优化" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/">
        布局优化
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/" title="插件化" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/">
          插件化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/1%E6%8F%92%E4%BB%B6%E5%8C%96%E9%9D%A2%E4%B8%B4%E7%9A%84%E9%97%AE%E9%A2%98/" title="1插件化面临的问题" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/1%E6%8F%92%E4%BB%B6%E5%8C%96%E9%9D%A2%E4%B8%B4%E7%9A%84%E9%97%AE%E9%A2%98/">
        1插件化面临的问题
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/apk%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD/" title="apk安装和卸载" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/apk%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD/">
          apk安装和卸载
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/apk%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD/%E5%BA%94%E7%94%A8%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD%E8%BF%87%E7%A8%8B/" title="应用安装和卸载过程" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/apk%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD/%E5%BA%94%E7%94%A8%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD%E8%BF%87%E7%A8%8B/">
        应用安装和卸载过程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/hook/" title="Hook" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/hook/">
        Hook
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/qigsaw/" title="qigsaw" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/qigsaw/">
          qigsaw
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/qigsaw/qigsaw/" title="Qigsaw" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/qigsaw/qigsaw/">
        Qigsaw
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/" title="shadow" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/">
          shadow
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadow/" title="Shadow" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadow/">
        Shadow
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadowplugin/" title="ShadowPlugin" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadowplugin/">
        ShadowPlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadowsource/" title="ShadowSource" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadowsource/">
        ShadowSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/%E6%8F%92%E4%BB%B6%E5%8C%96%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B/" title="插件化技术选型" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/%E6%8F%92%E4%BB%B6%E5%8C%96%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B/">
        插件化技术选型
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/" title="热修复字节码" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/">
          热修复字节码
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/1hotfixresearch/" title="1hotfixResearch" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/1hotfixresearch/">
        1hotfixResearch
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/andfix/" title="AndFix" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/andfix/">
        AndFix
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/andfixsource/" title="AndFixSource" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/andfixsource/">
        AndFixSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/dex%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/" title="Dex文件格式" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/dex%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/">
        Dex文件格式
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/multidex/" title="MultiDex" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/multidex/">
        MultiDex
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/" title="tinker" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/">
          tinker
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" title="源码分析" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">
          源码分析
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/resource.arsc%E7%94%9F%E6%88%90%E5%92%8C%E7%BB%93%E6%9E%84/" title="Resource.arsc生成和结构" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/resource.arsc%E7%94%9F%E6%88%90%E5%92%8C%E7%BB%93%E6%9E%84/">
        Resource.arsc生成和结构
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkergradlepluginsource/" title="TinkerGradlePluginSource" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkergradlepluginsource/">
        TinkerGradlePluginSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkersource/" title="TinkerSource" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkersource/">
        TinkerSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/" title="稳定性" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/">
          稳定性
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/" title="异常" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/">
          异常
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/1javacrash/" title="1javacrash" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/1javacrash/">
          1javacrash
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/1javacrash/javacrashsystemhandle/" title="JavaCrashSystemHandle" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/1javacrash/javacrashsystemhandle/">
        JavaCrashSystemHandle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/" title="anr" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/">
          anr
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/1anrsystmhandle/" title="1ANRSystmHandle" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/1anrsystmhandle/">
        1ANRSystmHandle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/2anrmonitor_collectinfo/" title="2ANRMonitor_CollectInfo" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/2anrmonitor_collectinfo/">
        2ANRMonitor_CollectInfo
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/3anranalysisrootcause/" title="3ANRAnalysisRootCause" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/3anranalysisrootcause/">
        3ANRAnalysisRootCause
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/" title="nativecrash" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/">
          nativecrash
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/1nativecrash%E9%80%89%E5%9E%8B%E5%92%8C%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B/" title="1nativeCrash选型和整体流程" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/1nativecrash%E9%80%89%E5%9E%8B%E5%92%8C%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B/">
        1nativeCrash选型和整体流程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash1systemhandle/" title="nativeCrash1SystemHandle" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash1systemhandle/">
        nativeCrash1SystemHandle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash2monitor_collectstack/" title="nativeCrash2Monitor_CollectStack" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash2monitor_collectstack/">
        nativeCrash2Monitor_CollectStack
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash3symbolrecovery/" title="nativeCrash3SymbolRecovery" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash3symbolrecovery/">
        nativeCrash3SymbolRecovery
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash4analysisrootcause/" title="nativeCrash4AnalysisRootCause" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash4analysisrootcause/">
        nativeCrash4AnalysisRootCause
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/" title="xcrash" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/">
          xcrash
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/1xcrash%E5%8E%9F%E7%90%86/" title="1xCrash原理" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/1xcrash%E5%8E%9F%E7%90%86/">
        1xCrash原理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/linuxapi/" title="linuxApi" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/linuxapi/">
        linuxApi
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrashanr/" title="xCrashAnr" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrashanr/">
        xCrashAnr
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrashnativecrash/" title="xCrashNativeCrash" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrashnativecrash/">
        xCrashNativeCrash
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" title="自动化测试" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/">
          自动化测试
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/android%E4%BB%A3%E7%A0%81%E8%87%AA%E6%B5%8B/" title="android代码自测" class="dd-item ">
        <a href="/en/android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/android%E4%BB%A3%E7%A0%81%E8%87%AA%E6%B5%8B/">
        android代码自测
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/java/" title="java" class="dd-item
        
        
        
        ">
      <a href="/en/java/">
          java
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/java/blockingqueue/" title="BlockingQueue" class="dd-item ">
        <a href="/en/java/blockingqueue/">
        BlockingQueue
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/java/java%E5%B9%B6%E5%8F%91/" title="java并发" class="dd-item ">
        <a href="/en/java/java%E5%B9%B6%E5%8F%91/">
        java并发
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/java/threadpoolexecutor/" title="ThreadPoolExecutor" class="dd-item ">
        <a href="/en/java/threadpoolexecutor/">
        ThreadPoolExecutor
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/kotlin/" title="kotlin" class="dd-item
        
        
        
        ">
      <a href="/en/kotlin/">
          kotlin
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/kotlin/coroutine/" title="coroutine" class="dd-item
        
        
        
        ">
      <a href="/en/kotlin/coroutine/">
          coroutine
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B/" title="kotlin协程" class="dd-item ">
        <a href="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B/">
        kotlin协程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8Bsource/" title="kotlin协程Source" class="dd-item ">
        <a href="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8Bsource/">
        kotlin协程Source
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B%E5%8F%96%E6%B6%88/" title="kotlin协程取消" class="dd-item ">
        <a href="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B%E5%8F%96%E6%B6%88/">
        kotlin协程取消
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B%E5%BC%82%E5%B8%B8/" title="kotlin协程异常" class="dd-item ">
        <a href="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B%E5%BC%82%E5%B8%B8/">
        kotlin协程异常
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/%E4%BD%BF%E7%94%A8%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0%E6%9D%A5%E5%B0%81%E8%A3%85%E5%9B%9E%E8%B0%83/" title="使用挂起函数来封装回调" class="dd-item ">
        <a href="/en/kotlin/coroutine/%E4%BD%BF%E7%94%A8%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0%E6%9D%A5%E5%B0%81%E8%A3%85%E5%9B%9E%E8%B0%83/">
        使用挂起函数来封装回调
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/linux/" title="linux" class="dd-item
        
        
        
        ">
      <a href="/en/linux/">
          linux
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/linux/linux_io/" title="linux_io" class="dd-item ">
        <a href="/en/linux/linux_io/">
        linux_io
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/%E6%80%9D%E6%83%B3/" title="思想" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%80%9D%E6%83%B3/">
          思想
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%80%9D%E6%83%B3/ioc/" title="IOC" class="dd-item ">
        <a href="/en/%E6%80%9D%E6%83%B3/ioc/">
        IOC
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%80%9D%E6%83%B3/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/" title="程序设计规范" class="dd-item ">
        <a href="/en/%E6%80%9D%E6%83%B3/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/">
        程序设计规范
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%80%9D%E6%83%B3/%E7%BB%A7%E6%89%BF%E5%92%8C%E7%BB%84%E5%90%88/" title="继承和组合" class="dd-item ">
        <a href="/en/%E6%80%9D%E6%83%B3/%E7%BB%A7%E6%89%BF%E5%92%8C%E7%BB%84%E5%90%88/">
        继承和组合
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/" title="方向和趋势" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/">
          方向和趋势
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/" title="音视频" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/">
          音视频
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/" title="ffmpeg" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/">
          ffmpeg
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/examples/" title="examples" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/examples/">
          examples
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/examples/transcodingsource/" title="TranscodingSource" class="dd-item ">
        <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/examples/transcodingsource/">
        TranscodingSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/ffmpegdebug/" title="FFmpegDebug" class="dd-item ">
        <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/ffmpegdebug/">
        FFmpegDebug
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/webrtc/" title="webrtc" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/webrtc/">
          webrtc
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/webrtc/webrtc%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD%E5%92%8C%E7%BC%96%E8%AF%91/" title="WebRTC源码下载和编译" class="dd-item ">
        <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/webrtc/webrtc%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD%E5%92%8C%E7%BC%96%E8%AF%91/">
        WebRTC源码下载和编译
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/%E7%BC%96%E8%A7%A3%E7%A0%81/" title="编解码" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/%E7%BC%96%E8%A7%A3%E7%A0%81/">
          编解码
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/%E7%BC%96%E8%A7%A3%E7%A0%81/%E7%BC%96%E8%A7%A3%E7%A0%81%E7%9F%A5%E8%AF%86/" title="编解码知识" class="dd-item ">
        <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/%E7%BC%96%E8%A7%A3%E7%A0%81/%E7%BC%96%E8%A7%A3%E7%A0%81%E7%9F%A5%E8%AF%86/">
        编解码知识
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/" title="跨平台" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">
          跨平台
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/" title="flutter" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/">
          flutter
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/" title="1startup" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/">
          1startup
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/1startup/" title="1startup" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/1startup/">
        1startup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/2startup_embedder_framwwork/" title="2startup_embedder_framwwork" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/2startup_embedder_framwwork/">
        2startup_embedder_framwwork
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/3flutter_surface/" title="3flutter_surface" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/3flutter_surface/">
        3flutter_surface
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/4startup_dart_framework/" title="4startup_dart_framework" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/4startup_dart_framework/">
        4startup_dart_framework
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/" title="engine" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/">
          engine
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/engine/" title="Engine" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/engine/">
        Engine
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/flutterenginecache/" title="FlutterEngineCache" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/flutterenginecache/">
        FlutterEngineCache
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/flutterenginedebug%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="FlutterEngineDebug环境搭建" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/flutterenginedebug%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">
        FlutterEngineDebug环境搭建
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/flutterenginegroup/" title="FlutterEngineGroup" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/flutterenginegroup/">
        FlutterEngineGroup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/touch/" title="touch" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/touch/">
          touch
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/touch/touch/" title="Touch" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/touch/touch/">
        Touch
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%8A%A8%E7%94%BB/" title="动画" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%8A%A8%E7%94%BB/">
          动画
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%8A%A8%E7%94%BB/%E5%8A%A8%E7%94%BB/" title="动画" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%8A%A8%E7%94%BB/%E5%8A%A8%E7%94%BB/">
        动画
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/" title="响应式架构" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/">
          响应式架构
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/1%E8%B7%A8%E7%BB%84%E4%BB%B6%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE/" title="1跨组件传递数据" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/1%E8%B7%A8%E7%BB%84%E4%BB%B6%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE/">
        1跨组件传递数据
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/2provider/" title="2Provider" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/2provider/">
        2Provider
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/3%E5%BC%82%E6%AD%A5_%E5%93%8D%E5%BA%94%E5%BC%8F_%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/" title="3异步_响应式_状态管理" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/3%E5%BC%82%E6%AD%A5_%E5%93%8D%E5%BA%94%E5%BC%8F_%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/">
        3异步_响应式_状态管理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/stream/" title="stream" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/stream/">
          stream
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/stream/stream/" title="Stream" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/stream/stream/">
        Stream
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/" title="混合开发" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/">
          混合开发
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/flutterboost/" title="FlutterBoost" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/flutterboost/">
        FlutterBoost
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/flutterboost3/" title="FlutterBoost3" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/flutterboost3/">
        FlutterBoost3
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/" title="混合开发" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/">
        混合开发
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/" title="渲染" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/">
          渲染
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/widget/" title="Widget" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/widget/">
        Widget
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/%E6%B8%B2%E6%9F%93/" title="渲染" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/%E6%B8%B2%E6%9F%93/">
        渲染
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E8%B7%AF%E7%94%B1/" title="路由" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E8%B7%AF%E7%94%B1/">
          路由
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E8%B7%AF%E7%94%B1/%E8%B7%AF%E7%94%B1/" title="路由" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E8%B7%AF%E7%94%B1/%E8%B7%AF%E7%94%B1/">
        路由
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/" title="通信" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/">
          通信
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/eventchannel/" title="EventChannel" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/eventchannel/">
        EventChannel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/messageloop/" title="MessageLoop" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/messageloop/">
        MessageLoop
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/methodchannel/" title="MethodChannel" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/methodchannel/">
        MethodChannel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/pigeon/" title="Pigeon" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/pigeon/">
        Pigeon
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/huanle19891345"><i class='fab fa-fw fa-github'></i> GitHub repo</a>
              </li>
          
              <li>
                  <a class="padding" href="https://huanle19891345.github.io/en/showcase"><i class='fas fa-fw fa-camera'></i> Showcases</a>
              </li>
          
              <li>
                  <a class="padding" href="https://gohugo.io/"><i class='fas fa-fw fa-bookmark'></i> Hugo Documentation</a>
              </li>
          
              <li>
                  <a class="padding" href="https://huanle19891345.github.io/en/credits"><i class='fas fa-fw fa-bullhorn'></i> Credits</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      

      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/en/'>技术探索总结</a> > <a href='/en/android/'>android</a> > <a href='/en/android/art/'>art</a> > <a href='/en/android/art/alloc_gc/'>alloc_gc</a> > 2Alloc
          
        
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#heapchangecollectorcollectortype">Heap::ChangeCollector(CollectorType)</a>
      <ul>
        <li><a href="#changeallocatorallocatortype">ChangeAllocator(AllocatorType)</a>
          <ul>
            <li><a href="#quick_alloc_entrypointsccsetquickallocentrypointsallocator">quick_alloc_entrypoints.cc::SetQuickAllocEntryPointsAllocator</a></li>
            <li><a href="#instrumentationresetquickallocentrypoints">Instrumentation::ResetQuickAllocEntryPoints</a></li>
            <li><a href="#threadresetquickallocentrypointsforthread">Thread::ResetQuickAllocEntryPointsForThread</a></li>
            <li><a href="#quick_alloc_entrypointsccresetquickallocentrypoints">quick_alloc_entrypoints.cc::ResetQuickAllocEntryPoints</a></li>
            <li><a href="#quick_alloc_entrypointsccsetquickallocentrypointssuffix">quick_alloc_entrypoints.cc::SetQuickAllocEntryPoints##suffix</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#解释执行">解释执行</a>
      <ul>
        <li><a href="#executeswitchimpl">ExecuteSwitchImpl</a></li>
        <li><a href="#stringalloc">String::Alloc</a></li>
        <li><a href="#allocobjectfromcode">AllocObjectFromCode</a>
          <ul>
            <li><a href="#classalloc">Class::Alloc</a></li>
          </ul>
        </li>
        <li><a href="#allocarrayfromcode">AllocArrayFromCode</a>
          <ul>
            <li><a href="#arrayalloc">Array::Alloc</a></li>
          </ul>
        </li>
        <li><a href="#allocobjectwithallocator">AllocObjectWithAllocator</a>
          <ul>
            <li><a href="#heaptrytoallocate">Heap::TryToAllocate</a></li>
            <li><a href="#heapallocateinternalwithgc">Heap::AllocateInternalWithGc</a>
              <ul>
                <li><a href="#原理图">原理图</a></li>
              </ul>
            </li>
            <li><a href="#heappushonallocationstack">Heap::PushOnAllocationStack</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#机器码执行">机器码执行</a>
      <ul>
        <li><a href="#instructioncodegeneratorx86visitnewinstance">InstructionCodeGeneratorX86::VisitNewInstance</a></li>
        <li><a href="#stringalloc-1">String::Alloc</a></li>
        <li><a href="#instructioncodegeneratorx86visitnewarray">InstructionCodeGeneratorX86::VisitNewArray</a></li>
      </ul>
    </li>
    <li><a href="#heap构造函数中所创建的space">Heap构造函数中所创建的Space</a>
      <ul>
        <li><a href="#heapheap">Heap::Heap</a></li>
        <li><a href="#heapaddspace">Heap::AddSpace</a></li>
        <li><a href="#heapremovespace">Heap::RemoveSpace</a></li>
      </ul>
    </li>
    <li><a href="#cardtablespacerememberedsetmoduiontable的关系">CardTable,Space,RememberedSet,ModUionTable的关系</a>
      <ul>
        <li><a href="#heapheap-1">Heap::Heap</a>
          <ul>
            <li><a href="#cardtablecreate">CardTable::Create</a></li>
            <li><a href="#rememberedset">RememberedSet</a>
              <ul>
                <li><a href="#clearcards">ClearCards</a></li>
                <li><a href="#updateandmarkreferences">UpdateAndMarkReferences</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#markcard">MarkCard</a>
          <ul>
            <li><a href="#dofieldput">DoFieldPut</a></li>
            <li><a href="#markcard-1">MarkCard</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#object-inlhvisitreferences">Object-inl.h::VisitReferences</a>
      <ul>
        <li><a href="#visitor和javalangrefvisitor示例">Visitor和JavaLangRefVisitor示例</a></li>
        <li><a href="#classvisitreferences">Class::VisitReferences</a></li>
        <li><a href="#artfieldvisitroots">ArtField::VisitRoots</a></li>
        <li><a href="#objectarrayvisitreferences">ObjectArray::VisitReferences</a></li>
        <li><a href="#dexcachevisitreferences">DexCache::VisitReferences</a></li>
        <li><a href="#classloadervisitreferences">ClassLoader::VisitReferences</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              2Alloc
            </h1>
          

        


<pre><code class="language-mermaid" data-lang="mermaid">graph LR
subgraph CollectorType
kCollectorTypeCC
kCollectorTypeMC
kCollectorTypeSS
kCollectorTypeGSS

kCollectorTypeMS
kCollectorTypeCMS
end

subgraph AllocatorType
kCollectorTypeMS--&gt;MallocSpace
kCollectorTypeCMS--&gt;MallocSpace

kCollectorTypeCC--&gt;RegionSpace
kCollectorTypeMC--&gt;BumpPointerSpace
kCollectorTypeSS--&gt;BumpPointerSpace
kCollectorTypeGSS--&gt;BumpPointerSpace


MallocSpace--&gt;|kUseRosAlloc|kAllocatorTypeRosAlloc
MallocSpace--&gt;kAllocatorTypeDlMalloc     
RegionSpace--&gt;|use_tlab_|kAllocatorTypeRegionTLAB
RegionSpace--&gt;kAllocatorTypeRegion
BumpPointerSpace--&gt;|use_tlab_|kAllocatorTypeTLAB
BumpPointerSpace--&gt;kAllocatorTypeBumpPointer

end
</code></pre><p>heap.cc</p>
<h2 id="heapchangecollectorcollectortype">Heap::ChangeCollector(CollectorType)</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> Heap<span style="color:#f92672">::</span>ChangeCollector(CollectorType collector_type) {
    <span style="color:#75715e">/*CollectorType是一个枚举变量，用于定义不同的回收器类型。collector_type_是
</span><span style="color:#75715e">      Heap类的成员变量，描述当前设定的回收器类型。对笔者所搭建的模拟器而言，虚拟机使用的
</span><span style="color:#75715e">      回收器类型为kCollectorTypeCMS。CMS是ConcurrentMarkSweep的缩写。它是标记
</span><span style="color:#75715e">      清除垃圾回收算法的一种。本书后续章节会详细介绍它们。此处，读者仅作简单了解即可。 */</span>
    <span style="color:#66d9ef">if</span> (collector_type <span style="color:#f92672">!=</span> collector_type_) {
        collector_type_ <span style="color:#f92672">=</span> collector_type;<span style="color:#75715e">//设置垃圾回收器类型
</span><span style="color:#75715e"></span>        ......
        <span style="color:#66d9ef">switch</span> (collector_type_) {
            <span style="color:#66d9ef">case</span> kCollectorTypeCC: {<span style="color:#75715e">//CC是Concurrent Copying的缩写
</span><span style="color:#75715e"></span>                .....
                <span style="color:#66d9ef">if</span> (use_tlab_) {<span style="color:#75715e">//是否使用TLAB。本例中不使用它，所以use_tlab_为false
</span><span style="color:#75715e"></span>                    <span style="color:#75715e">//ChangeAllocator函数将设置内存分配器的类型
</span><span style="color:#75715e"></span>                    ChangeAllocator(kAllocatorTypeRegionTLAB);
                } <span style="color:#66d9ef">else</span> {
                    ChangeAllocator(kAllocatorTypeRegion);
                }
                <span style="color:#66d9ef">break</span>;
            }
            <span style="color:#66d9ef">case</span> kCollectorTypeMC:<span style="color:#75715e">//MC:Mark Compact
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">case</span> kCollectorTypeSS:<span style="color:#75715e">//SS:Semi-space
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//GSS:改进版的SS
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">case</span> kCollectorTypeGSS:{
                .....
                <span style="color:#66d9ef">if</span> (use_tlab_) {
                    ChangeAllocator(kAllocatorTypeTLAB);
                } <span style="color:#66d9ef">else</span> {
                    ChangeAllocator(kAllocatorTypeBumpPointer);
                }
                <span style="color:#66d9ef">break</span>;
            }
        <span style="color:#66d9ef">case</span> kCollectorTypeMS: {<span style="color:#75715e">//MS：mark-sweep
</span><span style="color:#75715e"></span>            ......
            ChangeAllocator(kUseRosAlloc <span style="color:#f92672">?</span> kAllocatorTypeRosAlloc :
                            kAllocatorTypeDlMalloc);
        <span style="color:#66d9ef">break</span>;
        }
        <span style="color:#66d9ef">case</span> kCollectorTypeCMS: {<span style="color:#75715e">//本例对应这种情况
</span><span style="color:#75715e"></span>            .....
            <span style="color:#75715e">//kUseRosAlloc默认为true
</span><span style="color:#75715e"></span>            ChangeAllocator(kUseRosAlloc <span style="color:#f92672">?</span> kAllocatorTypeRosAlloc : kAllocatorTypeDlMalloc);
                <span style="color:#66d9ef">break</span>;
            }
            .....
        }
        ......
    }
}
</code></pre></div><h3 id="changeallocatorallocatortype">ChangeAllocator(AllocatorType)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> Heap<span style="color:#f92672">::</span>ChangeAllocator(AllocatorType allocator) {
    <span style="color:#75715e">//current_allocator_为Heap成员变量，表示当前所设定的内存分配器类型
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (current_allocator_ <span style="color:#f92672">!=</span> allocator) {
        current_allocator_ <span style="color:#f92672">=</span> allocator;
        MutexLock <span style="color:#a6e22e">mu</span>(<span style="color:#66d9ef">nullptr</span>, <span style="color:#f92672">*</span>Locks<span style="color:#f92672">::</span>runtime_shutdown_lock_);
        <span style="color:#75715e">//下面这两个函数比较关键，我们来看它们
</span><span style="color:#75715e"></span>        SetQuickAllocEntryPointsAllocator(current_allocator_);
        Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>GetInstrumentation()<span style="color:#f92672">-&gt;</span>ResetQuickAllocEntryPoints();
    }
}
</code></pre></div><h4 id="quick_alloc_entrypointsccsetquickallocentrypointsallocator">quick_alloc_entrypoints.cc::SetQuickAllocEntryPointsAllocator</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#75715e">/*SetQuickAllocEntryPointsAllocator函数定义在quick_alloc_entrypoints.cc文件中。
</span><span style="color:#75715e">  请读者注意这个文件的文件名，它是quickallocentrypoints。ART虚拟机以机器码运行Java程序的
</span><span style="color:#75715e">  时候，如果涉及内存分配有关的指令（下文将介绍new  instance/array机器码的处理），则需要跳
</span><span style="color:#75715e">  转到和内存分配有关的入口地址去执行。这些内存分配的入口地址都定义在这个quick_alloc_entrypoints.cc
</span><span style="color:#75715e">  文件中。
</span><span style="color:#75715e">  entry_points_allocator是一个静态变量，默认取值为DlMalloc，表示默认使用dlmalloc作为内存
</span><span style="color:#75715e">  分配器。而SetQuickAllocEntryPointsAllocator可以修改它的值。下文将见到这个静态变量的作用。 */</span>
<span style="color:#66d9ef">static</span> gc<span style="color:#f92672">::</span>AllocatorType entry_points_allocator <span style="color:#f92672">=</span> gc<span style="color:#f92672">::</span>kAllocatorTypeDlMalloc;
<span style="color:#75715e">//修改entry_poionts_allocator静态变量的取值
</span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SetQuickAllocEntryPointsAllocator</span>(gc<span style="color:#f92672">::</span>AllocatorType allocator) {
    entry_points_allocator <span style="color:#f92672">=</span> allocator;
}
</code></pre></div><p>instrumentation.cc</p>
<h4 id="instrumentationresetquickallocentrypoints">Instrumentation::ResetQuickAllocEntryPoints</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> Instrumentation<span style="color:#f92672">::</span>ResetQuickAllocEntryPoints() {
    Runtime<span style="color:#f92672">*</span> runtime <span style="color:#f92672">=</span> Runtime<span style="color:#f92672">::</span>Current();
    <span style="color:#66d9ef">if</span> (runtime<span style="color:#f92672">-&gt;</span>IsStarted()) {
        MutexLock <span style="color:#a6e22e">mu</span>(Thread<span style="color:#f92672">::</span>Current(), <span style="color:#f92672">*</span>Locks<span style="color:#f92672">::</span>thread_list_lock_);
        <span style="color:#75715e">//针对每一个线程对象调用ResetQuickAllocEntryPointsForThread函数。其内部将
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//调用Thread的ResetQuickAllocEntryPointsForThread
</span><span style="color:#75715e"></span>        runtime<span style="color:#f92672">-&gt;</span>GetThreadList()<span style="color:#f92672">-&gt;</span>ForEach(ResetQuickAllocEntryPointsForThread,  <span style="color:#66d9ef">nullptr</span>);
    }
}
</code></pre></div><h4 id="threadresetquickallocentrypointsforthread">Thread::ResetQuickAllocEntryPointsForThread</h4>
<p>thread.h</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">class Thread{
    ...
    <span style="color:#75715e">/*每一个线程对象都包含tlsPtr_成员，而这个成员中有一个quick_entrypoints，它包含了很多入口
</span><span style="color:#75715e">      地址，它们在Java指令经编译得到的机器码中大量被调用。其实，它们就是机器码（也就是由Java
</span><span style="color:#75715e">      开发人员编写的程序逻辑）和虚拟机交互的入口。相关知识请读者回顾本书前面介绍的与虚拟机执行
</span><span style="color:#75715e">      有关的内容。*/</span>
    <span style="color:#66d9ef">struct</span> PACKED(<span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">void</span><span style="color:#f92672">*</span>)) tls_ptr_sized_values {
        QuickEntryPoints quick_entrypoints;
    }tlsPtr_;
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h"><span style="color:#66d9ef">void</span> Thread<span style="color:#f92672">::</span>ResetQuickAllocEntryPointsForThread() {
    <span style="color:#75715e">//修改tlsPtr_ quick_entrypoins结构体
</span><span style="color:#75715e"></span>    ResetQuickAllocEntryPoints(<span style="color:#f92672">&amp;</span>tlsPtr_.quick_entrypoints);
}
</code></pre></div><h4 id="quick_alloc_entrypointsccresetquickallocentrypoints">quick_alloc_entrypoints.cc::ResetQuickAllocEntryPoints</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ResetQuickAllocEntryPoints</span>(QuickEntryPoints<span style="color:#f92672">*</span> qpoints) {
<span style="color:#75715e">#if !defined(__APPLE__) || !defined(__LP64__)
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//这个变量我们在上文中介绍过了。以笔者所搭建的模拟器为例，它的取值是kAllocatorTypeRosAlloc
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">switch</span> (entry_points_allocator) {
        <span style="color:#66d9ef">case</span> gc<span style="color:#f92672">::</span>kAllocatorTypeDlMalloc: {
            SetQuickAllocEntryPoints_dlmalloc(qpoints, entry_points_instrumented);
            <span style="color:#66d9ef">return</span>;
        }
        <span style="color:#66d9ef">case</span> gc<span style="color:#f92672">::</span>kAllocatorTypeRosAlloc: {
            <span style="color:#75715e">//entry_points_instrumented也是一个静态变量，表示是否使用辅助工具
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//（instrumentation的含义），默认为false。我们不讨论它
</span><span style="color:#75715e"></span>            SetQuickAllocEntryPoints_rosalloc(qpoints, entry_points_instrumented);
            <span style="color:#66d9ef">return</span>;
        }
        ......
    }
    .....
    UNREACHABLE();
}
</code></pre></div><h4 id="quick_alloc_entrypointsccsetquickallocentrypointssuffix">quick_alloc_entrypoints.cc::SetQuickAllocEntryPoints##suffix</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#75715e">//在SetQuickAllocEntryPoints_rosalloc函数中，rosalloc是下面的suffix
</span><span style="color:#75715e">//所以，下面代码中pAllocObject的取值就是art_quick_alloc_object_rosalloc
</span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> SetQuickAllocEntryPoints<span style="color:#960050;background-color:#1e0010">##</span>suffix(QuickEntryPoints<span style="color:#f92672">*</span> qpoints,\
               <span style="color:#66d9ef">bool</span> instrumented) { \
    <span style="color:#66d9ef">if</span> (instrumented) { ......\
    } <span style="color:#66d9ef">else</span> { \
        qpoints<span style="color:#f92672">-&gt;</span>pAllocObject <span style="color:#f92672">=</span> art_quick_alloc_object<span style="color:#960050;background-color:#1e0010">##</span>suffix; \
        ......
    } \
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#75715e">//借助suffix，我们可以定义不同内存分配器所对应的artAllocObjectFromCodeXXX函数
</span><span style="color:#75715e"></span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> artAllocObjectFromCode <span style="color:#960050;background-color:#1e0010">##</span>suffix<span style="color:#960050;background-color:#1e0010">##</span>suffix2( \
        <span style="color:#66d9ef">uint32_t</span> type_idx, ArtMethod<span style="color:#f92672">*</span> method, Thread<span style="color:#f92672">*</span> self) { \
    ScopedQuickEntrypointChecks <span style="color:#a6e22e">sqec</span>(self); \
    .....<span style="color:#960050;background-color:#1e0010">\略过一些其他情况的处理，感兴趣的读者可自行阅读</span>
    <span style="color:#75715e">//AllocObjectFromCode我们在解释执行模式中见过了
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> AllocObjectFromCode<span style="color:#f92672">&lt;</span>false, instrumented_bool<span style="color:#f92672">&gt;</span>(type_idx, method,
                self, allocator_type); \
} \
  
<span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> mirror<span style="color:#f92672">::</span>Array<span style="color:#f92672">*</span> artAllocArrayFromCode<span style="color:#960050;background-color:#1e0010">##</span>suffix<span style="color:#960050;background-color:#1e0010">##</span>suffix2( \
        <span style="color:#66d9ef">uint32_t</span> type_idx, <span style="color:#66d9ef">int32_t</span> component_count, ArtMethod<span style="color:#f92672">*</span> method, \
            Thread<span style="color:#f92672">*</span> self) { \
    ScopedQuickEntrypointChecks <span style="color:#a6e22e">sqec</span>(self); \
    <span style="color:#75715e">//AllocArrayFromCode我们也在上文中介绍过了
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> AllocArrayFromCode<span style="color:#f92672">&lt;</span>false, instrumented_bool<span style="color:#f92672">&gt;</span>(type_idx,\
            component_count, method, self, allocator_type); \
} \
</code></pre></div><h2 id="解释执行">解释执行</h2>
<p>interpreter_switch_impl.cc</p>
<h3 id="executeswitchimpl">ExecuteSwitchImpl</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> do_access_check, <span style="color:#66d9ef">bool</span> transaction_active<span style="color:#f92672">&gt;</span>
JValue ExecuteSwitchImpl(.....) {
    ......
    <span style="color:#66d9ef">case</span> Instruction<span style="color:#f92672">::</span>NEW_INSTANCE: {
        Object<span style="color:#f92672">*</span> obj <span style="color:#f92672">=</span> <span style="color:#66d9ef">nullptr</span>;
        Class<span style="color:#f92672">*</span> c <span style="color:#f92672">=</span> ResolveVerifyAndClinit(inst<span style="color:#f92672">-&gt;</span>VRegB_21c(),
            shadow_frame.GetMethod(),self, false, do_access_check);
        <span style="color:#66d9ef">if</span> (LIKELY(c <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>)) {
            <span style="color:#66d9ef">if</span> (UNLIKELY(c<span style="color:#f92672">-&gt;</span>IsStringClass())) {
                gc<span style="color:#f92672">::</span>AllocatorType allocator_type <span style="color:#f92672">=</span>
                    Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>GetHeap()<span style="color:#f92672">-&gt;</span>GetCurrentAllocator();
                <span style="color:#75715e">//下面这个函数对象类的代码，请读者自行研究
</span><span style="color:#75715e"></span>                mirror<span style="color:#f92672">::</span>SetStringCountVisitor visitor(<span style="color:#ae81ff">0</span>);
                <span style="color:#75715e">//如果new一个String对象，则调用String Alloc函数
</span><span style="color:#75715e"></span>                obj <span style="color:#f92672">=</span> String<span style="color:#f92672">::</span>Alloc<span style="color:#f92672">&lt;</span>true<span style="color:#f92672">&gt;</span>(self, <span style="color:#ae81ff">0</span>, allocator_type, visitor);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>            } <span style="color:#66d9ef">else</span> {
                <span style="color:#75715e">//如果new非String对象，则调用AllocObjectFromCode函数
</span><span style="color:#75715e"></span>                obj <span style="color:#f92672">=</span> AllocObjectFromCode<span style="color:#f92672">&lt;</span>do_access_check, true<span style="color:#f92672">&gt;</span>(<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>                inst<span style="color:#f92672">-&gt;</span>VRegB_21c(), shadow_frame.GetMethod(), self,
                Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>GetHeap()<span style="color:#f92672">-&gt;</span>GetCurrentAllocator());
            }
        }
        ......
        <span style="color:#66d9ef">break</span>;
    }
    <span style="color:#66d9ef">case</span> Instruction<span style="color:#f92672">::</span>NEW_ARRAY: {
        <span style="color:#66d9ef">int32_t</span> length <span style="color:#f92672">=</span> shadow_frame.GetVReg(inst<span style="color:#f92672">-&gt;</span>VRegB_22c(inst_data));
        <span style="color:#75715e">//如果new一个数组，则调用AllocArrayFromCode函数
</span><span style="color:#75715e"></span>        Object<span style="color:#f92672">*</span> obj <span style="color:#f92672">=</span> AllocArrayFromCode<span style="color:#f92672">&lt;</span>do_access_check, true<span style="color:#f92672">&gt;</span>(<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>            inst<span style="color:#f92672">-&gt;</span>VRegC_22c(), length, shadow_frame.GetMethod(), self,
            Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>GetHeap()<span style="color:#f92672">-&gt;</span>GetCurrentAllocator());
        ......
        <span style="color:#66d9ef">break</span>;
        }
    .....
}
</code></pre></div><p>array.h</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">class MANAGED Array : public Object {
    ......
private:
        int32_t length_;<span style="color:#75715e">//元素的个数
</span><span style="color:#75715e"></span>        <span style="color:#75715e">/*用于存储数组元素的内容。注意，虽然first_element_元素长度是32位，但它其实只是一
</span><span style="color:#75715e">          块存储空间。该数组元素的个数需要根据Java层中对应数组元素所占位长来计算。比如，假设
</span><span style="color:#75715e">          Java层中要创建包含4个short元素的数组。那么，first_element_数组的长度就是2。
</span><span style="color:#75715e">          因为uint32_t为32位，而Java层short类型的位长是16,。*/</span>
        uint32_t first_element_[<span style="color:#ae81ff">0</span>];
};
</code></pre></div><p>string.h</p>
<h3 id="stringalloc">String::Alloc</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">class MANAGED String FINAL : public Object {
    .....
    int32_t count_;
    uint32_t hash_code_;
    uint16_t value_[<span style="color:#ae81ff">0</span>]; <span style="color:#75715e">//value_数组才是真正存储字符串内容的地方。
</span><span style="color:#75715e"></span>    .....
};
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> kIsInstrumented, <span style="color:#66d9ef">typename</span> PreFenceVisitor<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> String<span style="color:#f92672">*</span> String<span style="color:#f92672">::</span>Alloc(Thread<span style="color:#f92672">*</span> self, <span style="color:#66d9ef">int32_t</span> utf16_length,
               gc<span style="color:#f92672">::</span>AllocatorType allocator_type,
               <span style="color:#66d9ef">const</span> PreFenceVisitor<span style="color:#f92672">&amp;</span> pre_fence_visitor) {
    <span style="color:#75715e">//注意参数，utf16_length代表以UTF-16编码的字符个数。也就是说，一个字符占2个字节
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//sizeof(String)将返回String类的大小（不包括value_数组的内容）
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">constexpr</span> size_t header_size <span style="color:#f92672">=</span> <span style="color:#66d9ef">sizeof</span>(String);
    size_t length <span style="color:#f92672">=</span> <span style="color:#66d9ef">static_cast</span><span style="color:#f92672">&lt;</span>size_t<span style="color:#f92672">&gt;</span>(utf16_length);
    size_t data_size <span style="color:#f92672">=</span> <span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">uint16_t</span>) <span style="color:#f92672">*</span> length;<span style="color:#75715e">//计算字符串内容所需的内存大小
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//计算最终所需分配的内存大小
</span><span style="color:#75715e"></span>    size_t size <span style="color:#f92672">=</span> header_size <span style="color:#f92672">+</span> data_size;
    <span style="color:#75715e">//size按8字节向上对齐
</span><span style="color:#75715e"></span>    size_t alloc_size <span style="color:#f92672">=</span> RoundUp(size, kObjectAlignment);
    Class<span style="color:#f92672">*</span> string_class <span style="color:#f92672">=</span> GetJavaLangString();
    .....
    gc<span style="color:#f92672">::</span>Heap<span style="color:#f92672">*</span> heap <span style="color:#f92672">=</span> Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>GetHeap();
    <span style="color:#75715e">//调用Heap AllocObjectWithAllocator函数分配内存,main
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> down_cast<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">*&gt;</span>(
        heap<span style="color:#f92672">-&gt;</span>AllocObjectWithAllocator<span style="color:#f92672">&lt;</span>kIsInstrumented, true<span style="color:#f92672">&gt;</span>(self,
            string_class, alloc_size,allocator_type, pre_fence_visitor));
}
</code></pre></div><p>entrypoint_utils-inl.h</p>
<h3 id="allocobjectfromcode">AllocObjectFromCode</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h"><span style="color:#66d9ef">inline</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> AllocObjectFromCode(uint32_t type_idx,
        ArtMethod<span style="color:#f92672">*</span> method, Thread<span style="color:#f92672">*</span> self, gc<span style="color:#f92672">::</span>AllocatorType allocator_type) {
    ......<span style="color:#75715e">//我们仅考察内存分配的调用逻辑
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//klass代表所要创建的对象的类。调用它的Alloc函数
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> klass<span style="color:#f92672">-&gt;</span>Alloc<span style="color:#f92672">&lt;</span>kInstrumented<span style="color:#f92672">&gt;</span>(self, allocator_type);
}
</code></pre></div><h4 id="classalloc">Class::Alloc</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#75715e">//class-inl.h
</span><span style="color:#75715e"></span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> kIsInstrumented, <span style="color:#66d9ef">bool</span> kCheckAddFinalizer<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> Object<span style="color:#f92672">*</span> Class<span style="color:#f92672">::</span>Alloc(Thread<span style="color:#f92672">*</span> self,gc<span style="color:#f92672">::</span>AllocatorType allocator_type){
    .....<span style="color:#75715e">//我们仅考察内存分配的调用逻辑
</span><span style="color:#75715e"></span>    mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj <span style="color:#f92672">=</span>
        heap<span style="color:#f92672">-&gt;</span>AllocObjectWithAllocator<span style="color:#f92672">&lt;</span>kIsInstrumented, false<span style="color:#f92672">&gt;</span>(self, <span style="color:#66d9ef">this</span>,
                        <span style="color:#66d9ef">this</span><span style="color:#f92672">-&gt;</span>object_size_,allocator_type, VoidFunctor());
    ......
    <span style="color:#66d9ef">return</span> obj;
}
</code></pre></div><h3 id="allocarrayfromcode">AllocArrayFromCode</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> kAccessCheck, <span style="color:#66d9ef">bool</span> kInstrumented<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> mirror<span style="color:#f92672">::</span>Array<span style="color:#f92672">*</span> AllocArrayFromCode(<span style="color:#66d9ef">uint32_t</span> type_idx,
    <span style="color:#66d9ef">int32_t</span> component_count, ArtMethod<span style="color:#f92672">*</span> method, Thread<span style="color:#f92672">*</span> self,
        gc<span style="color:#f92672">::</span>AllocatorType allocator_type) {
    ......
    <span style="color:#66d9ef">return</span> mirror<span style="color:#f92672">::</span>Array<span style="color:#f92672">::</span>Alloc<span style="color:#f92672">&lt;</span>kInstrumented<span style="color:#f92672">&gt;</span>(self, klass, component_count,
                  klass<span style="color:#f92672">-&gt;</span>GetComponentSizeShift(), allocator_type);
}
</code></pre></div><h4 id="arrayalloc">Array::Alloc</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">array<span style="color:#f92672">-</span>inl.h
<span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> kIsInstrumented, <span style="color:#66d9ef">bool</span> kFillUsable<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> Array<span style="color:#f92672">*</span> Array<span style="color:#f92672">::</span>Alloc(Thread<span style="color:#f92672">*</span> self, Class<span style="color:#f92672">*</span> array_class,
            <span style="color:#66d9ef">int32_t</span> component_count, size_t component_size_shift,
            gc<span style="color:#f92672">::</span>AllocatorType allocator_type) {
    <span style="color:#75715e">/*下面的ComputeArraySize将根据要创建数组的元素个数（component_count决定）和元素的数据
</span><span style="color:#75715e">      类型（由component_size_shift间接决定可参考primitive.hComponentSizeShift函数）
</span><span style="color:#75715e">      来计算该数组对象最终所需要的内存大小。   */</span>
    size_t size <span style="color:#f92672">=</span> ComputeArraySize(component_count, component_size_shift);
    ......
    gc<span style="color:#f92672">::</span>Heap<span style="color:#f92672">*</span> heap <span style="color:#f92672">=</span> Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>GetHeap();
    Array<span style="color:#f92672">*</span> result;
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>kFillUsable) {<span style="color:#75715e">//kFillUsable默认为false
</span><span style="color:#75715e"></span>        SetLengthVisitor <span style="color:#a6e22e">visitor</span>(component_count);
        result <span style="color:#f92672">=</span> down_cast<span style="color:#f92672">&lt;</span>Array<span style="color:#f92672">*&gt;</span>(
            heap<span style="color:#f92672">-&gt;</span>AllocObjectWithAllocator<span style="color:#f92672">&lt;</span>kIsInstrumented, true<span style="color:#f92672">&gt;</span>(self,
                          array_class, size,allocator_type, visitor));
    } <span style="color:#66d9ef">else</span> { ......}
    ......
    <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><p>heap(-inl).h</p>
<h3 id="allocobjectwithallocator">AllocObjectWithAllocator</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h"><span style="color:#75715e">/*AllocObjectWithAllocator为模板函数，包含三个模板参数：
</span><span style="color:#75715e">    kInstrumented：和工具使用有关。我们不讨论它的情况
</span><span style="color:#75715e">    kCheckLargeObject：判断要分配的内存大小是否属于大对象的范围
</span><span style="color:#75715e">    PreFenceVisitor：一个函数对象，AllocObjectWithAllocator完成工作后会调用它。*/</span>
template <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> kInstrumented, <span style="color:#66d9ef">bool</span> kCheckLargeObject, <span style="color:#66d9ef">typename</span> PreFenceVisitor<span style="color:#f92672">&gt;</span>
    ALWAYS_INLINE mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> AllocObjectWithAllocator(Thread<span style="color:#f92672">*</span> self,
        mirror<span style="color:#f92672">::</span>Class<span style="color:#f92672">*</span> klass, size_t byte_count, AllocatorType allocator, <span style="color:#66d9ef">const</span> PreFenceVisitor<span style="color:#f92672">&amp;</span> pre_fence_visitor) {
<span style="color:#75715e">//AllocObjectWithAllocator函数参数的含义都很简单，笔者不拟赘述。另外，请读者注意
</span><span style="color:#75715e">//解释执行和机器码模式下调用这个函数时传入的内存器分配类型都是kAllocatorTypeRosAlloc
</span><span style="color:#75715e"></span>
    mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj;
    <span style="color:#75715e">/*kCheckLargeObject为true并且ShouldAllocLargeObject返回true时，将转入
</span><span style="color:#75715e">      AllocLargeObject函数。ShouldAllocLargeObject判断条件我们在上文介绍
</span><span style="color:#75715e">      LargeObjectSpace时已经讲过，如果要分配的内存大于12KB（由Heap成员变量
</span><span style="color:#75715e">      large_object_threshhold_控制，默认为12KB），并且所创建对象的类型为基础数据类
</span><span style="color:#75715e">      型的数组或String，则属于大对象内存分配的范畴。*/</span>
    <span style="color:#66d9ef">if</span> (kCheckLargeObject <span style="color:#f92672">&amp;&amp;</span> UNLIKELY(ShouldAllocLargeObject(klass , byte_count))) {
        <span style="color:#75715e">//AllocLargeObject函数将以kAllocatorTypeLOS为内存分配器的类型再次调用AllocObjectWithAllocator函数
</span><span style="color:#75715e"></span>        obj <span style="color:#f92672">=</span> AllocLargeObject<span style="color:#f92672">&lt;</span>kInstrumented, PreFenceVisitor<span style="color:#f92672">&gt;</span>(self, <span style="color:#f92672">&amp;</span>klass, byte_count, pre_fence_visitor);
        <span style="color:#75715e">/*如果obj不为空，表明内存分配成功，返回obj。如果obj为空指针，则清除可能产生的异常
</span><span style="color:#75715e">          但还需要继续尝试分配内存。因为kAllocatorTypeLOS内存分配器没有内存可分配，但其他
</span><span style="color:#75715e">          类型的内存分配器（本例是kAllocatorTypeRosAlloc）可能还有内存供分配）。   */</span>
        <span style="color:#66d9ef">if</span> (obj <span style="color:#f92672">!=</span> nullptr) {  <span style="color:#66d9ef">return</span> obj; }
        <span style="color:#66d9ef">else</span> { self<span style="color:#f92672">-&gt;</span>ClearException(); }
    }
    size_t bytes_allocated;
    size_t usable_size;
    size_t new_num_bytes_allocated <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;

    <span style="color:#66d9ef">if</span> (allocator <span style="color:#f92672">==</span> kAllocatorTypeTLAB <span style="color:#f92672">||</span> allocator <span style="color:#f92672">==</span> kAllocatorTypeRegionTLAB) {
        <span style="color:#75715e">//所需内存大小按8字节向上对齐
</span><span style="color:#75715e"></span>        byte_count <span style="color:#f92672">=</span> RoundUp(byte_count, space<span style="color:#f92672">::</span>BumpPointerSpace<span style="color:#f92672">::</span>kAlignment);
    }
    <span style="color:#75715e">/*如果使用线程本地内存资源（TLAB），则先判断线程对象（self指定）TLAB是否还有足够
</span><span style="color:#75715e">      内存。如果有，则直接从线程的TLAB中分配内存。注意，只有BumpPointerSpace和
</span><span style="color:#75715e">      RegionSpace支持TLAB。rosalloc也有线程本地内存资源，只不过名字不叫TLAB。 */</span>
    <span style="color:#66d9ef">if</span> ((allocator <span style="color:#f92672">==</span> kAllocatorTypeTLAB <span style="color:#f92672">||</span> allocator <span style="color:#f92672">==</span>  kAllocatorTypeRegionTLAB) <span style="color:#f92672">&amp;&amp;</span>  byte_count <span style="color:#f92672">&lt;=</span> self<span style="color:#f92672">-&gt;</span>TlabSize()) {
      	obj <span style="color:#f92672">=</span> self<span style="color:#f92672">-&gt;</span>AllocTlab(byte_count);
   	    obj<span style="color:#f92672">-&gt;</span>SetClass(klass);
        ......
        bytes_allocated <span style="color:#f92672">=</span> byte_count;
        usable_size <span style="color:#f92672">=</span> bytes_allocated;
        pre_fence_visitor(obj, usable_size);<span style="color:#75715e">//调用回调对象
</span><span style="color:#75715e"></span>        QuasiAtomic<span style="color:#f92672">::</span>ThreadFenceForConstructor();
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>kInstrumented <span style="color:#f92672">&amp;&amp;</span> allocator <span style="color:#f92672">==</span> kAllocatorTypeRosAlloc<span style="color:#f92672">&amp;&amp;</span>
            (obj <span style="color:#f92672">=</span> rosalloc_space_<span style="color:#f92672">-&gt;</span>AllocThreadLocal(self, byte_count , <span style="color:#f92672">&amp;</span>bytes_allocated)) <span style="color:#f92672">&amp;&amp;</span> LIKELY(obj <span style="color:#f92672">!=</span> nullptr)) {
        <span style="color:#75715e">//如果使用rosalloc，则调用RosAllocSpace的AllocThreadLocal在self所属线程
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//对应的内存空间中分配资源。上文已经对rosalloc做了详尽介绍，感兴趣的读者可自行研究这部分代码
</span><span style="color:#75715e"></span>        obj<span style="color:#f92672">-&gt;</span>SetClass(klass);
        .....<span style="color:#75715e">//
</span><span style="color:#75715e"></span>        usable_size <span style="color:#f92672">=</span> bytes_allocated;
        pre_fence_visitor(obj, usable_size);
        QuasiAtomic<span style="color:#f92672">::</span>ThreadFenceForConstructor();
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">/*如果前面的if条件均不满足（并不一定说明内存分配失败，有可能是内存分配器不满足if
</span><span style="color:#75715e">          的条件），则调用TryToAlloce函数进行内存分配。下文将单独介绍它。  */</span>
        size_t bytes_tl_bulk_allocated <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        obj <span style="color:#f92672">=</span> TryToAllocate<span style="color:#f92672">&lt;</span>kInstrumented, false<span style="color:#f92672">&gt;</span>(self, allocator, byte_count,
                    <span style="color:#f92672">&amp;</span>bytes_allocated, <span style="color:#f92672">&amp;</span>usable_size, <span style="color:#f92672">&amp;</span>bytes_tl_bulk_allocated);
        <span style="color:#66d9ef">if</span> (UNLIKELY(obj <span style="color:#f92672">==</span> nullptr)) {
            <span style="color:#75715e">//TryToAllocate如果返回空指针，说明内存资源有点紧张，下面将调用
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//AllocateInternalWithGc再次进行内存分配尝试，但该函数内部会开展垃圾回收。
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//下文将单独介绍AllocateInternalWithGc函数
</span><span style="color:#75715e"></span>            obj <span style="color:#f92672">=</span> AllocateInternalWithGc(self, allocator,.....);
            <span style="color:#66d9ef">if</span> (obj <span style="color:#f92672">==</span> nullptr) {
            <span style="color:#75715e">//如果obj依然为空指针，还需要判断是否有异常发生。根据注释所言，如果上面代码执行
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//过程中切换了内存分配器的类型，则obj为空并且没有待投递的异常。
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>self<span style="color:#f92672">-&gt;</span>IsExceptionPending()) {
                <span style="color:#75715e">/*调用AllocObject。注意，这里并没有传入内存分配器类型。如上面所说，此时
</span><span style="color:#75715e">                  内存分配器类型已经发生了变化（否则不会满足if的条件）。AllocObject将使用
</span><span style="color:#75715e">                  新的内存分配器类型重新调用一次AllocObjectWithAllocator。  */</span>
                <span style="color:#66d9ef">return</span> AllocObject<span style="color:#f92672">&lt;</span>true<span style="color:#f92672">&gt;</span>(self,klass, byte_count,  pre_fence_visitor);
            }
            <span style="color:#75715e">//返回空指针，说明确实没有内存。此时一定会有一个OutOfMemory的异常等待我们
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">return</span> nullptr;
        }
    }
    <span style="color:#75715e">//如果代码执行到此处，说明内存分配成功
</span><span style="color:#75715e"></span>    obj<span style="color:#f92672">-&gt;</span>SetClass(klass);
    ......
    <span style="color:#75715e">//下面这个if代码块也和垃圾回收有关。我们后续章节再讨论它们
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (collector<span style="color:#f92672">::</span>SemiSpace<span style="color:#f92672">::</span>kUseRememberedSet<span style="color:#f92672">&amp;&amp;</span> UNLIKELY(
                    allocator <span style="color:#f92672">==</span> kAllocatorTypeNonMoving)) {
            ....
        WriteBarrierField(obj, mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">::</span>ClassOffset(), klass);
    }
    pre_fence_visitor(obj, usable_size);
    QuasiAtomic<span style="color:#f92672">::</span>ThreadFenceForConstructor();
    <span style="color:#75715e">//Heap的num_bytes_allocated_成员变量保存了当前所分配的内存大小
</span><span style="color:#75715e"></span>    new_num_bytes_allocated <span style="color:#f92672">=</span> static_cast<span style="color:#f92672">&lt;</span>size_t<span style="color:#f92672">&gt;</span>(
        num_bytes_allocated_.FetchAndAddRelaxed(bytes_tl_bulk_allocated)) <span style="color:#f92672">+</span> bytes_tl_bulk_allocated;
    }
    .....
        <span style="color:#75715e">/*下面的AllocatorHasAllocationStack函数将检查分配器的类型，如果分配器类型不为
</span><span style="color:#75715e">          kAllocatorTypeBumpPointer、kAllocatorTypeTLAB、 kAllocatorTypeRegion、kAllocatorTypeRegionTLAB中时将返回true。
</span><span style="color:#75715e">          PushOnAllocationStack的代码将把obj保存到self线程的对应数据结构中。详情见下文13.6.4.3节的介绍。*/</span>
        <span style="color:#66d9ef">if</span> (AllocatorHasAllocationStack(allocator)) {
            PushOnAllocationStack(self, <span style="color:#f92672">&amp;</span>obj);<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>    }
    <span style="color:#75715e">//下面的if语句和GC有关，我们统一留待后续章节再介绍
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (AllocatorMayHaveConcurrentGC(allocator) <span style="color:#f92672">&amp;&amp;</span>IsGcConcurrent()) {
        CheckConcurrentGC(self, new_num_bytes_allocated, <span style="color:#f92672">&amp;</span>obj);
    }
    .......
    <span style="color:#66d9ef">return</span> obj;
}
</code></pre></div><h4 id="heaptrytoallocate">Heap::TryToAllocate</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">bool</span> kInstrumented, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">bool</span> kGrow<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> Heap<span style="color:#f92672">::</span>TryToAllocate(Thread<span style="color:#f92672">*</span> self,
                                    AllocatorType allocator_type,.....) {
    <span style="color:#75715e">/*TryToAllocate有一个模板参数kGrow。它的含义和Heap对内存水位线的控制有关。
</span><span style="color:#75715e">      后续章节我们再来介绍与之有关的内容。注意，上文AllocObjectWithAllocator调用TryToAllocate时，kGrow设置为false   */</span>
    ......
    mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> ret;
    <span style="color:#75715e">//根据内存分配器的类型选择不同的内存分配器
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">switch</span> (allocator_type) {
        <span style="color:#66d9ef">case</span> kAllocatorTypeBumpPointer: {<span style="color:#75715e">//使用BumpPointerSpace
</span><span style="color:#75715e"></span>            alloc_size <span style="color:#f92672">=</span> RoundUp(alloc_size, space<span style="color:#f92672">::</span>BumpPointerSpace<span style="color:#f92672">::</span>kAlignment);
            ret <span style="color:#f92672">=</span> bump_pointer_space_<span style="color:#f92672">-&gt;</span>AllocNonvirtual(alloc_size);
            .....
            <span style="color:#66d9ef">break</span>;
        }
        <span style="color:#66d9ef">case</span> kAllocatorTypeRosAlloc: {<span style="color:#75715e">//使用RosAllocSpace
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (kInstrumented <span style="color:#f92672">&amp;&amp;</span> UNLIKELY(is_running_on_memory_tool_)) {
            ......
        } <span style="color:#66d9ef">else</span> {
            <span style="color:#75715e">/*结合上文对rosalloc分配器的介绍可知，rosalloc分配内存时会先确定一个Run，然后
</span><span style="color:#75715e">              从这个Run中找到空闲的slot作为最终的内存资源。如果这个Run没有空闲资源，则会先创建
</span><span style="color:#75715e">              这个Run（其所包含的slot都需要分配好）。虽然我们此次要分配的内存只有alloc_size
</span><span style="color:#75715e">              大小，但它可能会导致一个Run的内存被分配。所以，下面的MaxBytesBulkAllocated-
</span><span style="color:#75715e">              ForNonvirtual函数返回能匹配alloc_size的slot所属的Run需要多大内存（一个Run
</span><span style="color:#75715e">              包含多个slot。一个slot大于或等于alloc_size）。
</span><span style="color:#75715e">              IsOutOfMemoryOnAllocation为Heap的成员函数，它将判断可能需要分配的内存
</span><span style="color:#75715e">              大小是否超过水位线。如果超过水位线，则内存分配失败。*/</span>
            size_t max_bytes_tl_bulk_allocated <span style="color:#f92672">=</span>
                rosalloc_space_<span style="color:#f92672">-&gt;</span>MaxBytesBulkAllocatedForNonvirtual(alloc_size);
            <span style="color:#66d9ef">if</span> (UNLIKELY(IsOutOfMemoryOnAllocation<span style="color:#f92672">&lt;</span>kGrow<span style="color:#f92672">&gt;</span>(allocator_type,
                                            max_bytes_tl_bulk_allocated))) {
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nullptr</span>;
            }
            <span style="color:#75715e">//调用RosAllocSpace AllocNonVirtual分配内存
</span><span style="color:#75715e"></span>            ret <span style="color:#f92672">=</span> rosalloc_space_<span style="color:#f92672">-&gt;</span>AllocNonvirtual(self, alloc_size,...);
            }
            <span style="color:#66d9ef">break</span>;
        }
        <span style="color:#66d9ef">case</span> kAllocatorTypeDlMalloc: {<span style="color:#75715e">//dlmalloc的处理
</span><span style="color:#75715e"></span>            ......
            <span style="color:#66d9ef">break</span>;
        }
        <span style="color:#66d9ef">case</span> kAllocatorTypeNonMoving: {
            <span style="color:#75715e">/*non_moving_space_的类型为MallocSpace*。这说明kAllocatorTypeNonMoving
</span><span style="color:#75715e">              并不是一种独立的内存分配算法，它只是MallocSpace的一种使用场景。从内存分配角度来
</span><span style="color:#75715e">              说，下面的Alloc要么由RosAllocSpace实现，要么由DlMallocSpace实现。
</span><span style="color:#75715e">              kAllocatorTypeNonMoving的真正作用和下一章要介绍的GC有关，我们后续碰到时再介绍 它们。 */</span>
            ret <span style="color:#f92672">=</span> non_moving_space_<span style="color:#f92672">-&gt;</span>Alloc(self, alloc_size, bytes_allocated,
                                usable_size, bytes_tl_bulk_allocated);
            <span style="color:#66d9ef">break</span>;
        }
        <span style="color:#66d9ef">case</span> kAllocatorTypeLOS:....<span style="color:#75715e">//其他内存分配器类型的处理，笔者不拟赘述
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">case</span> kAllocatorTypeTLAB:....
        <span style="color:#66d9ef">case</span> kAllocatorTypeRegion:....
        <span style="color:#66d9ef">case</span> kAllocatorTypeRegionTLAB:...
        ......
    }
    <span style="color:#66d9ef">return</span> ret;
}
</code></pre></div><h4 id="heapallocateinternalwithgc">Heap::AllocateInternalWithGc</h4>
<h5 id="原理图">原理图</h5>
<pre><code class="language-mermaid" data-lang="mermaid">graph LR
WaitForGcToComplete--&gt;TryToAllocate1--&gt;|failed|CollectGarbageInternal--&gt;TryToAllocate2(&quot;TryToAllocate2&quot;)
--&gt;|failed|CollectGarbageInternal2(&quot;GcTypeIteratorCollectGarbageInternal&quot;)--&gt;TryToAllocateN(&quot;TryToAllocateN&quot;)
--&gt;|failed|ThrowOutOfMemoryError
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> Heap<span style="color:#f92672">::</span>AllocateInternalWithGc(Thread<span style="color:#f92672">*</span> self,
    AllocatorType allocator, <span style="color:#66d9ef">bool</span> instrumented,....,mirror<span style="color:#f92672">::</span>Class<span style="color:#f92672">**</span> klass) {
    ....
    <span style="color:#75715e">/*WaitForGcToComplete：等待GC完成（如果当前正有GC任务的话）。返回值的类型GcType
</span><span style="color:#75715e">      我们在7.6.2节中曾介绍过它。此处回顾如下：
</span><span style="color:#75715e">      GcType为枚举变量，它有四种取值，对应垃圾回收力度由轻到重：
</span><span style="color:#75715e">      (1) kGcTypeNone：没有做GC。
</span><span style="color:#75715e">      (2) kGcTypeSticky：表示仅扫描和回收上次GC到本次GC这个时间段内所创建的对象
</span><span style="color:#75715e">      (3) kGcTypePartial：仅扫描和回收应用进程自己的堆，不处理zygote的堆。这种方式和
</span><span style="color:#75715e">          Android中Java应用程序的创建方式有关。在Android中，应用进程是zygote进程fork
</span><span style="color:#75715e">          出来的。
</span><span style="color:#75715e">      (4) kGcTypeFull：它将扫描APP自己以及它从父进程zygote继承得到的堆。
</span><span style="color:#75715e">          垃圾回收时会由轻到重开展回收，以本例所设置的垃圾回收器类型kCollectorTypeCMS而言，
</span><span style="color:#75715e">          它会由轻到重，分别尝试kGcTypeSticky、kGcTypePartial、kGcTypeFull。
</span><span style="color:#75715e">          请读者注意，笔者在第14章中将介绍这几种回收策略的代码实现逻辑。*/</span>
    collector<span style="color:#f92672">::</span>GcType last_gc <span style="color:#f92672">=</span> WaitForGcToComplete(kGcCauseForAlloc, self);
    .....
    <span style="color:#75715e">//last_gc不为kGcTypeNone，表示系统完成了一次GC，再次尝试分配内存。注意，这次GC
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//并不是由AllocateInternalWithGc发起的
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (last_gc <span style="color:#f92672">!=</span> collector<span style="color:#f92672">::</span>kGcTypeNone) {
        mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> ptr <span style="color:#f92672">=</span> TryToAllocate<span style="color:#f92672">&lt;</span>true, false<span style="color:#f92672">&gt;</span>(self,....);
        <span style="color:#66d9ef">if</span> (ptr <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) { <span style="color:#66d9ef">return</span> ptr; }
    }
    <span style="color:#75715e">/*next_gc_type_表示我们要发起的GC粒度。它的取值和垃圾回收器类型有关。next_gc_type_
</span><span style="color:#75715e">      的类型也是GcType。我们上文介绍过它的取值情况。   */</span>
    collector<span style="color:#f92672">::</span>GcType tried_type <span style="color:#f92672">=</span> next_gc_type_;
    <span style="color:#75715e">//CollectGarbageInternal将发起GC，注意它的最后一个参数表示是否回收
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//Soft Reference对象（详情见GC相关的知识）
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">bool</span> gc_ran <span style="color:#f92672">=</span>
        CollectGarbageInternal(tried_type, kGcCauseForAlloc, false)  <span style="color:#f92672">!=</span> collector<span style="color:#f92672">::</span>kGcTypeNone;
    ......
    <span style="color:#66d9ef">if</span> (gc_ran) {<span style="color:#75715e">//gc_ran为true，表示执行了一次GC。现在，再次尝试分配内存
</span><span style="color:#75715e"></span>        mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> ptr <span style="color:#f92672">=</span> TryToAllocate<span style="color:#f92672">&lt;</span>true, false<span style="color:#f92672">&gt;</span>(self, ......);
        <span style="color:#66d9ef">if</span> (ptr <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) { <span style="color:#66d9ef">return</span> ptr; }
    }
    <span style="color:#75715e">//还是没有内存，此时，我们需要根据gc_plan_（数组），以上面代码中注释提到的CMS而言，
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//该数组的内容分别是kGcTypeSticky、kGcTypePartial、kGcTypeFull。下面的for循环将
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//由轻到重开展垃圾回收
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (collector<span style="color:#f92672">::</span>GcType gc_type : gc_plan_) {
        <span style="color:#66d9ef">if</span> (gc_type <span style="color:#f92672">==</span> tried_type) { <span style="color:#66d9ef">continue</span>; }
        <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">bool</span> plan_gc_ran <span style="color:#f92672">=</span> CollectGarbageInternal(gc_type, kGcCauseForAlloc, false) <span style="color:#f92672">!=</span> collector<span style="color:#f92672">::</span>kGcTypeNone;
        ......
        <span style="color:#66d9ef">if</span> (plan_gc_ran) {<span style="color:#75715e">//每执行一次回收就尝试分配一次内存
</span><span style="color:#75715e"></span>            mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> ptr <span style="color:#f92672">=</span> TryToAllocate<span style="color:#f92672">&lt;</span>true, false<span style="color:#f92672">&gt;</span>(self,.....);
            <span style="color:#66d9ef">if</span> (ptr <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) { <span style="color:#66d9ef">return</span> ptr; }
        }
    }
    <span style="color:#75715e">//再次尝试分配内存，但需要设置TryToAllocate的kGrow模板参数为true。读者可以看看
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//TryToAllocate函数的代码，对rosalloc而言，kGrow为true并没有多大用处
</span><span style="color:#75715e"></span>    mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> ptr <span style="color:#f92672">=</span> TryToAllocate<span style="color:#f92672">&lt;</span>true, true<span style="color:#f92672">&gt;</span>(self, allocator,....);
    <span style="color:#66d9ef">if</span> (ptr <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) { <span style="color:#66d9ef">return</span> ptr; }

    <span style="color:#75715e">//还是没有空余内存的话，则以最强力度（gc_plan_数组的末尾元素代表最强力度的GcType），
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//并且不放过soft reference对象（第三个参数为true）再做一次GC
</span><span style="color:#75715e"></span>    CollectGarbageInternal(gc_plan_.back(), kGcCauseForAlloc, true);
    .....
    ptr <span style="color:#f92672">=</span> TryToAllocate<span style="color:#f92672">&lt;</span>true, true<span style="color:#f92672">&gt;</span>(self, allocator,.....);
    <span style="color:#66d9ef">if</span> (ptr <span style="color:#f92672">==</span> <span style="color:#66d9ef">nullptr</span>) {
        <span style="color:#75715e">//根据内存分配器的类型尝试做内存压缩（Compact）等操作。操作成功的话还会尝试
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//内存分配。这部分内容也和GC有关，我们后续章节再介绍
</span><span style="color:#75715e"></span>        ....
    }
    <span style="color:#66d9ef">if</span> (ptr <span style="color:#f92672">==</span> <span style="color:#66d9ef">nullptr</span>) {<span style="color:#75715e">//设置OOM异常
</span><span style="color:#75715e"></span>        ThrowOutOfMemoryError(self, alloc_size, allocator);
    }
    <span style="color:#66d9ef">return</span> ptr;
}
</code></pre></div><h4 id="heappushonallocationstack">Heap::PushOnAllocationStack</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">void</span> Heap<span style="color:#f92672">::</span>PushOnAllocationStack(Thread<span style="color:#f92672">*</span> self, mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">**</span> obj) {
    <span style="color:#75715e">//编译常量kUseThreadLocalAllocationStack表示是否使用线程的Allocation Stack，
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//默认取值为true。
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (kUseThreadLocalAllocationStack) {
        <span style="color:#75715e">/*调用Thread PushOnThreadLocalAllocationStack函数保存这个obj对象。该obj
</span><span style="color:#75715e">          保存在线程的Allocation Stack中。注意，该函数如果返回false，说明Allocation
</span><span style="color:#75715e">          Stack内存不足。此时需要调用Heap
</span><span style="color:#75715e">      PushOnThreadLocalAllocationStackWithInternalGC函数为线程分配Allocation Stack的空间。  */</span>
    <span style="color:#66d9ef">if</span> (UNLIKELY(<span style="color:#f92672">!</span>self<span style="color:#f92672">-&gt;</span>PushOnThreadLocalAllocationStack(<span style="color:#f92672">*</span>obj))) {
            PushOnThreadLocalAllocationStackWithInternalGC(self, obj);
        }
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> ......
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">bool</span> Thread<span style="color:#f92672">::</span>PushOnThreadLocalAllocationStack(mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj) {
    <span style="color:#66d9ef">if</span> (tlsPtr_.thread_local_alloc_stack_top<span style="color:#f92672">&lt;</span> tlsPtr_.thread_local_alloc_stack_end) {
        <span style="color:#75715e">//obj存储到stack_top所指向的位置，此后递增stack_top的值
</span><span style="color:#75715e"></span>        tlsPtr_.thread_local_alloc_stack_top<span style="color:#f92672">-&gt;</span>Assign(obj);
        <span style="color:#f92672">++</span>tlsPtr_.thread_local_alloc_stack_top;
        <span style="color:#66d9ef">return</span> true;
    }
    <span style="color:#66d9ef">return</span> false; <span style="color:#75715e">//返回false，说明Allocation Stack空间不够
</span><span style="color:#75715e"></span>}

<span style="color:#66d9ef">void</span> Heap<span style="color:#f92672">::</span>PushOnThreadLocalAllocationStackWithInternalGC(Thread<span style="color:#f92672">*</span> self,
                mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">**</span> obj) {
    StackReference<span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">&gt;*</span> start_address;
    StackReference<span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">&gt;*</span> end_address;
    <span style="color:#75715e">/*kThreadLocalAllocationStackSize取值为128，即每个线程有能存128个Object对象
</span><span style="color:#75715e">      指针的空间。AtomicBumpBack的功能见上文对AtomicStack的讲解。  */</span>
    <span style="color:#66d9ef">while</span> (<span style="color:#f92672">!</span>allocation_stack_<span style="color:#f92672">-&gt;</span>AtomicBumpBack(kThreadLocalAllocationStackSize, <span style="color:#f92672">&amp;</span>start_address, <span style="color:#f92672">&amp;</span>end_address)) {
        .......
        CollectGarbageInternal(collector<span style="color:#f92672">::</span>kGcTypeSticky, kGcCauseForAlloc,false);
    }
    <span style="color:#75715e">//设置self线程的Allocation Stack
</span><span style="color:#75715e"></span>    self<span style="color:#f92672">-&gt;</span>SetThreadLocalAllocationStack(start_address, end_address);
}
</code></pre></div><p>thread.h</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h"><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">PACKED</span>(<span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">void</span><span style="color:#f92672">*</span>)) tls_ptr_sized_values {
    ......
    <span style="color:#75715e">/*下面这两个成员变量的初始值为nullptr，它们标示了一段内存的起始和结束位置。代码中称
</span><span style="color:#75715e">      这段内存为Allocation Stack。Allocation Stack就是一个栈容器，它存储的是一组
</span><span style="color:#75715e">      StackReference&lt;Object&gt;元素。读者可以将一个StackReference&lt;Object&gt;实例看成一
</span><span style="color:#75715e">      个指向Object的指针。 */</span>
    StackReference<span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">&gt;*</span> thread_local_alloc_stack_top;
    StackReference<span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">&gt;*</span> thread_local_alloc_stack_end;
    ......
</code></pre></div><h2 id="机器码执行">机器码执行</h2>
<p>code_generator_x86.cc</p>
<p><img src="/img/android/art/alloc_gc/alloc.assets/image-20210213171954962.png" alt="image-20210213171954962"></p>
<h3 id="instructioncodegeneratorx86visitnewinstance">InstructionCodeGeneratorX86::VisitNewInstance</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> InstructionCodeGeneratorX86<span style="color:#f92672">::</span>VisitNewInstance(HNewInstance<span style="color:#f92672">*</span> instruction) {
    <span style="color:#66d9ef">if</span> (instruction<span style="color:#f92672">-&gt;</span>IsStringAlloc()) {<span style="color:#75715e">//如果是创建String类型的对象
</span><span style="color:#75715e"></span>        Register temp <span style="color:#f92672">=</span> instruction<span style="color:#f92672">-&gt;</span>GetLocations()<span style="color:#f92672">-&gt;</span>GetTemp(<span style="color:#ae81ff">0</span>).AsRegister<span style="color:#f92672">&lt;</span>Register<span style="color:#f92672">&gt;</span>();
        MemberOffset code_offset <span style="color:#f92672">=</span> ArtMethod<span style="color:#f92672">::</span>EntryPointFromQuickCompiledCodeOffset(kX86WordSize);
        <span style="color:#75715e">/*根据thread.cc InitStringEntryPoints函数的设置可知，QuickEntryPoints
</span><span style="color:#75715e">          pNewEmptyString指向java lang StringFactory newEmptyString函数的机器码
</span><span style="color:#75715e">          入口地址。也就是说，如果创建String类型的对象，则会调用StringFactory类的
</span><span style="color:#75715e">          newEmptyString函数。 */</span>
        __ <span style="color:#a6e22e">fs</span>()<span style="color:#f92672">-&gt;</span>movl(temp,  Address<span style="color:#f92672">::</span>Absolute(QUICK_ENTRY_POINT(pNewEmptyString)));
        __ <span style="color:#a6e22e">call</span>(Address(temp, code_offset.Int32Value()));
        ......
        } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">/*参考instruction_builder.ccBuildNewInstance函数可知，下面的GetEntryPoint返回
</span><span style="color:#75715e">          kQuickAllocObject或kQuickAllocObjectInitialized，它们分别对应QuickEntryPoints
</span><span style="color:#75715e">          结构体里的pQuickAllocObject和pQuickAllocObjectInitialized成员变量。*/</span>
        codegen_<span style="color:#f92672">-&gt;</span>InvokeRuntime(instruction<span style="color:#f92672">-&gt;</span>GetEntrypoint(),....);
        ......
    }
}
</code></pre></div><h3 id="stringalloc-1">String::Alloc</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">//StringFactory.java
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">newEmptyString</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">//newStringFromChars最终将调用下面代码所示的native函数
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> newStringFromChars<span style="color:#f92672">(</span>EmptyArray<span style="color:#f92672">.</span><span style="color:#a6e22e">CHAR</span><span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> 0<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
<span style="color:#75715e">//最终会调用下面这个native函数
</span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">native</span> String <span style="color:#a6e22e">newStringFromChars</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> offset<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> charCount<span style="color:#f92672">,</span>
            <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> data<span style="color:#f92672">);</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#75715e">//java_lang_StringFactory.cc
</span><span style="color:#75715e"></span><span style="color:#66d9ef">static</span> jstring <span style="color:#a6e22e">StringFactory_newStringFromChars</span>(JNIEnv<span style="color:#f92672">*</span> env, jclass,
               jint offset,jint char_count, jcharArray java_data) {
    .....
    gc<span style="color:#f92672">::</span>AllocatorType allocator_type <span style="color:#f92672">=</span>
                Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>GetHeap()<span style="color:#f92672">-&gt;</span>GetCurrentAllocator();
    <span style="color:#75715e">//内部调用String Alloc函数。其内容我们在解释执行模式一节中已经介绍过了
</span><span style="color:#75715e"></span>    mirror<span style="color:#f92672">::</span>String<span style="color:#f92672">*</span> result <span style="color:#f92672">=</span> mirror<span style="color:#f92672">::</span>String<span style="color:#f92672">::</span>AllocFromCharArray<span style="color:#f92672">&lt;</span>true<span style="color:#f92672">&gt;</span>(
                        soa.Self(), char_count,char_array, offset,
                        allocator_type);
  <span style="color:#66d9ef">return</span> soa.AddLocalReference<span style="color:#f92672">&lt;</span>jstring<span style="color:#f92672">&gt;</span>(result);
}
</code></pre></div><h3 id="instructioncodegeneratorx86visitnewarray">InstructionCodeGeneratorX86::VisitNewArray</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> InstructionCodeGeneratorX86<span style="color:#f92672">::</span>VisitNewArray(HNewArray<span style="color:#f92672">*</span> instruction) {
    InvokeRuntimeCallingConvention calling_convention;
    __ <span style="color:#a6e22e">movl</span>(calling_convention.GetRegisterAt(<span style="color:#ae81ff">0</span>),
            Immediate(instruction<span style="color:#f92672">-&gt;</span>GetTypeIndex()));
    <span style="color:#75715e">/*参考instruction_builder.ccProcessDexInstruction函数对NEW_ARRAY的处理，
</span><span style="color:#75715e">      GetEntryPoint返回值为kQuickAllocArrayWithAccessCheck或kQuickAllocArray，
</span><span style="color:#75715e">      它们分别对应QuickEntryPoints结构体里的pQuickAllocArrayWithAccessCheck和
</span><span style="color:#75715e">      pQuickAllocArray成员变量。   */</span>
    codegen_<span style="color:#f92672">-&gt;</span>InvokeRuntime(instruction<span style="color:#f92672">-&gt;</span>GetEntrypoint(),
                        instruction, instruction<span style="color:#f92672">-&gt;</span>GetDexPc(), <span style="color:#66d9ef">nullptr</span>);
    ......
}
</code></pre></div><h2 id="heap构造函数中所创建的space">Heap构造函数中所创建的Space</h2>
<p><img src="/img/android/art/alloc_gc/alloc.assets/image-20210213192252388.png" alt="image-20210213192252388"></p>
<p>图13-9　Heap构造函数中所创建的Space (heapSize=384MB)</p>
<h3 id="heapheap">Heap::Heap</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">Heap<span style="color:#f92672">::</span>Heap(size_t initial_size, size_t growth_limit,...
        size_t capacity,size_t non_moving_space_capacity,
        <span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> image_file_name,.....
        CollectorType foreground_collector_type,
        CollectorType background_collector_type,
        space<span style="color:#f92672">::</span>LargeObjectSpaceType large_object_space_type,
        size_t large_object_threshold,....){
      ......
        <span style="color:#75715e">/*foreground_collector_type：当应用程序处于前台（即用户能感知的情况）时GC的类型。
</span><span style="color:#75715e">                此处为kCollectorTypeCMS（以后简称CMS）
</span><span style="color:#75715e">        background_collector_type：当应用程序位于后台时GC的类型。此处为
</span><span style="color:#75715e">                kCollectorTypeHomogeneousSpaceCompact（以后简称HSC）。注意，这是
</span><span style="color:#75715e">                一种空间压缩的方法，可减少内存碎片。但需要较长时间暂停程序的运行，所以只能
</span><span style="color:#75715e">                在程序位于后台（用户不可见）的时候来执行。
</span><span style="color:#75715e">
</span><span style="color:#75715e">large_object_threshold：被认定为大对象的标准。来自runtime_options.def的
</span><span style="color:#75715e">                LargeObjectThreshold参数，默认取值为Heap.h
</span><span style="color:#75715e">                kDefaultLargeObjectThreshold（大小为3个内存页，此处为12KB）。*/</span>

    <span style="color:#75715e">//desired_collector_type_取值同foreground_collector_type，本例为kCollectorTypeCMS
</span><span style="color:#75715e"></span>    ChangeCollector(desired_collector_type_);
    <span style="color:#75715e">//初始化live_bitmap_和mark_bitmap_成员变量，类型为HeapBitmap，读者可参考
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//7.6.1.1节
</span><span style="color:#75715e"></span>    live_bitmap_.reset(<span style="color:#66d9ef">new</span> accounting<span style="color:#f92672">::</span>HeapBitmap(<span style="color:#66d9ef">this</span>));
    mark_bitmap_.reset(<span style="color:#66d9ef">new</span> accounting<span style="color:#f92672">::</span>HeapBitmap(<span style="color:#66d9ef">this</span>));
......
</code></pre></div><h3 id="heapaddspace">Heap::AddSpace</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> Heap<span style="color:#f92672">::</span>AddSpace(space<span style="color:#f92672">::</span>Space<span style="color:#f92672">*</span> space) {
    WriterMutexLock <span style="color:#a6e22e">mu</span>(Thread<span style="color:#f92672">::</span>Current(), <span style="color:#f92672">*</span>Locks<span style="color:#f92672">::</span>heap_bitmap_lock_);
    <span style="color:#66d9ef">if</span> (space<span style="color:#f92672">-&gt;</span>IsContinuousSpace()) {
        <span style="color:#75715e">//根据图13-1，除了LargeObjectSpace外，其他的Space都属于ContinuousSpace
</span><span style="color:#75715e"></span>        space<span style="color:#f92672">::</span>ContinuousSpace<span style="color:#f92672">*</span> continuous_space <span style="color:#f92672">=</span> space<span style="color:#f92672">-&gt;</span>AsContinuousSpace();
        <span style="color:#75715e">/*ContinuousSpace GetLiveBitmap和GetMarkBitmap是虚函数。其实现者为
</span><span style="color:#75715e">          ContinuousMemMapAllocSpace。而ContinuousMemMapAllocSpace定义了
</span><span style="color:#75715e">          live_bitmap_和mark_bitmap_两个成员变量。根据13.7.3节可知，只有DlMallocSpace
</span><span style="color:#75715e">          和RosAllocSpace初始化了这两个成员变量。  */</span>
        accounting<span style="color:#f92672">::</span>ContinuousSpaceBitmap<span style="color:#f92672">*</span> live_bitmap <span style="color:#f92672">=</span> continuous_space<span style="color:#f92672">-&gt;</span>GetLiveBitmap();
        accounting<span style="color:#f92672">::</span>ContinuousSpaceBitmap<span style="color:#f92672">*</span> mark_bitmap <span style="color:#f92672">=</span> continuous_space<span style="color:#f92672">-&gt;</span>GetMarkBitmap();
        <span style="color:#66d9ef">if</span> (live_bitmap <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) {
   <span style="color:#75715e">/*下面的live_bitmap_和mark_bitmap_为Heap的成员变量，类型为HeapBitmap。
</span><span style="color:#75715e">              其详细信息可参考7.6.1.1节的内容。简单来说，下面的AddContinuousSpaceBitmap
</span><span style="color:#75715e">              函数将把一个位图对象加到HeapBitmap continuous_space_bitmaps_
</span><span style="color:#75715e">              （ContinuousSpaceBitmap数组）中去。*/</span>
            live_bitmap_<span style="color:#f92672">-&gt;</span>AddContinuousSpaceBitmap(live_bitmap);
            mark_bitmap_<span style="color:#f92672">-&gt;</span>AddContinuousSpaceBitmap(mark_bitmap);
        }
        <span style="color:#75715e">//continuous_spaces_为Heap的成员变量，类型为vector&lt;ContinuousSpace*&gt;，即
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//一个存储ContinuousSpace对象的数组。下面将continuous_space加到这个数组中
</span><span style="color:#75715e"></span>        continuous_spaces_.push_back(continuous_space);
        <span style="color:#75715e">//对continuous_spaces_数组中的元素进行排序，内存空间起始位置小的排在前面。
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//图13-9中Space对象就是按这个顺序排列的（从左到右，内存起始地址由低到高）
</span><span style="color:#75715e"></span>        std<span style="color:#f92672">::</span>sort(continuous_spaces_.begin(), continuous_spaces_.end(),
                    [](<span style="color:#66d9ef">const</span> space<span style="color:#f92672">::</span>ContinuousSpace<span style="color:#f92672">*</span> a,
                       <span style="color:#66d9ef">const</span> space<span style="color:#f92672">::</span>ContinuousSpace<span style="color:#f92672">*</span> b) {
                <span style="color:#66d9ef">return</span> a<span style="color:#f92672">-&gt;</span>Begin() <span style="color:#f92672">&lt;</span> b<span style="color:#f92672">-&gt;</span>Begin();
            });
        } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">//处理DiscontinuousSpace，也就是唯一的LargeObjectMapSpace
</span><span style="color:#75715e"></span>        space<span style="color:#f92672">::</span>DiscontinuousSpace<span style="color:#f92672">*</span> discontinuous_space <span style="color:#f92672">=</span> space<span style="color:#f92672">-&gt;</span>AsDiscontinuousSpace();
        <span style="color:#75715e">//AddLargeObjectBitmap用于将位图对象加入HeapBitmap large_object_bitmaps_数组中
</span><span style="color:#75715e"></span>        live_bitmap_<span style="color:#f92672">-&gt;</span>AddLargeObjectBitmap(discontinuous_space<span style="color:#f92672">-&gt;</span>GetLiveBitmap());
        mark_bitmap_<span style="color:#f92672">-&gt;</span>AddLargeObjectBitmap(discontinuous_space<span style="color:#f92672">-&gt;</span>GetMarkBitmap());
        <span style="color:#75715e">//discontinuous_spaces_为Heap成员变量，类型为vector&lt;DiscontinuousSpace*&gt;
</span><span style="color:#75715e"></span>        discontinuous_spaces_.push_back(discontinuous_space);
    }
    <span style="color:#75715e">//如果Space可分配内存，则还需要将这个AllocSpace对象加到
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//Heap alloc_spaces_数组中保存，其类型为vector&lt;AllocSpace*&gt;
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (space<span style="color:#f92672">-&gt;</span>IsAllocSpace()) {
        alloc_spaces_.push_back(space<span style="color:#f92672">-&gt;</span>AsAllocSpace());
    }
}
</code></pre></div><h3 id="heapremovespace">Heap::RemoveSpace</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> Heap<span style="color:#f92672">::</span>RemoveSpace(space<span style="color:#f92672">::</span>Space<span style="color:#f92672">*</span> space) {
    WriterMutexLock <span style="color:#a6e22e">mu</span>(Thread<span style="color:#f92672">::</span>Current(), <span style="color:#f92672">*</span>Locks<span style="color:#f92672">::</span>heap_bitmap_lock_);
    <span style="color:#66d9ef">if</span> (space<span style="color:#f92672">-&gt;</span>IsContinuousSpace()) {
        space<span style="color:#f92672">::</span>ContinuousSpace<span style="color:#f92672">*</span> continuous_space <span style="color:#f92672">=</span> space<span style="color:#f92672">-&gt;</span>AsContinuousSpace();
        accounting<span style="color:#f92672">::</span>ContinuousSpaceBitmap<span style="color:#f92672">*</span> live_bitmap <span style="color:#f92672">=</span>continuous_space<span style="color:#f92672">-&gt;</span>GetLiveBitmap();
        accounting<span style="color:#f92672">::</span>ContinuousSpaceBitmap<span style="color:#f92672">*</span> mark_bitmap <span style="color:#f92672">=</span> continuous_space<span style="color:#f92672">-&gt;</span>GetMarkBitmap();
        <span style="color:#66d9ef">if</span> (live_bitmap <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) {
            live_bitmap_<span style="color:#f92672">-&gt;</span>RemoveContinuousSpaceBitmap(live_bitmap);
            mark_bitmap_<span style="color:#f92672">-&gt;</span>RemoveContinuousSpaceBitmap(mark_bitmap);
        }
        <span style="color:#66d9ef">auto</span> it <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>find(continuous_spaces_.begin(), continuous_spaces_.end(), continuous_space);
        continuous_spaces_.erase(it);
    } <span style="color:#66d9ef">else</span> {
        ....<span style="color:#75715e">//类似处理，操作discontinuous_spaces_数组
</span><span style="color:#75715e"></span>    }
    <span style="color:#66d9ef">if</span> (space<span style="color:#f92672">-&gt;</span>IsAllocSpace()) {
        <span style="color:#66d9ef">auto</span> it <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>find(alloc_spaces_.begin(), alloc_spaces_.end(),space<span style="color:#f92672">-&gt;</span>AsAllocSpace());
        alloc_spaces_.erase(it);
    }
}
</code></pre></div><h2 id="cardtablespacerememberedsetmoduiontable的关系">CardTable,Space,RememberedSet,ModUionTable的关系</h2>
<p><img src="/img/android/art/alloc_gc/alloc.assets/image-20210213192720762.png" alt="image-20210213192720762"></p>
<p><img src="/img/android/art/alloc_gc/alloc.assets/image-20210213202259073.png" alt="image-20210213202259073"></p>
<p>图13-10　分代GC示意</p>
<p>heap.cc</p>
<h3 id="heapheap-1">Heap::Heap</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#75715e">//构造方法
</span><span style="color:#75715e"></span>......
<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">constexpr</span> size_t kMinHeapAddress <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> KB;
<span style="color:#75715e">//CardTable的覆盖范围从4KB开始，到4GB结束。读者可参考图13-11
</span><span style="color:#75715e"></span>card_table_.reset(accounting<span style="color:#f92672">::</span>CardTable<span style="color:#f92672">::</span>Create(<span style="color:#75715e">//main
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*&gt;</span>(kMinHeapAddress), <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> GB <span style="color:#f92672">-</span> kMinHeapAddress));
......
<span style="color:#66d9ef">if</span> (collector<span style="color:#f92672">::</span>SemiSpace<span style="color:#f92672">::</span>kUseRememberedSet <span style="color:#f92672">&amp;&amp;</span>
                    non_moving_space_ <span style="color:#f92672">!=</span> main_space_) {
    accounting<span style="color:#f92672">::</span>RememberedSet<span style="color:#f92672">*</span> non_moving_space_rem_set <span style="color:#f92672">=</span>
        <span style="color:#66d9ef">new</span> accounting<span style="color:#f92672">::</span>RememberedSet(<span style="color:#e6db74">&#34;Non-moving space remembered set&#34;</span>,
                <span style="color:#66d9ef">this</span>, non_moving_space_);
    <span style="color:#75715e">/*Heap中有一个名为remembered_sets_的成员变量，其数据类型为
</span><span style="color:#75715e">    AllocationTrackingSafeMap&lt;space::Space*,accounting::RememberedSet*,...&gt;。
</span><span style="color:#75715e">    读者可将AllocationTrackingSafeMap看作std map。下面的AddRememberedSet函数
</span><span style="color:#75715e">    将把一个RememberedSet对象和它所关联的space_加入到remembered_sets_容器中。
</span><span style="color:#75715e">    AddRememberedSet非常简单，请读者自行阅读。*/</span>
    AddRememberedSet(non_moving_space_rem_set);
}
</code></pre></div><p>card_table(-inl).h/cc</p>
<h4 id="cardtablecreate">CardTable::Create</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">CardTable<span style="color:#f92672">*</span> CardTable<span style="color:#f92672">::</span>Create(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> heap_begin,
                      size_t heap_capacity) {
    <span style="color:#75715e">/*CardTable类定义了几个编译常量，如下所示：
</span><span style="color:#75715e">    static constexpr size_t kCardShift = 7;
</span><span style="color:#75715e">    static constexpr size_t kCardSize = 1 &lt;&lt;kCardShift;//kCardSize值为128
</span><span style="color:#75715e">    static constexpr uint8_t kCardClean = 0x0;
</span><span style="color:#75715e">    static constexpr uint8_t kCardDirty = 0x70;*/</span>
    <span style="color:#75715e">//计算需要多少个Card
</span><span style="color:#75715e"></span>    size_t capacity <span style="color:#f92672">=</span> heap_capacity <span style="color:#f92672">/</span> kCardSize;
    std<span style="color:#f92672">::</span>string error_msg;
    <span style="color:#75715e">//创建一个MemMap映射对象，其大小为capacity+256。
</span><span style="color:#75715e"></span>    std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>MemMap<span style="color:#f92672">&gt;</span> mem_map(
        MemMap<span style="color:#f92672">::</span>MapAnonymous(<span style="color:#e6db74">&#34;card table&#34;</span>, <span style="color:#66d9ef">nullptr</span>, capacity <span style="color:#f92672">+</span> <span style="color:#ae81ff">256</span>,
                        PROT_READ <span style="color:#f92672">|</span> PROT_WRITE,...));
    <span style="color:#75715e">//下面省略了一段代码，用于计算图13-11中提到的对齐区域，见下文介绍
</span><span style="color:#75715e"></span>    ......
    <span style="color:#75715e">//创建CardTable对象。biased_begin是第一个card的位置，offset是用于计算偏移量的值
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> CardTable(mem_map.release(), biased_begin, offset);
}
</code></pre></div><p>thread.cc</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> Thread<span style="color:#f92672">::</span>InitCardTable() {
    <span style="color:#75715e">//Heap GetCardTable返回Heap card_table_成员变量。这说明所有线程对象共用一个
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//CardTable。CardTable GetBiasedBegin函数返回这个CardTable用于存储记录的内存
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//空间的起始地址。
</span><span style="color:#75715e"></span>    tlsPtr_.card_table <span style="color:#f92672">=</span>
        Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>GetHeap()<span style="color:#f92672">-&gt;</span>GetCardTable()<span style="color:#f92672">-&gt;</span>GetBiasedBegin();
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">CardTable<span style="color:#f92672">::</span>CardTable(MemMap<span style="color:#f92672">*</span> mem_map, <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> biased_begin, size_t offset)
    <span style="color:#f92672">:</span> mem_map_(mem_map), biased_begin_(biased_begin), offset_(offset) {
}
</code></pre></div><p>remembered_set.cc</p>
<h4 id="rememberedset">RememberedSet</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RememberedSet</span> {<span style="color:#75715e">//为方便讲解，代码行位置有所调整
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
        <span style="color:#75715e">//CardSet是类型别名，它是一个std set容器，key的类型为uint8_t*。一个元素代表
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//CardTable中的一个Card，也就是该Card的地址保存在CardSet中
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">typedef</span> std<span style="color:#f92672">::</span>set<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span>, std<span style="color:#f92672">::</span>less<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*&gt;</span>,....<span style="color:#f92672">&gt;</span>CardSet;
    <span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
        <span style="color:#75715e">//RememberedSet只有如下四个成员变量
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string name_;<span style="color:#75715e">//RememberedSet的名称
</span><span style="color:#75715e"></span>        Heap<span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> heap_;
        space<span style="color:#f92672">::</span>ContinuousSpace<span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> space_;<span style="color:#75715e">//关联一个Space，读者可回顾图13-11
</span><span style="color:#75715e"></span>        CardSet dirty_cards_;
    <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
        <span style="color:#75715e">/*RemeberedSet的构造函数。代码中有几处地方会创建RememberedSet对象
</span><span style="color:#75715e">        (1) Heap构造函数中为non_moving_space_对象创建一个RememberedSet对象
</span><span style="color:#75715e">        (2) CreateMallocSpaceFromMemMap函数，为每一个通过该函数创建的MallocSpace对象创建一个RememberedSet对象。
</span><span style="color:#75715e">        注意，non_moving_space_虽然是MallocSpace对象，但它是由DlMallocSpace
</span><span style="color:#75715e">        CreateFromMemMap函数创建而来，所以并不受上面第2条的影响。*/</span>
        <span style="color:#66d9ef">explicit</span> RememberedSet(<span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> name, Heap<span style="color:#f92672">*</span> heap,
                        space<span style="color:#f92672">::</span>ContinuousSpace<span style="color:#f92672">*</span> space)
            <span style="color:#f92672">:</span> name_(name), heap_(heap), space_(space) {}
        ....
        <span style="color:#75715e">//RememberedSet成员函数较少，下面两个是其中最重要的成员函数，详情见下文代码分析
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">void</span> ClearCards();
        <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">UpdateAndMarkReferences</span>(space<span style="color:#f92672">::</span>ContinuousSpace<span style="color:#f92672">*</span> target_space,
                        collector<span style="color:#f92672">::</span>GarbageCollector<span style="color:#f92672">*</span> collector);
        ......
};
</code></pre></div><h5 id="clearcards">ClearCards</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">void</span> RememberedSet<span style="color:#f92672">::</span>ClearCards() {
    CardTable<span style="color:#f92672">*</span> card_table <span style="color:#f92672">=</span> GetHeap()<span style="color:#f92672">-&gt;</span>GetCardTable();
    RememberedSetCardVisitor <span style="color:#a6e22e">card_visitor</span>(<span style="color:#f92672">&amp;</span>dirty_cards_);
        <span style="color:#75715e">/*上文介绍了CardTable ModifyCardsAtomic函数的作用。此处的ClearCards函数将用到
</span><span style="color:#75715e">          它。其功能为扫描space_对应的card，调用AgeCardVisitor函数获取card的新值，然后
</span><span style="color:#75715e">          调用card_visitor函数对象。  */</span>
    card_table<span style="color:#f92672">-&gt;</span>ModifyCardsAtomic(space_<span style="color:#f92672">-&gt;</span>Begin(), space_<span style="color:#f92672">-&gt;</span>End(),
                            AgeCardVisitor(), card_visitor);
}

<span style="color:#75715e">/*ModifyCardsAtomic用于修改从scan_begin到scan_end内存范围对应CardTable
</span><span style="color:#75715e">  card的值。修改前调用模板参数visitor函数对象，visitor需要返回该Card的新值。
</span><span style="color:#75715e">  如果新值和旧值不同，则调用模板参数modified函数对象以通知外界。函数名中的Atomic意
</span><span style="color:#75715e">  为原子操作。该函数的代码不短，但难度不大。*/</span>
<span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> Visitor, <span style="color:#66d9ef">typename</span> ModifiedVisitor<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">void</span> ModifyCardsAtomic(<span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> scan_begin, <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> scan_end,
            <span style="color:#66d9ef">const</span> Visitor<span style="color:#f92672">&amp;</span> visitor,
            <span style="color:#66d9ef">const</span> ModifiedVisitor<span style="color:#f92672">&amp;</span> modified);

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AgeCardVisitor</span> {
    <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
        <span style="color:#66d9ef">uint8_t</span> <span style="color:#66d9ef">operator</span>()(<span style="color:#66d9ef">uint8_t</span> card) <span style="color:#66d9ef">const</span> {
            <span style="color:#75715e">//参数card就是指CardTable中的一个Card。如果它的值为kCardDirty，则返回
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//0x6E（kCardDirty - 1），否则返回0。总之，card的新值不会是kCardDirty
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> (card <span style="color:#f92672">==</span> accounting<span style="color:#f92672">::</span>CardTable<span style="color:#f92672">::</span>kCardDirty) <span style="color:#f92672">?</span> card <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>;
    }
};

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RememberedSetCardVisitor</span> {
    <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
        <span style="color:#66d9ef">explicit</span> RememberedSetCardVisitor(
                 RememberedSet<span style="color:#f92672">::</span>CardSet<span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> dirty_cards)
            <span style="color:#f92672">:</span> dirty_cards_(dirty_cards) {}
    <span style="color:#75715e">//expected_value为card的旧值（调用AgeCardVisitor之前的值），而
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//new_value为AgeCardVisitor返回的新值。此处没有用到new_value
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">operator</span>()(<span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> card, <span style="color:#66d9ef">uint8_t</span> expected_value,
                    <span style="color:#66d9ef">uint8_t</span> new_value ATTRIBUTE_UNUSED) <span style="color:#66d9ef">const</span> {
        <span style="color:#75715e">//如果card的值为kCardDirty，将其加入RememberedSet dirty_cards_ set容器中
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (expected_value <span style="color:#f92672">==</span> CardTable<span style="color:#f92672">::</span>kCardDirty) {
          dirty_cards_<span style="color:#f92672">-&gt;</span>insert(card);
        }
    }
    <span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
    RememberedSet<span style="color:#f92672">::</span>CardSet<span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> dirty_cards_;
};
</code></pre></div><h5 id="updateandmarkreferences">UpdateAndMarkReferences</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#75715e">//遍历space_里所有存在跨Space引用的Object，然后对它们进行标记
</span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> RememberedSet<span style="color:#f92672">::</span>UpdateAndMarkReferences(
                space<span style="color:#f92672">::</span>ContinuousSpace<span style="color:#f92672">*</span> target_space,
                collector<span style="color:#f92672">::</span>GarbageCollector<span style="color:#f92672">*</span> collector) {
    <span style="color:#75715e">/*注意target_space的含义：UpdateAndMarkReferences将检查space_中的Object是否
</span><span style="color:#75715e">      引用了位于target_space空间中的Object。*/</span>
    CardTable<span style="color:#f92672">*</span> card_table <span style="color:#f92672">=</span> heap_<span style="color:#f92672">-&gt;</span>GetCardTable();

    <span style="color:#75715e">//如果space_中的对象引用了target_space中的对象，则下面这个变量会被设置为true，
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//此时它的值为false
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">bool</span> contains_reference_to_target_space <span style="color:#f92672">=</span> false;
    <span style="color:#75715e">//创建RememberedSetObjectVisitor函数对象
</span><span style="color:#75715e"></span>    RememberedSetObjectVisitor <span style="color:#a6e22e">obj_visitor</span>(target_space,<span style="color:#f92672">&amp;</span>contains_reference_to_target_space,  collector);
    <span style="color:#75715e">//要遍历一个ContinuousSpaceBitmap中所包含的Object，需要借助与之关联的位图对象
</span><span style="color:#75715e"></span>    ContinuousSpaceBitmap<span style="color:#f92672">*</span> bitmap <span style="color:#f92672">=</span> space_<span style="color:#f92672">-&gt;</span>GetLiveBitmap();
    CardSet remove_card_set;

    <span style="color:#75715e">//dirty_cards容器已经包含了space_中那些标志为kDirtyCard的card信息。
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//下面的循环将遍历dirty_cards中的card
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> card_addr : dirty_cards_) {
        contains_reference_to_target_space <span style="color:#f92672">=</span> false;
        <span style="color:#75715e">//将card地址转换为Space中对应的那个128字节单元的基地址。读者可回顾图13-11
</span><span style="color:#75715e"></span>        uintptr_t start <span style="color:#f92672">=</span> <span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>uintptr_t<span style="color:#f92672">&gt;</span>( card_table<span style="color:#f92672">-&gt;</span>AddrFromCard(card_addr));
        <span style="color:#75715e">/*访问这个128字节单元中的Object，调用obj_visitor函数对象。7.6.1.1.3节SpaceBitmap的
</span><span style="color:#75715e">          Walk函数。VisitMarkedRange与之类似，它将访问[start，start+128)这部分位图所对应内
</span><span style="color:#75715e">          存空间中的Object们，每得到一个Object，就调用一次obj_visitor函数对象。VisitMarkRange
</span><span style="color:#75715e">          函数中有一段参考性的实现代码，读者不妨一看（笔者在13.2节中曾展示过这段代码）。 */</span>
        bitmap<span style="color:#f92672">-&gt;</span>VisitMarkedRange(start, start <span style="color:#f92672">+</span> CardTable<span style="color:#f92672">::</span>kCardSize, obj_visitor);
        <span style="color:#75715e">//如果这个128字节单元中的Object没有引用target_space中的Object，则对应的
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//card区域需要从dirty_cards容器中移除。先将这个card存到临时容器
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//remove_card_set中，后续将一次性移除它们
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>contains_reference_to_target_space) {
         remove_card_set.insert(card_addr);
        }
    }
    <span style="color:#75715e">//从dirty_cards_中移除那些不存在跨Space引用的card
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> card_addr : remove_card_set) {
        dirty_cards_.erase(card_addr);
    }
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RememberedSetObjectVisitor</span> {
    <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
        ......
        <span style="color:#75715e">//SpaceBitmap VisitMarkedRange每找到一个Object都会调用下面这个函数
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">void</span> <span style="color:#66d9ef">operator</span>()(mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj) <span style="color:#66d9ef">const</span> {
        <span style="color:#75715e">/*调用Object VisitReferences函数，传入另外一个函数对象。Object
</span><span style="color:#75715e">          VisitReferences用于访问一个Object的引用型成员变量。想必读者已经猜到了，GC中
</span><span style="color:#75715e">          常说的标记（Mark）操作肯定会用到这个函数来寻找对象之间的引用关系。13.8.3节将详细
</span><span style="color:#75715e">          介绍此函数。 */</span>
        RememberedSetReferenceVisitor <span style="color:#a6e22e">visitor</span>(target_space_,
                    contains_reference_to_target_space_,collector_);
        obj<span style="color:#f92672">-&gt;</span>VisitReferences(visitor, visitor);
        }
        ......
};
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RememberedSetReferenceVisitor</span> {
    <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
    ......
    <span style="color:#75715e">/*RememberedSetReferenceVisitor有多个调用函数以及回调函数。它们和Object
</span><span style="color:#75715e">      VisitReferences的实现有关。本节仅看下面一个函数，其他几个函数的作用大同小异。 */</span>
      <span style="color:#66d9ef">void</span> <span style="color:#66d9ef">operator</span>()(mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj, MemberOffset offset, <span style="color:#66d9ef">bool</span> is_static
    ATTRIBUTE_UNUSED) <span style="color:#66d9ef">const</span> {
    <span style="color:#75715e">//offset是成员变量位于obj所在内存中的位置。将其转换成对应的Object。即ref_ptr
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//就是这个引用型成员变量所指向的那个Object
</span><span style="color:#75715e"></span>    mirror<span style="color:#f92672">::</span>HeapReference<span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">&gt;*</span> ref_ptr <span style="color:#f92672">=</span> obj<span style="color:#f92672">-&gt;</span>GetFieldObjectReferenceAddr(offset);
    <span style="color:#75715e">//判断target_space_中是否包含ref_ptr。如果包含，则存在跨Space的引用关系
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (target_space_<span style="color:#f92672">-&gt;</span>HasAddress(ref_ptr<span style="color:#f92672">-&gt;</span>AsMirrorPtr())) {
            <span style="color:#f92672">*</span>contains_reference_to_target_space_ <span style="color:#f92672">=</span> true;
            <span style="color:#75715e">//我们后续章节再介绍MarkHeapReference函数
</span><span style="color:#75715e"></span>            collector_<span style="color:#f92672">-&gt;</span>MarkHeapReference(ref_ptr);
        }
    }
    <span style="color:#75715e">//其他几个回调函数，和Object VisitReferences有关
</span><span style="color:#75715e"></span>    ......
};
</code></pre></div><p>Object-inl.h</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">template <span style="color:#f92672">&lt;</span>VerifyObjectFlags kVerifyFlags<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> HeapReference<span style="color:#f92672">&lt;</span>Object<span style="color:#f92672">&gt;*</span> Object<span style="color:#f92672">::</span>GetFieldObjectReferenceAddr(MemberOffset field_offset) {
  <span style="color:#66d9ef">if</span> (kVerifyFlags <span style="color:#f92672">&amp;</span> kVerifyThis) {
    VerifyObject(this);
  }
  <span style="color:#66d9ef">return</span> reinterpret_cast<span style="color:#f92672">&lt;</span>HeapReference<span style="color:#f92672">&lt;</span>Object<span style="color:#f92672">&gt;*&gt;</span>(reinterpret_cast<span style="color:#f92672">&lt;</span>uint8_t<span style="color:#f92672">*&gt;</span>(this) <span style="color:#f92672">+</span>
      field_offset.Int32Value());
}
</code></pre></div><h3 id="markcard">MarkCard</h3>
<p>发生下述依赖时，将a对应的card设置为kCardDirty</p>
<pre><code class="language-mermaid" data-lang="mermaid">graph TB
a(&quot;a.b&quot;)--&gt;|引用|b
</code></pre><p>解释执行模式下，iput-object指令将触发DoFieldPut函数被调用</p>
<p>interpreter_common.cc</p>
<h4 id="dofieldput">DoFieldPut</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">DoFieldPut</span>(Thread<span style="color:#f92672">*</span> self,... <span style="color:#66d9ef">uint16_t</span> inst_data){
    ......
    <span style="color:#75715e">//f是代表目标成员变量的ArtField对象
</span><span style="color:#75715e"></span>    ArtField<span style="color:#f92672">*</span> f <span style="color:#f92672">=</span>
        FindFieldFromCode<span style="color:#f92672">&lt;</span>find_type, do_access_check<span style="color:#f92672">&gt;</span>(field_idx, ....
                            Primitive<span style="color:#f92672">::</span>ComponentSize(field_type));
    ......
    <span style="color:#66d9ef">switch</span> (field_type) {
    <span style="color:#66d9ef">case</span> Primitive<span style="color:#f92672">::</span>kPrimNot: {
        Object<span style="color:#f92672">*</span> reg <span style="color:#f92672">=</span> shadow_frame.GetVRegReference(vregA);
        ......
        f<span style="color:#f92672">-&gt;</span>SetObj<span style="color:#f92672">&lt;</span>transaction_active<span style="color:#f92672">&gt;</span>(obj, reg);
        <span style="color:#66d9ef">break</span>;
    }
    .....
}
  
<span style="color:#75715e">//art_field-inl.h
</span><span style="color:#75715e"></span><span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> kTransactionActive<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">void</span> ArtField<span style="color:#f92672">::</span>SetObj(mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> object,
                mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> new_value) {

    <span style="color:#66d9ef">if</span> (UNLIKELY(IsVolatile())) {.....}
    <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">//调用Object SetFieldObject函数
</span><span style="color:#75715e"></span>        object<span style="color:#f92672">-&gt;</span>SetFieldObject<span style="color:#f92672">&lt;</span>kTransactionActive<span style="color:#f92672">&gt;</span>(GetOffset(), new_value);
    }
}
  
<span style="color:#75715e">//object-inl.h
</span><span style="color:#75715e"></span><span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">void</span> Object<span style="color:#f92672">::</span>SetFieldObject(MemberOffset field_offset,  Object<span style="color:#f92672">*</span> new_value) {
    <span style="color:#75715e">/*设置对应成员变量的值其不使用Write Barrier。其内部就是更新本Object对象
</span><span style="color:#75715e">        field_offset内存处的值为new_value。不熟悉Object对象内存布局的读者请阅读8.7.4.2
</span><span style="color:#75715e">        节的内容。 */</span>
    SetFieldObjectWithoutWriteBarrier<span style="color:#f92672">&lt;</span>...<span style="color:#f92672">&gt;</span>(field_offset, new_value);
    <span style="color:#75715e">//只要新值不为空，都需要调用Heap WriteBarrierField函数
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (new_value <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>) {
        Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>GetHeap()<span style="color:#f92672">-&gt;</span>WriteBarrierField(<span style="color:#66d9ef">this</span>, field_offset, new_value);
        ......
    }
}
  
<span style="color:#75715e">//heap.h
</span><span style="color:#75715e"></span>ALWAYS_INLINE <span style="color:#66d9ef">void</span> WriteBarrierField(<span style="color:#66d9ef">const</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> dst,
            MemberOffset offset ATTRIBUTE_UNUSED,
            <span style="color:#66d9ef">const</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> new_value ATTRIBUTE_UNUSED) {
    <span style="color:#75715e">/*注意，WriteBarrierField只用到第一个参数dst，它就是成员变量被赋值的那个对象，而成员变
</span><span style="color:#75715e">      量的新值（new_value表示）并未使用。在下面的代码中，上文Heap构造函数中已经见过card_table_
</span><span style="color:#75715e">      了。而MarkCard将标记dst对应的Card标志为kCardDirty。其详情见下文的介绍。  */</span>
    card_table_<span style="color:#f92672">-&gt;</span>MarkCard(dst);
}
</code></pre></div><h4 id="markcard-1">MarkCard</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc">ALWAYS_INLINE <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">MarkCard</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>addr) {
    <span style="color:#75715e">/*CardFromAddr返回addr对应的Card，然后设置其值为kCardDirty。从这里也可以看出，
</span><span style="color:#75715e">      ART虚拟机中，一个Card为一个字节（CardFromAddr返回值类型为uint8_t*）。*/</span>
     <span style="color:#f92672">*</span>CardFromAddr(addr) <span style="color:#f92672">=</span> kCardDirty;
}

<span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> CardTable<span style="color:#f92672">::</span>CardFromAddr(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>addr) <span style="color:#66d9ef">const</span> {
    <span style="color:#75715e">//由基地址加上addr右移7位（相当于除以128）以得到对应card的位置。而CardTable的基
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//准位置从biased_begin_算起
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span> <span style="color:#f92672">*</span>card_addr <span style="color:#f92672">=</span> biased_begin_ <span style="color:#f92672">+</span>
                  (<span style="color:#66d9ef">reinterpret_cast</span><span style="color:#f92672">&lt;</span>uintptr_t<span style="color:#f92672">&gt;</span>(addr) <span style="color:#f92672">&gt;&gt;</span>kCardShift);
    <span style="color:#66d9ef">return</span> card_addr;
}

<span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">IsDirty</span>(<span style="color:#66d9ef">const</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj) <span style="color:#66d9ef">const</span> {
    <span style="color:#66d9ef">return</span> GetCard(obj) <span style="color:#f92672">==</span> kCardDirty;
}
<span style="color:#66d9ef">uint8_t</span> <span style="color:#a6e22e">GetCard</span>(<span style="color:#66d9ef">const</span> mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">*</span> obj) <span style="color:#66d9ef">const</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span>CardFromAddr(obj);
}
</code></pre></div><h2 id="object-inlhvisitreferences">Object-inl.h::VisitReferences</h2>
<p><img src="/img/android/art/alloc_gc/alloc.assets/image-20210213203852276.png" alt="image-20210213203852276"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> kVisitNativeRoots <span style="color:#f92672">=</span> true,
          VerifyObjectFlags kVerifyFlags <span style="color:#f92672">=</span> kDefaultVerifyFlags,
          ReadBarrierOption kReadBarrierOption <span style="color:#f92672">=</span> kWithReadBarrier,
          <span style="color:#66d9ef">typename</span> Visitor,
          <span style="color:#66d9ef">typename</span> JavaLangRefVisitor <span style="color:#f92672">=</span> VoidFunctor<span style="color:#f92672">&gt;</span>
    <span style="color:#66d9ef">void</span> VisitReferences(<span style="color:#66d9ef">const</span> Visitor<span style="color:#f92672">&amp;</span> visitor, <span style="color:#66d9ef">const</span> JavaLangRefVisitor<span style="color:#f92672">&amp;</span> ref_visitor) { 
    <span style="color:#75715e">//klass为Object所属的类（即mirrorObject的成员变量klass）
</span><span style="color:#75715e"></span>    mirror<span style="color:#f92672">::</span>Class<span style="color:#f92672">*</span> klass <span style="color:#f92672">=</span> GetClass<span style="color:#f92672">&lt;</span>kVerifyFlags, kReadBarrierOption<span style="color:#f92672">&gt;</span>();
    <span style="color:#75715e">//klass是Object第一个引用型成员变量，调用visitor来访问它
</span><span style="color:#75715e"></span>    visitor(<span style="color:#66d9ef">this</span>, ClassOffset(), false);
    <span style="color:#75715e">//获取类的类型
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">uint32_t</span> class_flags <span style="color:#f92672">=</span> klass<span style="color:#f92672">-&gt;</span>GetClassFlags<span style="color:#f92672">&lt;</span>kVerifyNone<span style="color:#f92672">&gt;</span>();
    <span style="color:#66d9ef">if</span> (LIKELY(class_flags <span style="color:#f92672">==</span> kClassFlagNormal)) {
        <span style="color:#75715e">/*调用VisitInstanceFieldsReferences函数访问其引用型成员变量。这个函数的实现与
</span><span style="color:#75715e">          我们在8.7.4.3节介绍的引用型成员变量在Object内存中的布局密切相关。我们在该节中还
</span><span style="color:#75715e">          展示了下面这个函数内部将要调用的VisitFieldsReferences的代码。另外，VisitInstances-
</span><span style="color:#75715e">          FieldsReferences用于访问对象的非静态引用型成员变量。*/</span>
        VisitInstanceFieldsReferences<span style="color:#f92672">&lt;</span>.....<span style="color:#f92672">&gt;</span>(klass,  visitor);
    } <span style="color:#66d9ef">else</span> {<span style="color:#75715e">//其他类标志位的处理。
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> ((class_flags <span style="color:#f92672">&amp;</span>kClassFlagNoReferenceFields) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
            <span style="color:#66d9ef">if</span> (class_flags <span style="color:#f92672">==</span> kClassFlagClass) {
            <span style="color:#75715e">//如果目标对象本身就是一个Java Class对象，则将其转换为Class对象，然后调用
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//mirror Class VisitReferences函数
</span><span style="color:#75715e"></span>            mirror<span style="color:#f92672">::</span>Class<span style="color:#f92672">*</span> as_klass <span style="color:#f92672">=</span> AsClass<span style="color:#f92672">&lt;</span>...<span style="color:#f92672">&gt;</span>();
            as_klass<span style="color:#f92672">-&gt;</span>VisitReferences<span style="color:#f92672">&lt;</span>....<span style="color:#f92672">&gt;</span>(klass, visitor);
            } <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (class_flags <span style="color:#f92672">==</span> kClassFlagObjectArray) {
                <span style="color:#75715e">//如果是一个Object数组，则转换成mirror ObjectArray，调用它的
</span><span style="color:#75715e"></span>                <span style="color:#75715e">//VisitReferences函数
</span><span style="color:#75715e"></span>                AsObjectArray<span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object,.....<span style="color:#f92672">&gt;</span>()<span style="color:#f92672">-&gt;</span>VisitReferences(visitor);
            } <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> ((class_flags <span style="color:#f92672">&amp;</span>kClassFlagReference) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
            <span style="color:#75715e">//如果类的类型为Java Reference的一种，则先调用VisitInstanceFieldsReferences
</span><span style="color:#75715e"></span>            VisitInstanceFieldsReferences<span style="color:#f92672">&lt;</span>...<span style="color:#f92672">&gt;</span>(klass, visitor);
            <span style="color:#75715e">//然后调用JavaLangRefVisitor。注意，第二个参数将目标对象转换成一个mirror
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//Reference对象
</span><span style="color:#75715e"></span>                ref_visitor(klass, AsReference<span style="color:#f92672">&lt;</span>kVerifyFlags, kReadBarrierOption<span style="color:#f92672">&gt;</span>());
            } <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (class_flags <span style="color:#f92672">==</span> kClassFlagDexCache) {
                <span style="color:#75715e">//将自己转换为DexCache
</span><span style="color:#75715e"></span>                mirror<span style="color:#f92672">::</span>DexCache<span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> dex_cache <span style="color:#f92672">=</span> AsDexCache<span style="color:#f92672">&lt;</span>....<span style="color:#f92672">&gt;</span>();
                <span style="color:#75715e">//调用DexCache VisitReference函数
</span><span style="color:#75715e"></span>                dex_cache<span style="color:#f92672">-&gt;</span>VisitReferences<span style="color:#f92672">&lt;</span>...<span style="color:#f92672">&gt;</span>(klass, visitor);
            } <span style="color:#66d9ef">else</span> {
                mirror<span style="color:#f92672">::</span>ClassLoader<span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> class_loader <span style="color:#f92672">=</span> AsClassLoader<span style="color:#f92672">&lt;</span>...<span style="color:#f92672">&gt;</span>();
                <span style="color:#75715e">//将自己转换成ClassLoader，然后调用它的VisitReferences
</span><span style="color:#75715e"></span>                class_loader<span style="color:#f92672">-&gt;</span>VisitReferences<span style="color:#f92672">&lt;</span>...<span style="color:#f92672">&gt;</span>(klass, visitor);
            }
        }
    }
}
</code></pre></div><h3 id="visitor和javalangrefvisitor示例">Visitor和JavaLangRefVisitor示例</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cc" data-lang="cc"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">VisitorAndJavaLangRefVisitor</span> {<span style="color:#75715e">//同时支持Visitor和JavaLangRefVisitor
</span><span style="color:#75715e"></span>    <span style="color:#75715e">/*Visitior需要重载如下所示的函数调用操作符。obj代表目标对象，offset代表目标对象中的
</span><span style="color:#75715e">      某个引用型成员变量在内存中的位置（读者可回顾8.7.4.2节的内容以了解Object的内存布
</span><span style="color:#75715e">      局），is_static表示该成员变量是否为static类型
</span><span style="color:#75715e">    void operator()(mirror::Object* obj, MemberOffset offset,bool is_static) const{}
</span><span style="color:#75715e">
</span><span style="color:#75715e">    /*JavaLangRefVisitor需要重载如下所示的函数调用操作符。klass代表目标对象所属的类，ref
</span><span style="color:#75715e">      则是目标对象本身。注意，只有类的数据类型属于Java Reference的其中一种时（说明目标对象
</span><span style="color:#75715e">      为mirror Reference对象），下面这个函数才会被调用。注意，它并不是用来访问成员变量，而是
</span><span style="color:#75715e">      访问目标对象本身（将其从mirror Object转换成mirror Reference后）*/</span>
    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">operator</span>()(mirror<span style="color:#f92672">::</span>Class<span style="color:#f92672">*</span> klass, mirror<span style="color:#f92672">::</span>Reference<span style="color:#f92672">*</span> ref) <span style="color:#66d9ef">const</span>{}

    <span style="color:#75715e">//下面这两个函数是Visitor必须实现的成员函数，其使用场景见下文的介绍
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">VisitRootIfNonNull</span>(mirror<span style="color:#f92672">::</span>CompressedReference<span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">&gt;*</span> root)
        <span style="color:#66d9ef">const</span> {}
    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">VisitRoot</span>(mirror<span style="color:#f92672">::</span>CompressedReference<span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Object<span style="color:#f92672">&gt;*</span> root)
        <span style="color:#66d9ef">const</span> { }
    ......
};
</code></pre></div><p>class-inl.h</p>
<h3 id="classvisitreferences">Class::VisitReferences</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">template <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> kVisitNativeRoots,...,<span style="color:#66d9ef">typename</span> Visitor<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">void</span> Class<span style="color:#f92672">::</span>VisitReferences(mirror<span style="color:#f92672">::</span>Class<span style="color:#f92672">*</span> klass,
            <span style="color:#66d9ef">const</span> Visitor<span style="color:#f92672">&amp;</span> visitor) {
    <span style="color:#75715e">//调用mirror Object的VisitInstanceFieldsReferences函数以访问非静态的引用型成员变量
</span><span style="color:#75715e"></span>    VisitInstanceFieldsReferences<span style="color:#f92672">&lt;</span>...<span style="color:#f92672">&gt;</span>(klass, visitor);
    <span style="color:#66d9ef">if</span> (IsResolved<span style="color:#f92672">&lt;</span>kVerifyFlags<span style="color:#f92672">&gt;</span>()) {
        <span style="color:#75715e">//访问静态引用型成员变量
</span><span style="color:#75715e"></span>        VisitStaticFieldsReferences<span style="color:#f92672">&lt;</span>....<span style="color:#f92672">&gt;</span>(this, visitor);
    }
    <span style="color:#66d9ef">if</span> (kVisitNativeRoots) {
        <span style="color:#75715e">//类的成员函数（对应为ArtMethod）、成员变量（对应为ArtField）均定义在mirror
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//Class中。下面的VisitNativeRoots用于访问它们，来看代码
</span><span style="color:#75715e"></span>        VisitNativeRoots(visitor,
            Runtime<span style="color:#f92672">::</span>Current()<span style="color:#f92672">-&gt;</span>GetClassLinker()<span style="color:#f92672">-&gt;</span>GetImagePointerSize());
    }
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">template<span style="color:#f92672">&lt;</span>class Visitor<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">void</span> Class<span style="color:#f92672">::</span>VisitNativeRoots(Visitor<span style="color:#f92672">&amp;</span> visitor, size_t pointer_size) {
    <span style="color:#75715e">//访问静态成员变量
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (ArtField<span style="color:#f92672">&amp;</span> field : GetSFieldsUnchecked()) {
        field.VisitRoots(visitor);
    }
    <span style="color:#75715e">//访问非静态成员变量
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (ArtField<span style="color:#f92672">&amp;</span> field : GetIFieldsUnchecked()) {
        field.VisitRoots(visitor);
    }
    <span style="color:#75715e">//GetMethods返回一个Class所定义的所有成员方法（不包括其继承得来的方法）。读者可回顾
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//8.7.4.1节的内容
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (ArtMethod<span style="color:#f92672">&amp;</span> method : GetMethods(pointer_size)) {
        method.VisitRoots(visitor, pointer_size);
    }
}
</code></pre></div><p>art_field-inl.h</p>
<h3 id="artfieldvisitroots">ArtField::VisitRoots</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">template<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> RootVisitorType<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">void</span> ArtField<span style="color:#f92672">::</span>VisitRoots(RootVisitorType<span style="color:#f92672">&amp;</span> visitor) {
    <span style="color:#75715e">//调用函数对象的VisitRoot函数。declaring_class_是该成员变量所属的类
</span><span style="color:#75715e"></span>    visitor.VisitRoot(declaring_class_.AddressWithoutBarrier());
}
</code></pre></div><p>object_array-inl.h</p>
<h3 id="objectarrayvisitreferences">ObjectArray::VisitReferences</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">template<span style="color:#f92672">&lt;</span>class T<span style="color:#f92672">&gt;</span> template<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> Visitor<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">void</span> ObjectArray<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;::</span>VisitReferences(<span style="color:#66d9ef">const</span> Visitor<span style="color:#f92672">&amp;</span> visitor) {
 <span style="color:#66d9ef">const</span> size_t length <span style="color:#f92672">=</span> static_cast<span style="color:#f92672">&lt;</span>size_t<span style="color:#f92672">&gt;</span>(GetLength());
    <span style="color:#66d9ef">for</span> (size_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> length; <span style="color:#f92672">++</span>i) {
        visitor(this, OffsetOfElement(i), false);
    }
}
</code></pre></div><p>dex_cache-inl.h</p>
<h3 id="dexcachevisitreferences">DexCache::VisitReferences</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">template <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> kVisitNativeRoots,..., <span style="color:#66d9ef">typename</span> Visitor<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">void</span> DexCache<span style="color:#f92672">::</span>VisitReferences(mirror<span style="color:#f92672">::</span>Class<span style="color:#f92672">*</span> klass,
           <span style="color:#66d9ef">const</span> Visitor<span style="color:#f92672">&amp;</span> visitor) {
    VisitInstanceFieldsReferences<span style="color:#f92672">&lt;</span>...<span style="color:#f92672">&gt;</span>(klass, visitor);
    <span style="color:#66d9ef">if</span> (kVisitNativeRoots) {
        <span style="color:#75715e">//访问DexCache里的字符串信息。读者可回顾8.7.1.2节的内容
</span><span style="color:#75715e"></span>        <span style="color:#75715e">//GetString返回DexCache strings_成员变量
</span><span style="color:#75715e"></span>        GcRoot<span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>String<span style="color:#f92672">&gt;*</span> strings <span style="color:#f92672">=</span> GetStrings();
        <span style="color:#66d9ef">for</span> (size_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, num_strings <span style="color:#f92672">=</span> NumStrings(); i <span style="color:#f92672">!=</span> num_strings; <span style="color:#f92672">++</span>i) {
        <span style="color:#75715e">//调用Visitor VisitRootIfNonNull函数
</span><span style="color:#75715e"></span>        visitor.VisitRootIfNonNull(strings[i].AddressWithoutBarrier());
        }
        <span style="color:#75715e">//访问DexCache里的类型信息（DexCache resolved_types_成员变量）
</span><span style="color:#75715e"></span>        GcRoot<span style="color:#f92672">&lt;</span>mirror<span style="color:#f92672">::</span>Class<span style="color:#f92672">&gt;*</span> resolved_types <span style="color:#f92672">=</span> GetResolvedTypes();
        <span style="color:#66d9ef">for</span> (size_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, num_types <span style="color:#f92672">=</span> NumResolvedTypes(); i <span style="color:#f92672">!=</span> num_types; <span style="color:#f92672">++</span>i) {
        visitor.VisitRootIfNonNull(resolved_types[i].AddressWithoutBarrier());
        }
    }<span style="color:#75715e">//if判断结束
</span><span style="color:#75715e"></span>}
</code></pre></div><p>class_loader-inl.h</p>
<h3 id="classloadervisitreferences">ClassLoader::VisitReferences</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-h" data-lang="h">template <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">bool</span> kVisitClasses,... <span style="color:#66d9ef">typename</span> Visitor<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">void</span> ClassLoader<span style="color:#f92672">::</span>VisitReferences(mirror<span style="color:#f92672">::</span>Class<span style="color:#f92672">*</span> klass,
                <span style="color:#66d9ef">const</span> Visitor<span style="color:#f92672">&amp;</span> visitor) {
    VisitInstanceFieldsReferences<span style="color:#f92672">&lt;</span>...<span style="color:#f92672">&gt;</span>(klass, visitor);
    <span style="color:#66d9ef">if</span> (kVisitClasses) {
        ClassTable<span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> class_table <span style="color:#f92672">=</span> GetClassTable();
        <span style="color:#66d9ef">if</span> (class_table <span style="color:#f92672">!=</span> nullptr) {
            <span style="color:#75715e">//调用ClassTable的VisitRoots函数，内部将调用visitor的VisitRoots函数
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//请读者自行阅读ClassTable VisitRoots函数的实现，非常简单
</span><span style="color:#75715e"></span>            class_table<span style="color:#f92672">-&gt;</span>VisitRoots(visitor);
        }
    }
}
</code></pre></div>

<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/en/android/art/alloc_gc/1space/" title="1Space"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/en/android/art/alloc_gc/allocrelated/" title="AllocRelated" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1623151669"></script>
    <script src="/js/perfect-scrollbar.min.js?1623151669"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1623151669"></script>
    <script src="/js/jquery.sticky.js?1623151669"></script>
    <script src="/js/featherlight.min.js?1623151669"></script>
    <script src="/js/highlight.pack.js?1623151669"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1623151669"></script>
    <script src="/js/learn.js?1623151669"></script>
    <script src="/js/hugo-learn.js?1623151669"></script>
    
        
            <script src="/mermaid/mermaid.js?1623151669"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

