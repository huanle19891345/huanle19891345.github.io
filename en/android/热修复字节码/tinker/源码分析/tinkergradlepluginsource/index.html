<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.80.0" />
    <meta name="description" content="Documentation for Hugo Learn Theme">
<meta name="author" content="Mathieu Cornic">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>TinkerGradlePluginSource :: 郑欢的学习总结</title>

    
    <link href="/css/nucleus.css?1623725418" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1623725418" rel="stylesheet">
    <link href="/css/hybrid.css?1623725418" rel="stylesheet">
    <link href="/css/featherlight.min.css?1623725418" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1623725418" rel="stylesheet">
    <link href="/css/auto-complete.css?1623725418" rel="stylesheet">
    <link href="/css/atom-one-dark.css?1623725418" rel="stylesheet">
    <link href="/css/theme.css?1623725418" rel="stylesheet">
    <link href="/css/hugo-theme.css?1623725418" rel="stylesheet">
    
    <link href="/css/theme-mine.css?1623725418" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1623725418"></script>

    <script src="/js/auto_toc_scroll.js?1623725418"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    

  </head>
  <body class="" data-url="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkergradlepluginsource/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='/en'>
    <img src="/avatar.png" width="60px" />
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1623725418"></script>
<script type="text/javascript" src="/js/auto-complete.js?1623725418"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/huanle19891345.github.io\/\/en";
    
</script>
<script type="text/javascript" src="/js/search.js?1623725418"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/en/android/" title="android" class="dd-item
        parent
        
        
        ">
      <a href="/en/android/">
          android
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/aop/" title="aop" class="dd-item
        
        
        
        ">
      <a href="/en/android/aop/">
          aop
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/aop/asm%E8%AE%BF%E5%AE%A2%E8%80%85%E6%A8%A1%E5%BC%8F/" title="ASM访客者模式" class="dd-item ">
        <a href="/en/android/aop/asm%E8%AE%BF%E5%AE%A2%E8%80%85%E6%A8%A1%E5%BC%8F/">
        ASM访客者模式
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/aop/jdk%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" title="JDK动态代理" class="dd-item ">
        <a href="/en/android/aop/jdk%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">
        JDK动态代理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/aop/%E7%BC%96%E8%AF%91%E6%8F%92%E6%A1%A9%E5%92%8C%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" title="编译插桩和动态代理" class="dd-item ">
        <a href="/en/android/aop/%E7%BC%96%E8%AF%91%E6%8F%92%E6%A1%A9%E5%92%8C%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">
        编译插桩和动态代理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/" title="art" class="dd-item
        
        
        
        ">
      <a href="/en/android/art/">
          art
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/1%E7%B1%BB%E7%BC%96%E8%AF%91/" title="1类编译" class="dd-item
        
        
        
        ">
      <a href="/en/android/art/1%E7%B1%BB%E7%BC%96%E8%AF%91/">
          1类编译
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/1%E7%B1%BB%E7%BC%96%E8%AF%91/dex2oat/" title="dex2oat" class="dd-item ">
        <a href="/en/android/art/1%E7%B1%BB%E7%BC%96%E8%AF%91/dex2oat/">
        dex2oat
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/1%E7%B1%BB%E7%BC%96%E8%AF%91/dex2oat%E4%BB%8B%E7%BB%8D/" title="dex2oat介绍" class="dd-item ">
        <a href="/en/android/art/1%E7%B1%BB%E7%BC%96%E8%AF%91/dex2oat%E4%BB%8B%E7%BB%8D/">
        dex2oat介绍
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/" title="2类加载" class="dd-item
        
        
        
        ">
      <a href="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/">
          2类加载
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/android_n%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91%E4%B8%8E%E5%AF%B9%E7%83%AD%E8%A1%A5%E4%B8%81%E5%BD%B1%E5%93%8D%E8%A7%A3%E6%9E%90/" title="Android_N混合编译与对热补丁影响解析" class="dd-item ">
        <a href="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/android_n%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91%E4%B8%8E%E5%AF%B9%E7%83%AD%E8%A1%A5%E4%B8%81%E5%BD%B1%E5%93%8D%E8%A7%A3%E6%9E%90/">
        Android_N混合编译与对热补丁影响解析
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" title="类加载" class="dd-item ">
        <a href="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/%E7%B1%BB%E5%8A%A0%E8%BD%BD/">
        类加载
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B1%82/" title="类加载虚拟机层" class="dd-item ">
        <a href="/en/android/art/2%E7%B1%BB%E5%8A%A0%E8%BD%BD/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B1%82/">
        类加载虚拟机层
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/alloc_gc/" title="alloc_gc" class="dd-item
        
        
        
        ">
      <a href="/en/android/art/alloc_gc/">
          alloc_gc
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/1space/" title="1Space" class="dd-item ">
        <a href="/en/android/art/alloc_gc/1space/">
        1Space
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/2alloc/" title="2Alloc" class="dd-item ">
        <a href="/en/android/art/alloc_gc/2alloc/">
        2Alloc
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/allocrelated/" title="AllocRelated" class="dd-item ">
        <a href="/en/android/art/alloc_gc/allocrelated/">
        AllocRelated
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/gc/" title="GC" class="dd-item ">
        <a href="/en/android/art/alloc_gc/gc/">
        GC
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/gc1_ms_cms/" title="GC1_MS_CMS" class="dd-item ">
        <a href="/en/android/art/alloc_gc/gc1_ms_cms/">
        GC1_MS_CMS
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/gc2_concurrentcopying/" title="GC2_ConcurrentCopying" class="dd-item ">
        <a href="/en/android/art/alloc_gc/gc2_concurrentcopying/">
        GC2_ConcurrentCopying
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/gc3_markcompact/" title="GC3_MarkCompact" class="dd-item ">
        <a href="/en/android/art/alloc_gc/gc3_markcompact/">
        GC3_MarkCompact
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/gc4_semi_space/" title="GC4_Semi_Space" class="dd-item ">
        <a href="/en/android/art/alloc_gc/gc4_semi_space/">
        GC4_Semi_Space
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/alloc_gc/runtime_visitroots/" title="Runtime_VisitRoots" class="dd-item ">
        <a href="/en/android/art/alloc_gc/runtime_visitroots/">
        Runtime_VisitRoots
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/art_lock/" title="ART_Lock" class="dd-item ">
        <a href="/en/android/art/art_lock/">
        ART_Lock
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/jni/" title="jni" class="dd-item
        
        
        
        ">
      <a href="/en/android/art/jni/">
          jni
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/jni/java_jni%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E5%8E%9F%E7%90%86/" title="java_jni方法调用原理" class="dd-item ">
        <a href="/en/android/art/jni/java_jni%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E5%8E%9F%E7%90%86/">
        java_jni方法调用原理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/jni/jni%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2/" title="Jni数据转换" class="dd-item ">
        <a href="/en/android/art/jni/jni%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2/">
        Jni数据转换
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/jni/systemloadlibrary/" title="SystemLoadLibrary" class="dd-item ">
        <a href="/en/android/art/jni/systemloadlibrary/">
        SystemLoadLibrary
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/jni/%E5%BC%82%E5%B8%B8/" title="异常" class="dd-item ">
        <a href="/en/android/art/jni/%E5%BC%82%E5%B8%B8/">
        异常
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/jni/%E8%A7%A3%E9%87%8A%E6%89%A7%E8%A1%8C7_0/" title="解释执行7_0" class="dd-item ">
        <a href="/en/android/art/jni/%E8%A7%A3%E9%87%8A%E6%89%A7%E8%A1%8C7_0/">
        解释执行7_0
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/" title="启动流程" class="dd-item
        
        
        
        ">
      <a href="/en/android/art/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/">
          启动流程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/art%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/" title="ART启动流程" class="dd-item ">
        <a href="/en/android/art/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/art%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/">
        ART启动流程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="基础数据结构" class="dd-item ">
        <a href="/en/android/art/%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
        基础数据结构
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/art/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/" title="混合编译_运行" class="dd-item
        
        
        
        ">
      <a href="/en/android/art/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/">
          混合编译_运行
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/jvm_jit/" title="JVM_JIT" class="dd-item ">
        <a href="/en/android/art/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/jvm_jit/">
        JVM_JIT
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/art/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/" title="混合编译_运行" class="dd-item ">
        <a href="/en/android/art/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/%E6%B7%B7%E5%90%88%E7%BC%96%E8%AF%91_%E8%BF%90%E8%A1%8C/">
        混合编译_运行
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/gradlejenkins/" title="gradlejenkins" class="dd-item
        
        
        
        ">
      <a href="/en/android/gradlejenkins/">
          gradlejenkins
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/androidplugin/" title="AndroidPlugin" class="dd-item ">
        <a href="/en/android/gradlejenkins/androidplugin/">
        AndroidPlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/gradlejenkins/android%E6%89%93%E5%8C%85/" title="android打包" class="dd-item
        
        
        
        ">
      <a href="/en/android/gradlejenkins/android%E6%89%93%E5%8C%85/">
          android打包
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/android%E6%89%93%E5%8C%85/android%E6%89%93%E5%8C%85/" title="Android打包" class="dd-item ">
        <a href="/en/android/gradlejenkins/android%E6%89%93%E5%8C%85/android%E6%89%93%E5%8C%85/">
        Android打包
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/gradledebug/" title="GradleDebug" class="dd-item ">
        <a href="/en/android/gradlejenkins/gradledebug/">
        GradleDebug
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/gradleplugin/" title="GradlePlugin" class="dd-item ">
        <a href="/en/android/gradlejenkins/gradleplugin/">
        GradlePlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/gradle%E6%89%93%E5%8C%85%E8%BF%87%E7%A8%8B/" title="Gradle打包过程" class="dd-item ">
        <a href="/en/android/gradlejenkins/gradle%E6%89%93%E5%8C%85%E8%BF%87%E7%A8%8B/">
        Gradle打包过程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/gradlejenkins/transform/" title="Transform" class="dd-item ">
        <a href="/en/android/gradlejenkins/transform/">
        Transform
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/" title="jetpack" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/">
          jetpack
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/" title="arch" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/">
          arch
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/1lifecycle/" title="1lifecycle" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/1lifecycle/">
          1lifecycle
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/1lifecycle/lifecycle/" title="Lifecycle" class="dd-item ">
        <a href="/en/android/jetpack/arch/1lifecycle/lifecycle/">
        Lifecycle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/1lifecycle/lifecyclecoroutine/" title="LifecycleCoroutine" class="dd-item ">
        <a href="/en/android/jetpack/arch/1lifecycle/lifecyclecoroutine/">
        LifecycleCoroutine
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/2livedata/" title="2livedata" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/2livedata/">
          2livedata
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/2livedata/1mediatorlivedata/" title="1MediatorLiveData" class="dd-item ">
        <a href="/en/android/jetpack/arch/2livedata/1mediatorlivedata/">
        1MediatorLiveData
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/2livedata/livedata/" title="LiveData" class="dd-item ">
        <a href="/en/android/jetpack/arch/2livedata/livedata/">
        LiveData
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/2livedata/livedatacoroutine/" title="LiveDataCoroutine" class="dd-item ">
        <a href="/en/android/jetpack/arch/2livedata/livedatacoroutine/">
        LiveDataCoroutine
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/2livedata/transformations/" title="Transformations" class="dd-item ">
        <a href="/en/android/jetpack/arch/2livedata/transformations/">
        Transformations
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/3viewmodel/" title="3viewmodel" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/3viewmodel/">
          3viewmodel
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/3viewmodel/saveandrestoreinstancestate/" title="SaveAndRestoreInstanceState" class="dd-item ">
        <a href="/en/android/jetpack/arch/3viewmodel/saveandrestoreinstancestate/">
        SaveAndRestoreInstanceState
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/3viewmodel/savedstatehandle/" title="SavedStateHandle" class="dd-item ">
        <a href="/en/android/jetpack/arch/3viewmodel/savedstatehandle/">
        SavedStateHandle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/3viewmodel/savingstates/" title="SavingStates" class="dd-item ">
        <a href="/en/android/jetpack/arch/3viewmodel/savingstates/">
        SavingStates
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/3viewmodel/viewmodel/" title="ViewModel" class="dd-item ">
        <a href="/en/android/jetpack/arch/3viewmodel/viewmodel/">
        ViewModel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/3viewmodel/viewmodelscope_delegate/" title="ViewModelScope_Delegate" class="dd-item ">
        <a href="/en/android/jetpack/arch/3viewmodel/viewmodelscope_delegate/">
        ViewModelScope_Delegate
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/coroutines/" title="Coroutines" class="dd-item ">
        <a href="/en/android/jetpack/arch/coroutines/">
        Coroutines
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/databinding/" title="databinding" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/databinding/">
          databinding
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/databinding/databinding/" title="Databinding" class="dd-item ">
        <a href="/en/android/jetpack/arch/databinding/databinding/">
        Databinding
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/databinding/twowaydatabinding/" title="TwoWayDataBinding" class="dd-item ">
        <a href="/en/android/jetpack/arch/databinding/twowaydatabinding/">
        TwoWayDataBinding
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/di/" title="di" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/di/">
          di
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/di/di/" title="DI" class="dd-item ">
        <a href="/en/android/jetpack/arch/di/di/">
        DI
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/di/hiltsource/" title="HiltSource" class="dd-item ">
        <a href="/en/android/jetpack/arch/di/hiltsource/">
        HiltSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/" title="架构实现" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/">
          架构实现
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/kaptgenerateviewmodel/" title="KaptGenerateViewModel" class="dd-item ">
        <a href="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/kaptgenerateviewmodel/">
        KaptGenerateViewModel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/%E6%9E%B6%E6%9E%84%E6%80%9D%E8%80%83%E5%92%8C%E5%AE%9E%E7%8E%B0/" title="架构思考和实现" class="dd-item ">
        <a href="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/%E6%9E%B6%E6%9E%84%E6%80%9D%E8%80%83%E5%92%8C%E5%AE%9E%E7%8E%B0/">
        架构思考和实现
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/%E6%9E%B6%E6%9E%84%E6%80%9D%E8%80%83%E5%92%8C%E5%AE%9E%E7%8E%B0inner/" title="架构思考和实现Inner" class="dd-item ">
        <a href="/en/android/jetpack/arch/%E6%9E%B6%E6%9E%84%E5%AE%9E%E7%8E%B0/%E6%9E%B6%E6%9E%84%E6%80%9D%E8%80%83%E5%92%8C%E5%AE%9E%E7%8E%B0inner/">
        架构思考和实现Inner
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/compose/" title="compose" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/compose/">
          compose
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/compose/compose/" title="Compose" class="dd-item ">
        <a href="/en/android/jetpack/compose/compose/">
        Compose
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/compose/composesource/" title="ComposeSource" class="dd-item ">
        <a href="/en/android/jetpack/compose/composesource/">
        ComposeSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/compose/layoutnode/" title="LayoutNode" class="dd-item ">
        <a href="/en/android/jetpack/compose/layoutnode/">
        LayoutNode
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/compose/recomposition/" title="ReComposition" class="dd-item ">
        <a href="/en/android/jetpack/compose/recomposition/">
        ReComposition
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/supporttoandroidx/" title="SupportToAndroidx" class="dd-item ">
        <a href="/en/android/jetpack/supporttoandroidx/">
        SupportToAndroidx
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/jetpack/workmanager/" title="workmanager" class="dd-item
        
        
        
        ">
      <a href="/en/android/jetpack/workmanager/">
          workmanager
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/jetpack/workmanager/workmanager/" title="WorkManager" class="dd-item ">
        <a href="/en/android/jetpack/workmanager/workmanager/">
        WorkManager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/ndk/" title="ndk" class="dd-item
        
        
        
        ">
      <a href="/en/android/ndk/">
          ndk
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/ndk/elf%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/" title="ELF文件结构" class="dd-item ">
        <a href="/en/android/ndk/elf%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/">
        ELF文件结构
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/ndk/jni/" title="JNI" class="dd-item ">
        <a href="/en/android/ndk/jni/">
        JNI
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/ndk/native_hook/" title="native_hook" class="dd-item ">
        <a href="/en/android/ndk/native_hook/">
        native_hook
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/" title="system" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/">
          system
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/ashmem/" title="ashmem" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/ashmem/">
          ashmem
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/ashmem/%E5%8C%BF%E5%90%8D%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98ashmem/" title="匿名共享内存Ashmem" class="dd-item ">
        <a href="/en/android/system/ashmem/%E5%8C%BF%E5%90%8D%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98ashmem/">
        匿名共享内存Ashmem
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/bitmap/" title="bitmap" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/bitmap/">
          bitmap
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/bitmap/bitmap/" title="Bitmap" class="dd-item ">
        <a href="/en/android/system/bitmap/bitmap/">
        Bitmap
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/bitmap/bitmapsource/" title="BitmapSource" class="dd-item ">
        <a href="/en/android/system/bitmap/bitmapsource/">
        BitmapSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/handler/" title="handler" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/handler/">
          handler
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/handler/epoll/" title="Epoll" class="dd-item ">
        <a href="/en/android/system/handler/epoll/">
        Epoll
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/handler/looper/" title="Looper" class="dd-item ">
        <a href="/en/android/system/handler/looper/">
        Looper
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/handler/threadlocal/" title="ThreadLocal" class="dd-item ">
        <a href="/en/android/system/handler/threadlocal/">
        ThreadLocal
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/input/" title="input" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/input/">
          input
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/input/toucheventnative/" title="touchEventNative" class="dd-item ">
        <a href="/en/android/system/input/toucheventnative/">
        touchEventNative
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/kernel/" title="kernel" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/kernel/">
          kernel
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/kernel/kernel/" title="kernel" class="dd-item ">
        <a href="/en/android/system/kernel/kernel/">
        kernel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/layoutinflater/" title="layoutinflater" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/layoutinflater/">
          layoutinflater
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/layoutinflater/layoutinflater/" title="LayoutInflater" class="dd-item ">
        <a href="/en/android/system/layoutinflater/layoutinflater/">
        LayoutInflater
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/surfaceview/" title="surfaceview" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/surfaceview/">
          surfaceview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/surfaceview/surfaceviewsource/" title="SurfaceViewSource" class="dd-item ">
        <a href="/en/android/system/surfaceview/surfaceviewsource/">
        SurfaceViewSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/textureview/" title="textureview" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/textureview/">
          textureview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/textureview/textureviewsource/" title="TextureViewSource" class="dd-item ">
        <a href="/en/android/system/textureview/textureviewsource/">
        TextureViewSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/thread/" title="thread" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/thread/">
          thread
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/thread/stacktraceelement/" title="StackTraceElement" class="dd-item ">
        <a href="/en/android/system/thread/stacktraceelement/">
        StackTraceElement
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/thread/threadstate/" title="ThreadState" class="dd-item ">
        <a href="/en/android/system/thread/threadstate/">
        ThreadState
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/zygote/" title="zygote" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/zygote/">
          zygote
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/zygote/systemserversource/" title="SystemServerSource" class="dd-item ">
        <a href="/en/android/system/zygote/systemserversource/">
        SystemServerSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/zygote/zygotesource/" title="ZygoteSource" class="dd-item ">
        <a href="/en/android/system/zygote/zygotesource/">
        ZygoteSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/zygote/zygote%E8%BF%9B%E7%A8%8B/" title="Zygote进程" class="dd-item ">
        <a href="/en/android/system/zygote/zygote%E8%BF%9B%E7%A8%8B/">
        Zygote进程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/" title="后台任务" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/">
          后台任务
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1%E5%A4%84%E7%90%86/" title="后台任务处理" class="dd-item ">
        <a href="/en/android/system/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1/%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1%E5%A4%84%E7%90%86/">
        后台任务处理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/" title="多进程" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/">
          多进程
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/" title="binder" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/">
          binder
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/1binderservicemanager/" title="1BinderServiceManager" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/1binderservicemanager/">
        1BinderServiceManager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/2binderserver/" title="2BinderServer" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/2binderserver/">
        2BinderServer
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/3binderclient/" title="3BinderClient" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/3binderclient/">
        3BinderClient
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/4binderkernel/" title="4BinderKernel" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/4binderkernel/">
        4BinderKernel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderdeath/" title="BinderDeath" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binderdeath/">
        BinderDeath
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binder%E5%8E%9F%E7%90%86/" title="Binder原理" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/binder/binder%E5%8E%9F%E7%90%86/">
        Binder原理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/mmkv/" title="mmkv" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/mmkv/">
          mmkv
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/mmkv/mmkv/" title="MMKV" class="dd-item ">
        <a href="/en/android/system/%E5%A4%9A%E8%BF%9B%E7%A8%8B/mmkv/mmkv/">
        MMKV
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E9%80%80%E5%87%BA/" title="应用启动退出" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E9%80%80%E5%87%BA/">
          应用启动退出
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E9%80%80%E5%87%BA/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8/" title="应用启动" class="dd-item ">
        <a href="/en/android/system/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8%E9%80%80%E5%87%BA/%E5%BA%94%E7%94%A8%E5%90%AF%E5%8A%A8/">
        应用启动
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E6%BA%90%E7%A0%81%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95/" title="源码研究方法" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E6%BA%90%E7%A0%81%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95/">
          源码研究方法
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E6%BA%90%E7%A0%81%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95/syscall%E6%9F%A5%E6%89%BE%E6%96%B9%E5%BC%8F/" title="Syscall查找方式" class="dd-item ">
        <a href="/en/android/system/%E6%BA%90%E7%A0%81%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95/syscall%E6%9F%A5%E6%89%BE%E6%96%B9%E5%BC%8F/">
        Syscall查找方式
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/" title="系统绘制" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/">
          系统绘制
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/graphics/" title="Graphics" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/graphics/">
        Graphics
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/measurelayoutdraw/" title="measurelayoutdraw" class="dd-item
        
        
        
        ">
      <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/measurelayoutdraw/">
          measurelayoutdraw
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/measurelayoutdraw/measure/" title="measure" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/measurelayoutdraw/measure/">
        measure
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/vsync/" title="Vsync" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/vsync/">
        Vsync
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/vsync_surfaceflinger/" title="Vsync_SurfaceFlinger" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/vsync_surfaceflinger/">
        Vsync_SurfaceFlinger
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E7%A1%AC%E4%BB%B6%E5%8A%A0%E9%80%9F%E7%BB%98%E5%88%B6/" title="硬件加速绘制" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E7%A1%AC%E4%BB%B6%E5%8A%A0%E9%80%9F%E7%BB%98%E5%88%B6/">
        硬件加速绘制
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E7%BB%98%E5%88%B6%E5%8E%9F%E7%90%86/" title="绘制原理" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E7%BB%98%E5%88%B6%E5%8E%9F%E7%90%86/">
        绘制原理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E8%BD%AF%E4%BB%B6%E7%BB%98%E5%88%B6/" title="软件绘制" class="dd-item ">
        <a href="/en/android/system/%E7%B3%BB%E7%BB%9F%E7%BB%98%E5%88%B6/%E8%BD%AF%E4%BB%B6%E7%BB%98%E5%88%B6/">
        软件绘制
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/ui/" title="ui" class="dd-item
        
        
        
        ">
      <a href="/en/android/ui/">
          ui
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/ui/webview/" title="webview" class="dd-item
        
        
        
        ">
      <a href="/en/android/ui/webview/">
          webview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/ui/webview/webview/" title="WebView" class="dd-item ">
        <a href="/en/android/ui/webview/webview/">
        WebView
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/ui/%E5%8A%A8%E7%94%BB/" title="动画" class="dd-item
        
        
        
        ">
      <a href="/en/android/ui/%E5%8A%A8%E7%94%BB/">
          动画
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/ui/%E5%8A%A8%E7%94%BB/animatorsource/" title="AnimatorSource" class="dd-item ">
        <a href="/en/android/ui/%E5%8A%A8%E7%94%BB/animatorsource/">
        AnimatorSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%8C%85%E4%BD%93%E7%A7%AF/" title="包体积" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%8C%85%E4%BD%93%E7%A7%AF/">
          包体积
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%8C%85%E4%BD%93%E7%A7%AF/%E5%8C%85%E4%BD%93%E7%A7%AF%E5%8E%8B%E7%BC%A9/" title="包体积压缩" class="dd-item ">
        <a href="/en/android/%E5%8C%85%E4%BD%93%E7%A7%AF/%E5%8C%85%E4%BD%93%E7%A7%AF%E5%8E%8B%E7%BC%A9/">
        包体积压缩
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%9F%8B%E7%82%B9/" title="埋点" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%9F%8B%E7%82%B9/">
          埋点
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%9F%8B%E7%82%B9/%E5%9F%8B%E7%82%B9/" title="埋点" class="dd-item ">
        <a href="/en/android/%E5%9F%8B%E7%82%B9/%E5%9F%8B%E7%82%B9/">
        埋点
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%9F%8B%E7%82%B9/%E6%98%93%E8%A7%82%E6%96%B9%E8%88%9F/" title="易观方舟" class="dd-item ">
        <a href="/en/android/%E5%9F%8B%E7%82%B9/%E6%98%93%E8%A7%82%E6%96%B9%E8%88%9F/">
        易观方舟
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%AD%98%E5%82%A8/" title="存储" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%AD%98%E5%82%A8/">
          存储
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%AD%98%E5%82%A8/sharedpreferences/" title="sharedpreferences" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%AD%98%E5%82%A8/sharedpreferences/">
          sharedpreferences
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%AD%98%E5%82%A8/sharedpreferences/sharedpreferences/" title="SharedPreferences" class="dd-item ">
        <a href="/en/android/%E5%AD%98%E5%82%A8/sharedpreferences/sharedpreferences/">
        SharedPreferences
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E5%AE%89%E5%85%A8/" title="安全" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E5%AE%89%E5%85%A8/">
          安全
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%AE%89%E5%85%A8/app%E7%AD%BE%E5%90%8D/" title="app签名" class="dd-item ">
        <a href="/en/android/%E5%AE%89%E5%85%A8/app%E7%AD%BE%E5%90%8D/">
        app签名
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%AE%89%E5%85%A8/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/" title="应用安全" class="dd-item ">
        <a href="/en/android/%E5%AE%89%E5%85%A8/%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/">
        应用安全
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%AE%89%E5%85%A8/" title="网络请求安全" class="dd-item ">
        <a href="/en/android/%E5%AE%89%E5%85%A8/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%AE%89%E5%85%A8/">
        网络请求安全
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="性能优化" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">
          性能优化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/" title="apm" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/">
          apm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrixgradleplugin/" title="MatrixGradlePlugin" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrixgradleplugin/">
        MatrixGradlePlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrixsource/" title="MatrixSource" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrixsource/">
        MatrixSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrix%E6%8E%A5%E5%85%A5%E5%90%8E%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/" title="Matrix接入后遇到的问题" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrix%E6%8E%A5%E5%85%A5%E5%90%8E%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/">
        Matrix接入后遇到的问题
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrix%E7%A0%94%E7%A9%B6/" title="Matrix研究" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/matrix%E7%A0%94%E7%A9%B6/">
        Matrix研究
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/resource/" title="resource" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/resource/">
          resource
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/resource/matrixresourceplugin/" title="MatrixResourcePlugin" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/apm/resource/matrixresourceplugin/">
        MatrixResourcePlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/" title="内存优化" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/">
          内存优化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/1managememory/" title="1manageMemory" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/1managememory/">
        1manageMemory
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/2oom/" title="2OOM" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/2oom/">
        2OOM
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/3hprof_binary_dump_format/" title="3Hprof_binary_dump_format" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/3hprof_binary_dump_format/">
        3Hprof_binary_dump_format
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/4dumphprof/" title="4DumpHprof" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/4dumphprof/">
        4DumpHprof
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/5leakcanary2/" title="5LeakCanary2" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/5leakcanary2/">
        5LeakCanary2
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/6leakcanary2analyze/" title="6LeakCanary2Analyze" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/6leakcanary2analyze/">
        6LeakCanary2Analyze
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/7koomsource/" title="7KOOMSource" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/7koomsource/">
        7KOOMSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/" title="布局优化" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/">
          布局优化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/" title="布局优化" class="dd-item ">
        <a href="/en/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/%E5%B8%83%E5%B1%80%E4%BC%98%E5%8C%96/">
        布局优化
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/" title="插件化" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/">
          插件化
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/1%E6%8F%92%E4%BB%B6%E5%8C%96%E9%9D%A2%E4%B8%B4%E7%9A%84%E9%97%AE%E9%A2%98/" title="1插件化面临的问题" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/1%E6%8F%92%E4%BB%B6%E5%8C%96%E9%9D%A2%E4%B8%B4%E7%9A%84%E9%97%AE%E9%A2%98/">
        1插件化面临的问题
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/apk%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD/" title="apk安装和卸载" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/apk%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD/">
          apk安装和卸载
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/apk%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD/%E5%BA%94%E7%94%A8%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD%E8%BF%87%E7%A8%8B/" title="应用安装和卸载过程" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/apk%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD/%E5%BA%94%E7%94%A8%E5%AE%89%E8%A3%85%E5%92%8C%E5%8D%B8%E8%BD%BD%E8%BF%87%E7%A8%8B/">
        应用安装和卸载过程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/hook/" title="Hook" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/hook/">
        Hook
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/qigsaw/" title="qigsaw" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/qigsaw/">
          qigsaw
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/qigsaw/qigsaw/" title="Qigsaw" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/qigsaw/qigsaw/">
        Qigsaw
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/" title="shadow" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/">
          shadow
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadow/" title="Shadow" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadow/">
        Shadow
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadowplugin/" title="ShadowPlugin" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadowplugin/">
        ShadowPlugin
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadowsource/" title="ShadowSource" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/shadow/shadowsource/">
        ShadowSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/%E6%8F%92%E4%BB%B6%E5%8C%96%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B/" title="插件化技术选型" class="dd-item ">
        <a href="/en/android/%E6%8F%92%E4%BB%B6%E5%8C%96/%E6%8F%92%E4%BB%B6%E5%8C%96%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B/">
        插件化技术选型
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/" title="热修复字节码" class="dd-item
        parent
        
        
        ">
      <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/">
          热修复字节码
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/1hotfixresearch/" title="1hotfixResearch" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/1hotfixresearch/">
        1hotfixResearch
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/andfix/" title="AndFix" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/andfix/">
        AndFix
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/andfixsource/" title="AndFixSource" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/andfixsource/">
        AndFixSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/dex%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/" title="Dex文件格式" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/dex%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/">
        Dex文件格式
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/multidex/" title="MultiDex" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/multidex/">
        MultiDex
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/" title="tinker" class="dd-item
        parent
        
        
        ">
      <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/">
          tinker
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" title="源码分析" class="dd-item
        parent
        
        
        ">
      <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">
          源码分析
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/resource.arsc%E7%94%9F%E6%88%90%E5%92%8C%E7%BB%93%E6%9E%84/" title="Resource.arsc生成和结构" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/resource.arsc%E7%94%9F%E6%88%90%E5%92%8C%E7%BB%93%E6%9E%84/">
        Resource.arsc生成和结构
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkergradlepluginsource/" title="TinkerGradlePluginSource" class="dd-item active">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkergradlepluginsource/">
        TinkerGradlePluginSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkersource/" title="TinkerSource" class="dd-item ">
        <a href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkersource/">
        TinkerSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/" title="稳定性" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/">
          稳定性
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/" title="异常" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/">
          异常
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/1javacrash/" title="1javacrash" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/1javacrash/">
          1javacrash
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/1javacrash/javacrashsystemhandle/" title="JavaCrashSystemHandle" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/1javacrash/javacrashsystemhandle/">
        JavaCrashSystemHandle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/" title="anr" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/">
          anr
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/1anrsystmhandle/" title="1ANRSystmHandle" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/1anrsystmhandle/">
        1ANRSystmHandle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/2anrmonitor_collectinfo/" title="2ANRMonitor_CollectInfo" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/2anrmonitor_collectinfo/">
        2ANRMonitor_CollectInfo
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/3anranalysisrootcause/" title="3ANRAnalysisRootCause" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/anr/3anranalysisrootcause/">
        3ANRAnalysisRootCause
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/" title="nativecrash" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/">
          nativecrash
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/1nativecrash%E9%80%89%E5%9E%8B%E5%92%8C%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B/" title="1nativeCrash选型和整体流程" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/1nativecrash%E9%80%89%E5%9E%8B%E5%92%8C%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B/">
        1nativeCrash选型和整体流程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash1systemhandle/" title="nativeCrash1SystemHandle" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash1systemhandle/">
        nativeCrash1SystemHandle
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash2monitor_collectstack/" title="nativeCrash2Monitor_CollectStack" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash2monitor_collectstack/">
        nativeCrash2Monitor_CollectStack
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash3symbolrecovery/" title="nativeCrash3SymbolRecovery" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash3symbolrecovery/">
        nativeCrash3SymbolRecovery
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash4analysisrootcause/" title="nativeCrash4AnalysisRootCause" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/nativecrash/nativecrash4analysisrootcause/">
        nativeCrash4AnalysisRootCause
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/" title="xcrash" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/">
          xcrash
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/1xcrash%E5%8E%9F%E7%90%86/" title="1xCrash原理" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/1xcrash%E5%8E%9F%E7%90%86/">
        1xCrash原理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/linuxapi/" title="linuxApi" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/linuxapi/">
        linuxApi
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrashanr/" title="xCrashAnr" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrashanr/">
        xCrashAnr
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrashnativecrash/" title="xCrashNativeCrash" class="dd-item ">
        <a href="/en/android/%E7%A8%B3%E5%AE%9A%E6%80%A7/%E5%BC%82%E5%B8%B8/xcrash/xcrashnativecrash/">
        xCrashNativeCrash
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" title="自动化测试" class="dd-item
        
        
        
        ">
      <a href="/en/android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/">
          自动化测试
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/android%E4%BB%A3%E7%A0%81%E8%87%AA%E6%B5%8B/" title="android代码自测" class="dd-item ">
        <a href="/en/android/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/android%E4%BB%A3%E7%A0%81%E8%87%AA%E6%B5%8B/">
        android代码自测
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/java/" title="java" class="dd-item
        
        
        
        ">
      <a href="/en/java/">
          java
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/java/blockingqueue/" title="BlockingQueue" class="dd-item ">
        <a href="/en/java/blockingqueue/">
        BlockingQueue
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/java/java%E5%B9%B6%E5%8F%91/" title="java并发" class="dd-item ">
        <a href="/en/java/java%E5%B9%B6%E5%8F%91/">
        java并发
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/java/threadpoolexecutor/" title="ThreadPoolExecutor" class="dd-item ">
        <a href="/en/java/threadpoolexecutor/">
        ThreadPoolExecutor
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/kotlin/" title="kotlin" class="dd-item
        
        
        
        ">
      <a href="/en/kotlin/">
          kotlin
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/kotlin/coroutine/" title="coroutine" class="dd-item
        
        
        
        ">
      <a href="/en/kotlin/coroutine/">
          coroutine
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B/" title="kotlin协程" class="dd-item ">
        <a href="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B/">
        kotlin协程
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8Bsource/" title="kotlin协程Source" class="dd-item ">
        <a href="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8Bsource/">
        kotlin协程Source
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B%E5%8F%96%E6%B6%88/" title="kotlin协程取消" class="dd-item ">
        <a href="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B%E5%8F%96%E6%B6%88/">
        kotlin协程取消
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B%E5%BC%82%E5%B8%B8/" title="kotlin协程异常" class="dd-item ">
        <a href="/en/kotlin/coroutine/kotlin%E5%8D%8F%E7%A8%8B%E5%BC%82%E5%B8%B8/">
        kotlin协程异常
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/kotlin/coroutine/%E4%BD%BF%E7%94%A8%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0%E6%9D%A5%E5%B0%81%E8%A3%85%E5%9B%9E%E8%B0%83/" title="使用挂起函数来封装回调" class="dd-item ">
        <a href="/en/kotlin/coroutine/%E4%BD%BF%E7%94%A8%E6%8C%82%E8%B5%B7%E5%87%BD%E6%95%B0%E6%9D%A5%E5%B0%81%E8%A3%85%E5%9B%9E%E8%B0%83/">
        使用挂起函数来封装回调
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/linux/" title="linux" class="dd-item
        
        
        
        ">
      <a href="/en/linux/">
          linux
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/linux/linux_io/" title="linux_io" class="dd-item ">
        <a href="/en/linux/linux_io/">
        linux_io
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/%E6%80%9D%E6%83%B3/" title="思想" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%80%9D%E6%83%B3/">
          思想
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%80%9D%E6%83%B3/ioc/" title="IOC" class="dd-item ">
        <a href="/en/%E6%80%9D%E6%83%B3/ioc/">
        IOC
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%80%9D%E6%83%B3/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/" title="程序设计规范" class="dd-item ">
        <a href="/en/%E6%80%9D%E6%83%B3/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83/">
        程序设计规范
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%80%9D%E6%83%B3/%E7%BB%A7%E6%89%BF%E5%92%8C%E7%BB%84%E5%90%88/" title="继承和组合" class="dd-item ">
        <a href="/en/%E6%80%9D%E6%83%B3/%E7%BB%A7%E6%89%BF%E5%92%8C%E7%BB%84%E5%90%88/">
        继承和组合
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/" title="方向和趋势" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/">
          方向和趋势
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/" title="音视频" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/">
          音视频
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/" title="ffmpeg" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/">
          ffmpeg
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/examples/" title="examples" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/examples/">
          examples
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/examples/transcodingsource/" title="TranscodingSource" class="dd-item ">
        <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/examples/transcodingsource/">
        TranscodingSource
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/ffmpegdebug/" title="FFmpegDebug" class="dd-item ">
        <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/ffmpeg/ffmpegdebug/">
        FFmpegDebug
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/webrtc/" title="webrtc" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/webrtc/">
          webrtc
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/webrtc/webrtc%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD%E5%92%8C%E7%BC%96%E8%AF%91/" title="WebRTC源码下载和编译" class="dd-item ">
        <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/webrtc/webrtc%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD%E5%92%8C%E7%BC%96%E8%AF%91/">
        WebRTC源码下载和编译
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/%E7%BC%96%E8%A7%A3%E7%A0%81/" title="编解码" class="dd-item
        
        
        
        ">
      <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/%E7%BC%96%E8%A7%A3%E7%A0%81/">
          编解码
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/%E7%BC%96%E8%A7%A3%E7%A0%81/%E7%BC%96%E8%A7%A3%E7%A0%81%E7%9F%A5%E8%AF%86/" title="编解码知识" class="dd-item ">
        <a href="/en/%E6%96%B9%E5%90%91%E5%92%8C%E8%B6%8B%E5%8A%BF/%E9%9F%B3%E8%A7%86%E9%A2%91/%E7%BC%96%E8%A7%A3%E7%A0%81/%E7%BC%96%E8%A7%A3%E7%A0%81%E7%9F%A5%E8%AF%86/">
        编解码知识
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/" title="跨平台" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/">
          跨平台
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/" title="flutter" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/">
          flutter
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/" title="1startup" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/">
          1startup
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/1startup/" title="1startup" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/1startup/">
        1startup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/2startup_embedder_framwwork/" title="2startup_embedder_framwwork" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/2startup_embedder_framwwork/">
        2startup_embedder_framwwork
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/3flutter_surface/" title="3flutter_surface" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/3flutter_surface/">
        3flutter_surface
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/4startup_dart_framework/" title="4startup_dart_framework" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/1startup/4startup_dart_framework/">
        4startup_dart_framework
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/" title="engine" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/">
          engine
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/engine/" title="Engine" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/engine/">
        Engine
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/flutterenginecache/" title="FlutterEngineCache" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/flutterenginecache/">
        FlutterEngineCache
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/flutterenginedebug%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="FlutterEngineDebug环境搭建" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/flutterenginedebug%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">
        FlutterEngineDebug环境搭建
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/flutterenginegroup/" title="FlutterEngineGroup" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/engine/flutterenginegroup/">
        FlutterEngineGroup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/touch/" title="touch" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/touch/">
          touch
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/touch/touch/" title="Touch" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/touch/touch/">
        Touch
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%8A%A8%E7%94%BB/" title="动画" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%8A%A8%E7%94%BB/">
          动画
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%8A%A8%E7%94%BB/%E5%8A%A8%E7%94%BB/" title="动画" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%8A%A8%E7%94%BB/%E5%8A%A8%E7%94%BB/">
        动画
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/" title="响应式架构" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/">
          响应式架构
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/1%E8%B7%A8%E7%BB%84%E4%BB%B6%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE/" title="1跨组件传递数据" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/1%E8%B7%A8%E7%BB%84%E4%BB%B6%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE/">
        1跨组件传递数据
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/2provider/" title="2Provider" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/2provider/">
        2Provider
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/3%E5%BC%82%E6%AD%A5_%E5%93%8D%E5%BA%94%E5%BC%8F_%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/" title="3异步_响应式_状态管理" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/3%E5%BC%82%E6%AD%A5_%E5%93%8D%E5%BA%94%E5%BC%8F_%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/">
        3异步_响应式_状态管理
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/stream/" title="stream" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/stream/">
          stream
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/stream/stream/" title="Stream" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E5%93%8D%E5%BA%94%E5%BC%8F%E6%9E%B6%E6%9E%84/stream/stream/">
        Stream
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/" title="混合开发" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/">
          混合开发
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/flutterboost/" title="FlutterBoost" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/flutterboost/">
        FlutterBoost
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/flutterboost3/" title="FlutterBoost3" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/flutterboost3/">
        FlutterBoost3
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/" title="混合开发" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/%E6%B7%B7%E5%90%88%E5%BC%80%E5%8F%91/">
        混合开发
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/" title="渲染" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/">
          渲染
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/widget/" title="Widget" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/widget/">
        Widget
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/%E6%B8%B2%E6%9F%93/" title="渲染" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E6%B8%B2%E6%9F%93/%E6%B8%B2%E6%9F%93/">
        渲染
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E8%B7%AF%E7%94%B1/" title="路由" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E8%B7%AF%E7%94%B1/">
          路由
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E8%B7%AF%E7%94%B1/%E8%B7%AF%E7%94%B1/" title="路由" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E8%B7%AF%E7%94%B1/%E8%B7%AF%E7%94%B1/">
        路由
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/" title="通信" class="dd-item
        
        
        
        ">
      <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/">
          通信
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/eventchannel/" title="EventChannel" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/eventchannel/">
        EventChannel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/messageloop/" title="MessageLoop" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/messageloop/">
        MessageLoop
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/methodchannel/" title="MethodChannel" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/methodchannel/">
        MethodChannel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/pigeon/" title="Pigeon" class="dd-item ">
        <a href="/en/%E8%B7%A8%E5%B9%B3%E5%8F%B0/flutter/%E9%80%9A%E4%BF%A1/pigeon/">
        Pigeon
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/huanle19891345"><i class='fab fa-fw fa-github'></i> GitHub repo</a>
              </li>
          
              <li>
                  <a class="padding" href="https://huanle19891345.github.io/en/showcase"><i class='fas fa-fw fa-camera'></i> Showcases</a>
              </li>
          
              <li>
                  <a class="padding" href="https://gohugo.io/"><i class='fas fa-fw fa-bookmark'></i> Hugo Documentation</a>
              </li>
          
              <li>
                  <a class="padding" href="https://huanle19891345.github.io/en/credits"><i class='fas fa-fw fa-bullhorn'></i> Credits</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      

      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/en/'>技术探索总结</a> > <a href='/en/android/'>android</a> > <a href='/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/'>热修复字节码</a> > <a href='/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/'>tinker</a> > <a href='/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/'>源码分析</a> > TinkerGradlePluginSource
          
        
          
        
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#buildgradle层">build.gradle层</a></li>
    <li><a href="#tinkerpatchplugin">TinkerPatchPlugin</a>
      <ul>
        <li><a href="#tinkerpatchschematask">TinkerPatchSchemaTask</a></li>
        <li><a href="#runnerthinkerpatch">Runner.thinkerPatch</a></li>
      </ul>
    </li>
    <li><a href="#decoder类设计">Decoder类设计</a></li>
    <li><a href="#dexdiffdecoder">DexDiffDecoder</a>
      <ul>
        <li><a href="#excludedclassmodifiedchecker">ExcludedClassModifiedChecker</a>
          <ul>
            <li><a href="#dexclassescomparatorstartcheck">DexClassesComparator.startCheck</a></li>
            <li><a href="#issameclass">isSameClass</a></li>
          </ul>
        </li>
        <li><a href="#dex差分">Dex差分</a>
          <ul>
            <li><a href="#dexsectiondiffalgorithm类设计">DexSectionDiffAlgorithm类设计</a></li>
            <li><a href="#dexpatchgenerator">DexPatchGenerator</a></li>
            <li><a href="#executeandsaveto">executeAndSaveTo</a></li>
          </ul>
        </li>
        <li><a href="#dex差分合成">Dex差分合成</a>
          <ul>
            <li><a href="#dexsectionpatchalgorithm类设计">DexSectionPatchAlgorithm类设计</a></li>
            <li><a href="#dexpatchapplierexecuteandsaveto">DexPatchApplier.executeAndSaveTo</a></li>
            <li><a href="#dexpatchfile">DexPatchFile</a></li>
          </ul>
        </li>
        <li><a href="#checkdexchange">checkDexChange</a></li>
        <li><a href="#addtestdex">addTestDex</a></li>
      </ul>
    </li>
    <li><a href="#patchbuilderbuildpatch">PatchBuilder.buildPatch</a></li>
    <li><a href="#dex解析">Dex解析</a>
      <ul>
        <li><a href="#dex">Dex</a></li>
        <li><a href="#tableofcontents">TableOfContents</a>
          <ul>
            <li><a href="#readfromdex">readFromDex</a>
              <ul>
                <li><a href="#readheader">readHeader</a></li>
                <li><a href="#readmap">readMap</a></li>
                <li><a href="#computesizesfromoffsets">computeSizesFromOffsets</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#tableofcontentssection">TableOfContents.Section</a></li>
        <li><a href="#dexsection">Dex.Section</a></li>
      </ul>
    </li>
    <li><a href="#abstractindexmapadjustcode">AbstractIndexMap.adjust(Code)</a>
      <ul>
        <li><a href="#instructiontransformer">InstructionTransformer</a></li>
        <li><a href="#instructionreader被访问者">InstructionReader(被访问者)</a></li>
        <li><a href="#instructionvisitor类设计">InstructionVisitor类设计</a>
          <ul>
            <li><a href="#instructionvisitor">InstructionVisitor</a></li>
            <li><a href="#instructiontransformvisitor">InstructionTransformVisitor</a></li>
            <li><a href="#instructionwriter">InstructionWriter</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              TinkerGradlePluginSource
            </h1>
          

        


<p><a href="#decoder%E7%B1%BB%E8%AE%BE%E8%AE%A1">keyTitle_decoder类设计</a></p>
<p><a href="#dexsectiondiffalgorithm%E7%B1%BB%E8%AE%BE%E8%AE%A1">keyTitle_dexsectiondiffalgorithm类设计</a></p>
<p><a href="#dexsectionpatchalgorithm%E7%B1%BB%E8%AE%BE%E8%AE%A1">keyTitle_dexsectionpatchalgorithm类设计</a></p>
<h2 id="buildgradle层">build.gradle层</h2>
<p>1：构建基准apk(仅仅发版时需要打开tinkerEnabled，开发自己debug时不需要打开)</p>
<p>1.1: Copy apk,map,R文件到bakApk目录下</p>
<p>1.2: 创建tinkerPatchDebug和tinkerPatchRelease的task执行的必要参数</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">//tinker/tinker-sample-android/app/build.gradle
</span><span style="color:#75715e"></span><span style="color:#66d9ef">def</span> bakPath <span style="color:#f92672">=</span> file<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;${buildDir}/bakApk/&#34;</span><span style="color:#f92672">)</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e"> \* you can use assembleRelease to build you base apk
</span><span style="color:#75715e"> \* use tinkerPatchRelease -POLD_APK= -PAPPLY_MAPPING= -PAPPLY_RESOURCE= to build patch
</span><span style="color:#75715e"> \* add apk from the build/bakApk
</span><span style="color:#75715e"> */</span>
 ext <span style="color:#f92672">{</span>
   <span style="color:#75715e">//for some reason, you may want to ignore tinkerBuild, such as instant run debug build?
</span><span style="color:#75715e"></span>   tinkerEnabled <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>

   <span style="color:#75715e">//for normal build
</span><span style="color:#75715e"></span>   <span style="color:#75715e">//old apk file to build patch apk
</span><span style="color:#75715e"></span>   tinkerOldApkPath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${bakPath}/app-debug-0917-16-24-41.apk&#34;</span>
   <span style="color:#75715e">//proguard mapping file to build patch apk
</span><span style="color:#75715e"></span>   tinkerApplyMappingPath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${bakPath}/app-debug-1018-17-32-47-mapping.txt&#34;</span>
   <span style="color:#75715e">//resource R.txt to build patch apk, must input if there is resource changed
</span><span style="color:#75715e"></span>   tinkerApplyResourcePath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${bakPath}/app-debug-0424-15-02-56-R.txt&#34;</span>

   <span style="color:#75715e">//only use for build all flavor, if not, just ignore this field
</span><span style="color:#75715e"></span>   tinkerBuildFlavorDirectory <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${bakPath}/app-1018-17-32-47&#34;</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>buildWithTinker<span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
   apply plugin: <span style="color:#e6db74">&#39;com.tencent.tinker.patch&#39;</span>

   tinkerPatch <span style="color:#f92672">{</span>
     oldApk <span style="color:#f92672">=</span> getOldApkPath<span style="color:#f92672">()</span>
     ignoreWarning <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>
     useSign <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
     tinkerEnable <span style="color:#f92672">=</span> buildWithTinker<span style="color:#f92672">()</span>
     buildConfig <span style="color:#f92672">{</span>
       applyMapping <span style="color:#f92672">=</span> getApplyMappingPath<span style="color:#f92672">()</span>
       applyResourceMapping <span style="color:#f92672">=</span> getApplyResourceMappingPath<span style="color:#f92672">()</span>
 
       tinkerId <span style="color:#f92672">=</span> getTinkerIdValue<span style="color:#f92672">()</span>
 
       keepDexApply <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>
 
       isProtectedApp <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>
 
       supportHotplugComponent <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>
     <span style="color:#f92672">}</span>
 
     dex <span style="color:#f92672">{</span>
       dexMode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jar&#34;</span>
       pattern <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;classes*.dex&#34;</span><span style="color:#f92672">,</span>
            <span style="color:#e6db74">&#34;assets/secondary-dex-?.jar&#34;</span><span style="color:#f92672">]</span>
       loader <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
            <span style="color:#e6db74">&#34;tinker.sample.android.app.BaseBuildInfo&#34;</span>
       <span style="color:#f92672">]</span>
     <span style="color:#f92672">}</span>
 
     lib <span style="color:#f92672">{</span>
       pattern <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;lib/*/*.so&#34;</span><span style="color:#f92672">]</span>
     <span style="color:#f92672">}</span>
 
     res <span style="color:#f92672">{</span>
       pattern <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;res/*&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;assets/*&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;resources.arsc&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;AndroidManifest.xml&#34;</span><span style="color:#f92672">]</span>
       ignoreChange <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;assets/sample_meta.txt&#34;</span><span style="color:#f92672">]</span>
       largeModSize <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
     <span style="color:#f92672">}</span>
 
     packageConfig <span style="color:#f92672">{</span>
       configField<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;patchMessage&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;tinker is sample to use&#34;</span><span style="color:#f92672">)</span>
       configField<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;platform&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;all&#34;</span><span style="color:#f92672">)</span>
       configField<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;patchVersion&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;1.0&#34;</span><span style="color:#f92672">)</span>
     <span style="color:#f92672">}</span>
     sevenZip <span style="color:#f92672">{</span>
       zipArtifact <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;com.tencent.mm:SevenZip:1.1.10&#34;</span>
     <span style="color:#f92672">}</span>
   <span style="color:#f92672">}</span>


android<span style="color:#f92672">.</span><span style="color:#a6e22e">applicationVariants</span><span style="color:#f92672">.</span><span style="color:#a6e22e">all</span> <span style="color:#f92672">{</span> variant <span style="color:#f92672">-&gt;</span>
   <span style="color:#75715e">/**
</span><span style="color:#75715e">   \* task type, you want to bak
</span><span style="color:#75715e">   */</span>
   <span style="color:#66d9ef">def</span> taskName <span style="color:#f92672">=</span> variant<span style="color:#f92672">.</span><span style="color:#a6e22e">name</span>

   tasks<span style="color:#f92672">.</span><span style="color:#a6e22e">all</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#e6db74">&#34;assemble${taskName.capitalize()}&#34;</span><span style="color:#f92672">.</span><span style="color:#a6e22e">equalsIgnoreCase</span><span style="color:#f92672">(</span>it<span style="color:#f92672">.</span><span style="color:#a6e22e">name</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
       it<span style="color:#f92672">.</span><span style="color:#a6e22e">doLast</span> <span style="color:#f92672">{</span>
         copy <span style="color:#f92672">{</span>
           <span style="color:#66d9ef">def</span> fileNamePrefix <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${project.name}-${variant.baseName}&#34;</span>
           <span style="color:#66d9ef">def</span> newFileNamePrefix <span style="color:#f92672">=</span> hasFlavors <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;${fileNamePrefix}&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;${fileNamePrefix}-${date}&#34;</span>

           <span style="color:#66d9ef">def</span> destPath <span style="color:#f92672">=</span> hasFlavors <span style="color:#f92672">?</span> file<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;${bakPath}/${project.name}-${date}/${variant.flavorName}&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">:</span> bakPath

           <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>variant<span style="color:#f92672">.</span><span style="color:#a6e22e">metaClass</span><span style="color:#f92672">.</span><span style="color:#a6e22e">hasProperty</span><span style="color:#f92672">(</span>variant<span style="color:#f92672">,</span> <span style="color:#e6db74">&#39;packageApplicationProvider&#39;</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
             <span style="color:#66d9ef">def</span> packageAndroidArtifact <span style="color:#f92672">=</span> variant<span style="color:#f92672">.</span><span style="color:#a6e22e">packageApplicationProvider</span><span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">()</span>
             <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>packageAndroidArtifact <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
               <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
                 from <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">File</span><span style="color:#f92672">(</span>packageAndroidArtifact<span style="color:#f92672">.</span><span style="color:#a6e22e">outputDirectory</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getAsFile</span><span style="color:#f92672">().</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(),</span> variant<span style="color:#f92672">.</span><span style="color:#a6e22e">outputs</span><span style="color:#f92672">.</span><span style="color:#a6e22e">first</span><span style="color:#f92672">().</span><span style="color:#a6e22e">apkData</span><span style="color:#f92672">.</span><span style="color:#a6e22e">outputFileName</span><span style="color:#f92672">)</span>
               <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                 from <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">File</span><span style="color:#f92672">(</span>packageAndroidArtifact<span style="color:#f92672">.</span><span style="color:#a6e22e">outputDirectory</span><span style="color:#f92672">,</span> variant<span style="color:#f92672">.</span><span style="color:#a6e22e">outputs</span><span style="color:#f92672">.</span><span style="color:#a6e22e">first</span><span style="color:#f92672">().</span><span style="color:#a6e22e">apkData</span><span style="color:#f92672">.</span><span style="color:#a6e22e">outputFileName</span><span style="color:#f92672">)</span>
               <span style="color:#f92672">}</span>
             <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
               from variant<span style="color:#f92672">.</span><span style="color:#a6e22e">outputs</span><span style="color:#f92672">.</span><span style="color:#a6e22e">first</span><span style="color:#f92672">().</span><span style="color:#a6e22e">mainOutputFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">outputFile</span>
             <span style="color:#f92672">}</span>
           <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
             from variant<span style="color:#f92672">.</span><span style="color:#a6e22e">outputs</span><span style="color:#f92672">.</span><span style="color:#a6e22e">first</span><span style="color:#f92672">().</span><span style="color:#a6e22e">outputFile</span>
           <span style="color:#f92672">}</span>

           into destPath
           rename <span style="color:#f92672">{</span> String fileName <span style="color:#f92672">-&gt;</span>
             fileName<span style="color:#f92672">.</span><span style="color:#a6e22e">replace</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;${fileNamePrefix}.apk&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;${newFileNamePrefix}.apk&#34;</span><span style="color:#f92672">)</span>
           <span style="color:#f92672">}</span>

           from <span style="color:#e6db74">&#34;${buildDir}/outputs/mapping/${variant.dirName}/mapping.txt&#34;</span>
           into destPath
           rename <span style="color:#f92672">{</span> String fileName <span style="color:#f92672">-&gt;</span>
             fileName<span style="color:#f92672">.</span><span style="color:#a6e22e">replace</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;mapping.txt&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;${newFileNamePrefix}-mapping.txt&#34;</span><span style="color:#f92672">)</span>
           <span style="color:#f92672">}</span>

           from <span style="color:#e6db74">&#34;${buildDir}/intermediates/symbols/${variant.dirName}/R.txt&#34;</span>
           from <span style="color:#e6db74">&#34;${buildDir}/intermediates/symbol_list/${variant.dirName}/R.txt&#34;</span>
           into destPath
           rename <span style="color:#f92672">{</span> String fileName <span style="color:#f92672">-&gt;</span>
             fileName<span style="color:#f92672">.</span><span style="color:#a6e22e">replace</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;R.txt&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;${newFileNamePrefix}-R.txt&#34;</span><span style="color:#f92672">)</span>
           <span style="color:#f92672">}</span>
         <span style="color:#f92672">}</span>
       <span style="color:#f92672">}</span>
     <span style="color:#f92672">}</span>
   <span style="color:#f92672">}</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h2 id="tinkerpatchplugin">TinkerPatchPlugin</h2>
<pre><code class="language-properties" data-lang="properties">#tinker/tinker-build/tinker-patch-gradle-plugin/src/main/resources/META-INF/gradle-plugins/com.tencent.tinker.patch.properties
implementation-class=com.tencent.tinker.build.gradle.TinkerPatchPlugin
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TinkerPatchPlugin</span> <span style="color:#66d9ef">implements</span> Plugin<span style="color:#f92672">&lt;</span>Project<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
  <span style="color:#a6e22e">@Override</span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">apply</span><span style="color:#f92672">(</span>Project project<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
 mProject <span style="color:#f92672">=</span> project
 mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">extensions</span><span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#39;tinkerPatch&#39;</span><span style="color:#f92672">,</span> TinkerPatchExtension<span style="color:#f92672">)</span>
 mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">tinkerPatch</span><span style="color:#f92672">.</span><span style="color:#a6e22e">extensions</span><span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#39;buildConfig&#39;</span><span style="color:#f92672">,</span> TinkerBuildConfigExtension<span style="color:#f92672">,</span> mProject<span style="color:#f92672">)</span>
 
 <span style="color:#75715e">//mProject.tinkerPatch.extensions
</span><span style="color:#75715e"></span> mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">tinkerPatch</span><span style="color:#f92672">.</span><span style="color:#a6e22e">extensions</span><span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#39;dex&#39;</span><span style="color:#f92672">,</span> TinkerDexExtension<span style="color:#f92672">,</span> mProject<span style="color:#f92672">)</span>
 mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">tinkerPatch</span><span style="color:#f92672">.</span><span style="color:#a6e22e">extensions</span><span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#39;lib&#39;</span><span style="color:#f92672">,</span> TinkerLibExtension<span style="color:#f92672">)</span>
 mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">tinkerPatch</span><span style="color:#f92672">.</span><span style="color:#a6e22e">extensions</span><span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#39;res&#39;</span><span style="color:#f92672">,</span> TinkerResourceExtension<span style="color:#f92672">)</span>
 mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">tinkerPatch</span><span style="color:#f92672">.</span><span style="color:#a6e22e">extensions</span><span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;arkHot&#34;</span><span style="color:#f92672">,</span> TinkerArkHotExtension<span style="color:#f92672">)</span>
 mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">tinkerPatch</span><span style="color:#f92672">.</span><span style="color:#a6e22e">extensions</span><span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#39;packageConfig&#39;</span><span style="color:#f92672">,</span> TinkerPackageConfigExtension<span style="color:#f92672">,</span> mProject<span style="color:#f92672">)</span>
 mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">tinkerPatch</span><span style="color:#f92672">.</span><span style="color:#a6e22e">extensions</span><span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#39;sevenZip&#39;</span><span style="color:#f92672">,</span> TinkerSevenZipExtension<span style="color:#f92672">,</span> mProject<span style="color:#f92672">)</span>

android<span style="color:#f92672">.</span><span style="color:#a6e22e">applicationVariants</span><span style="color:#f92672">.</span><span style="color:#a6e22e">all</span> <span style="color:#f92672">{</span> variant <span style="color:#f92672">-&gt;</span>
   <span style="color:#66d9ef">def</span> variantOutput <span style="color:#f92672">=</span> variant<span style="color:#f92672">.</span><span style="color:#a6e22e">outputs</span><span style="color:#f92672">.</span><span style="color:#a6e22e">first</span><span style="color:#f92672">()</span>
   <span style="color:#66d9ef">def</span> variantName <span style="color:#f92672">=</span> variant<span style="color:#f92672">.</span><span style="color:#a6e22e">name</span><span style="color:#f92672">.</span><span style="color:#a6e22e">capitalize</span><span style="color:#f92672">()</span>
   <span style="color:#66d9ef">def</span> variantData <span style="color:#f92672">=</span> variant<span style="color:#f92672">.</span><span style="color:#a6e22e">variantData</span>

    <span style="color:#75715e">//创建task： tinkerPatchDebug或tinkerPatchRelease, main
</span><span style="color:#75715e"></span>    TinkerPatchSchemaTask tinkerPatchBuildTask <span style="color:#f92672">=</span> mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">tasks</span><span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;tinkerPatch${variantName}&#34;</span><span style="color:#f92672">,</span> TinkerPatchSchemaTask<span style="color:#f92672">)</span>

    <span style="color:#75715e">//创建task: tinkerProcessDebugManifest,main
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// Create a task to add a build TINKER_ID to AndroidManifest.xml
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// This task must be called after &#34;process${variantName}Manifest&#34;, since it
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// requires that an AndroidManifest.xml exists in `build/intermediates`.
</span><span style="color:#75715e"></span>    TinkerManifestTask manifestTask <span style="color:#f92672">=</span> mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">tasks</span><span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;tinkerProcess${variantName}Manifest&#34;</span><span style="color:#f92672">,</span> TinkerManifestTask<span style="color:#f92672">)</span>
    tinkerPatchBuildTask<span style="color:#f92672">.</span><span style="color:#a6e22e">signConfig</span> <span style="color:#f92672">=</span> variantData<span style="color:#f92672">.</span><span style="color:#a6e22e">variantConfiguration</span><span style="color:#f92672">.</span><span style="color:#a6e22e">signingConfig</span>
 
    variant<span style="color:#f92672">.</span><span style="color:#a6e22e">outputs</span><span style="color:#f92672">.</span><span style="color:#a6e22e">each</span> <span style="color:#f92672">{</span> output <span style="color:#f92672">-&gt;</span>
       setPatchNewApkPath<span style="color:#f92672">(</span>configuration<span style="color:#f92672">,</span> output<span style="color:#f92672">,</span> variant<span style="color:#f92672">,</span> tinkerPatchBuildTask<span style="color:#f92672">)</span>
       setPatchOutputFolder<span style="color:#f92672">(</span>configuration<span style="color:#f92672">,</span> output<span style="color:#f92672">,</span> variant<span style="color:#f92672">,</span> tinkerPatchBuildTask<span style="color:#f92672">)</span>
    <span style="color:#f92672">}</span>

    manifestTask<span style="color:#f92672">.</span><span style="color:#a6e22e">mustRunAfter</span> variantOutput<span style="color:#f92672">.</span><span style="color:#a6e22e">processManifest</span>
    variantOutput<span style="color:#f92672">.</span><span style="color:#a6e22e">processResources</span><span style="color:#f92672">.</span><span style="color:#a6e22e">dependsOn</span> manifestTask
    <span style="color:#75715e">//main
</span><span style="color:#75715e"></span>    TinkerResourceIdTask applyResourceTask <span style="color:#f92672">=</span> mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">tasks</span><span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;tinkerProcess${variantName}ResourceId&#34;</span><span style="color:#f92672">,</span> TinkerResourceIdTask<span style="color:#f92672">)</span>
    applyResourceTask<span style="color:#f92672">.</span><span style="color:#a6e22e">resDir</span> <span style="color:#f92672">=</span> variantOutput<span style="color:#f92672">.</span><span style="color:#a6e22e">processResources</span><span style="color:#f92672">.</span><span style="color:#a6e22e">inputResourcesDir</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getFiles</span><span style="color:#f92672">().</span><span style="color:#a6e22e">first</span><span style="color:#f92672">()</span>
    applyResourceTask<span style="color:#f92672">.</span><span style="color:#a6e22e">mustRunAfter</span> manifestTask

    variantOutput<span style="color:#f92672">.</span><span style="color:#a6e22e">processResources</span><span style="color:#f92672">.</span><span style="color:#a6e22e">dependsOn</span> applyResourceTask
    applyResourceTask<span style="color:#f92672">.</span><span style="color:#a6e22e">dependsOn</span> mergeResourcesTask


    <span style="color:#a6e22e">if</span> <span style="color:#f92672">(</span>multiDexEnabled<span style="color:#f92672">)</span> <span style="color:#f92672">{</span><span style="color:#75715e">//main
</span><span style="color:#75715e"></span>       TinkerMultidexConfigTask multidexConfigTask <span style="color:#f92672">=</span> mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">tasks</span><span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;tinkerProcess${variantName}MultidexKeep&#34;</span><span style="color:#f92672">,</span>     TinkerMultidexConfigTask<span style="color:#f92672">)</span>
       multidexConfigTask<span style="color:#f92672">.</span><span style="color:#a6e22e">applicationVariant</span> <span style="color:#f92672">=</span> variant
       multidexConfigTask<span style="color:#f92672">.</span><span style="color:#a6e22e">multiDexKeepProguard</span> <span style="color:#f92672">=</span> getManifestMultiDexKeepProguard<span style="color:#f92672">(</span>variant<span style="color:#f92672">)</span>
       multidexConfigTask<span style="color:#f92672">.</span><span style="color:#a6e22e">mustRunAfter</span> manifestTask

    multidexConfigTask<span style="color:#f92672">.</span><span style="color:#a6e22e">mustRunAfter</span> variantOutput<span style="color:#f92672">.</span><span style="color:#a6e22e">processResources</span>
    multidexTask<span style="color:#f92672">.</span><span style="color:#a6e22e">dependsOn</span> multidexConfigTask

    <span style="color:#a6e22e">if</span> <span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">buildConfig</span><span style="color:#f92672">.</span><span style="color:#a6e22e">keepDexApply</span>
         <span style="color:#f92672">&amp;&amp;</span> FileOperation<span style="color:#f92672">.</span><span style="color:#a6e22e">isLegalFile</span><span style="color:#f92672">(</span>mProject<span style="color:#f92672">.</span><span style="color:#a6e22e">tinkerPatch</span><span style="color:#f92672">.</span><span style="color:#a6e22e">oldApk</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
       com<span style="color:#f92672">.</span><span style="color:#a6e22e">tencent</span><span style="color:#f92672">.</span><span style="color:#a6e22e">tinker</span><span style="color:#f92672">.</span><span style="color:#a6e22e">build</span><span style="color:#f92672">.</span><span style="color:#a6e22e">gradle</span><span style="color:#f92672">.</span><span style="color:#a6e22e">transform</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ImmutableDexTransform</span><span style="color:#f92672">.</span><span style="color:#a6e22e">inject</span><span style="color:#f92672">(</span>mProject<span style="color:#f92672">,</span> variant<span style="color:#f92672">)</span><span style="color:#75715e">//main
</span><span style="color:#75715e"></span>     <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setPatchNewApkPath</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">,</span> output<span style="color:#f92672">,</span> variant<span style="color:#f92672">,</span> tinkerPatchBuildTask<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    tinkerPatchBuildTask<span style="color:#f92672">.</span><span style="color:#a6e22e">dependsOn</span> variant<span style="color:#f92672">.</span><span style="color:#a6e22e">assemble</span><span style="color:#75715e">//assembleDebug
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</code></pre></div><p><img src="/img/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkergradlepluginsource.assets/image-20210301174211724.png" alt="image-20210301174211724"></p>
<p>ImmutableDexTransform</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#a6e22e">@Override</span>
 <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">transform</span><span style="color:#f92672">(</span>TransformInvocation transformInvocation<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> TransformException<span style="color:#f92672">,</span> IOException<span style="color:#f92672">,</span> InterruptedException <span style="color:#f92672">{}</span>
</code></pre></div><h3 id="tinkerpatchschematask">TinkerPatchSchemaTask</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy">TinkerPatchExtension configuration
 <span style="color:#66d9ef">def</span> android
 String buildApkPath
 String outputFolder
 <span style="color:#66d9ef">def</span> signConfig

<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">TinkerPatchSchemaTask</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
   description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Assemble Tinker Patch&#39;</span>
   group <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;tinker&#39;</span>
   outputs<span style="color:#f92672">.</span><span style="color:#a6e22e">upToDateWhen</span> <span style="color:#f92672">{</span> <span style="color:#66d9ef">false</span> <span style="color:#f92672">}</span>
   configuration <span style="color:#f92672">=</span> project<span style="color:#f92672">.</span><span style="color:#a6e22e">tinkerPatch</span>

   android <span style="color:#f92672">=</span> project<span style="color:#f92672">.</span><span style="color:#a6e22e">extensions</span><span style="color:#f92672">.</span><span style="color:#a6e22e">android</span>
 <span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#a6e22e">@TaskAction</span>
 <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">tinkerPatch</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
 configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">checkParameter</span><span style="color:#f92672">()</span>
 configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">buildConfig</span><span style="color:#f92672">.</span><span style="color:#a6e22e">checkParameter</span><span style="color:#f92672">()</span>
 configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">res</span><span style="color:#f92672">.</span><span style="color:#a6e22e">checkParameter</span><span style="color:#f92672">()</span>
 configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">dex</span><span style="color:#f92672">.</span><span style="color:#a6e22e">checkDexMode</span><span style="color:#f92672">()</span>
 configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">sevenZip</span><span style="color:#f92672">.</span><span style="color:#a6e22e">resolveZipFinalPath</span><span style="color:#f92672">()</span>

builder<span style="color:#f92672">.</span><span style="color:#a6e22e">setOldApk</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">oldApk</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setNewApk</span><span style="color:#f92672">(</span>buildApkPath<span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setOutBuilder</span><span style="color:#f92672">(</span>outputFolder<span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setIgnoreWarning</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">ignoreWarning</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setAllowLoaderInAnyDex</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">allowLoaderInAnyDex</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setRemoveLoaderForAllDex</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">removeLoaderForAllDex</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setDexFilePattern</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">dex</span><span style="color:#f92672">.</span><span style="color:#a6e22e">pattern</span><span style="color:#f92672">))</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setIsProtectedApp</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">buildConfig</span><span style="color:#f92672">.</span><span style="color:#a6e22e">isProtectedApp</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setIsComponentHotplugSupported</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">buildConfig</span><span style="color:#f92672">.</span><span style="color:#a6e22e">supportHotplugComponent</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setDexLoaderPattern</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">dex</span><span style="color:#f92672">.</span><span style="color:#a6e22e">loader</span><span style="color:#f92672">))</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setDexIgnoreWarningLoaderPattern</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">dex</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ignoreWarningLoader</span><span style="color:#f92672">))</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setDexMode</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">dex</span><span style="color:#f92672">.</span><span style="color:#a6e22e">dexMode</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setSoFilePattern</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">lib</span><span style="color:#f92672">.</span><span style="color:#a6e22e">pattern</span><span style="color:#f92672">))</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setResourceFilePattern</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">res</span><span style="color:#f92672">.</span><span style="color:#a6e22e">pattern</span><span style="color:#f92672">))</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setResourceIgnoreChangePattern</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">res</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ignoreChange</span><span style="color:#f92672">))</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setResourceIgnoreChangeWarningPattern</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">res</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ignoreChangeWarning</span><span style="color:#f92672">))</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setResourceLargeModSize</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">res</span><span style="color:#f92672">.</span><span style="color:#a6e22e">largeModSize</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setUseApplyResource</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">buildConfig</span><span style="color:#f92672">.</span><span style="color:#a6e22e">usingResourceMapping</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setConfigFields</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> String<span style="color:#f92672">&gt;(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">packageConfig</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getFields</span><span style="color:#f92672">()))</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setSevenZipPath</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">sevenZip</span><span style="color:#f92672">.</span><span style="color:#a6e22e">path</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setUseSign</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">useSign</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setArkHotPath</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">arkHot</span><span style="color:#f92672">.</span><span style="color:#a6e22e">path</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">setArkHotName</span><span style="color:#f92672">(</span>configuration<span style="color:#f92672">.</span><span style="color:#a6e22e">arkHot</span><span style="color:#f92672">.</span><span style="color:#a6e22e">name</span><span style="color:#f92672">)</span>

 InputParam inputParam <span style="color:#f92672">=</span> builder<span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">()</span>
 Runner<span style="color:#f92672">.</span><span style="color:#a6e22e">gradleRun</span><span style="color:#f92672">(</span>inputParam<span style="color:#f92672">);</span>
</code></pre></div><h3 id="runnerthinkerpatch">Runner.thinkerPatch</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">gradleRun</span><span style="color:#f92672">(</span>InputParam inputParam<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   mBeginTime <span style="color:#f92672">=</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">currentTimeMillis</span><span style="color:#f92672">();</span>
   Runner m <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Runner<span style="color:#f92672">();</span>
   m<span style="color:#f92672">.</span><span style="color:#a6e22e">run</span><span style="color:#f92672">(</span>inputParam<span style="color:#f92672">);</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span><span style="color:#f92672">(</span>InputParam inputParam<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   loadConfigFromGradle<span style="color:#f92672">(</span>inputParam<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">//tinker-sample-android\app\build\outputs\apk/tinkerPatch/debug\log.txt
</span><span style="color:#75715e"></span>     Logger<span style="color:#f92672">.</span><span style="color:#a6e22e">initLogger</span><span style="color:#f92672">(</span>config<span style="color:#f92672">);</span>
     tinkerPatch<span style="color:#f92672">();</span><span style="color:#75715e">//main
</span><span style="color:#75715e"></span>   <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
     goToError<span style="color:#f92672">();</span>
   <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
     Logger<span style="color:#f92672">.</span><span style="color:#a6e22e">closeLogger</span><span style="color:#f92672">();</span>
   <span style="color:#f92672">}</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">tinkerPatch</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
   Logger<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;-----------------------Tinker patch begin-----------------------&#34;</span><span style="color:#f92672">);</span>
   Logger<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span>config<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">());</span>
   <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
     <span style="color:#75715e">//gen patch
</span><span style="color:#75715e"></span>     ApkDecoder decoder <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ApkDecoder<span style="color:#f92672">(</span>config<span style="color:#f92672">);</span>
     decoder<span style="color:#f92672">.</span><span style="color:#a6e22e">onAllPatchesStart</span><span style="color:#f92672">();</span>
     decoder<span style="color:#f92672">.</span><span style="color:#a6e22e">patch</span><span style="color:#f92672">(</span>config<span style="color:#f92672">.</span><span style="color:#a6e22e">mOldApkFile</span><span style="color:#f92672">,</span> config<span style="color:#f92672">.</span><span style="color:#a6e22e">mNewApkFile</span><span style="color:#f92672">);</span><span style="color:#75715e">//main
</span><span style="color:#75715e"></span>     decoder<span style="color:#f92672">.</span><span style="color:#a6e22e">onAllPatchesEnd</span><span style="color:#f92672">();</span>
 
     <span style="color:#75715e">//gen meta file and version file
</span><span style="color:#75715e"></span>     PatchInfo info <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PatchInfo<span style="color:#f92672">(</span>config<span style="color:#f92672">);</span>
     info<span style="color:#f92672">.</span><span style="color:#a6e22e">gen</span><span style="color:#f92672">();</span><span style="color:#75715e">//输出assets/package_meta.txt文件记录版本信息
</span><span style="color:#75715e"></span>
     <span style="color:#75715e">//build patch
</span><span style="color:#75715e"></span>     PatchBuilder builder <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PatchBuilder<span style="color:#f92672">(</span>config<span style="color:#f92672">);</span>
     builder<span style="color:#f92672">.</span><span style="color:#a6e22e">buildPatch</span><span style="color:#f92672">();</span>
   <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Throwable e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     e<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
     goToError<span style="color:#f92672">();</span>
   <span style="color:#f92672">}</span>

   Logger<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Tinker patch done, total time cost: %fs&#34;</span><span style="color:#f92672">,</span> diffTimeFromBegin<span style="color:#f92672">());</span>
   Logger<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Tinker patch done, you can go to file to find the output %s&#34;</span><span style="color:#f92672">,</span> config<span style="color:#f92672">.</span><span style="color:#a6e22e">mOutFolder</span><span style="color:#f92672">);</span>
   Logger<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;-----------------------Tinker patch end-------------------------&#34;</span><span style="color:#f92672">);</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h2 id="decoder类设计">Decoder类设计</h2>
<p><img src="/img/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkergradlepluginsource.assets/decoder.png" alt=""></p>
<h2 id="dexdiffdecoder">DexDiffDecoder</h2>
<h3 id="excludedclassmodifiedchecker">ExcludedClassModifiedChecker</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">checkIfExcludedClassWasModifiedInNewDex</span><span style="color:#f92672">(</span>File oldFile<span style="color:#f92672">,</span> File newFile<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException<span style="color:#f92672">,</span> TinkerPatchException <span style="color:#f92672">{</span>
 <span style="color:#66d9ef">int</span> stmCode <span style="color:#f92672">=</span> STMCODE_START<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>stmCode <span style="color:#f92672">!=</span> STMCODE_END<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">switch</span> <span style="color:#f92672">(</span>stmCode<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   	<span style="color:#66d9ef">case</span> STMCODE_START<span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
      <span style="color:#66d9ef">boolean</span> isPrimaryDex <span style="color:#f92672">=</span> isPrimaryDex<span style="color:#f92672">((</span>oldFile <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> newFile <span style="color:#f92672">:</span> oldFile<span style="color:#f92672">));</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>isPrimaryDex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
 	      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>oldFile <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
  	      stmCode <span style="color:#f92672">=</span> STMCODE_ERROR_PRIMARY_OLD_DEX_IS_MISSING<span style="color:#f92672">;</span>
  	    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>newFile <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
          stmCode <span style="color:#f92672">=</span> STMCODE_ERROR_PRIMARY_NEW_DEX_IS_MISSING<span style="color:#f92672">;</span>
       <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
        dexCmptor<span style="color:#f92672">.</span><span style="color:#a6e22e">startCheck</span><span style="color:#f92672">(</span>oldDex<span style="color:#f92672">,</span> newDex<span style="color:#f92672">);</span><span style="color:#75715e">//main
</span></code></pre></div><h4 id="dexclassescomparatorstartcheck">DexClassesComparator.startCheck</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">startCheck</span><span style="color:#f92672">(</span>Dex oldDex<span style="color:#f92672">,</span> Dex newDex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   startCheck<span style="color:#f92672">(</span>DexGroup<span style="color:#f92672">.</span><span style="color:#a6e22e">wrap</span><span style="color:#f92672">(</span>oldDex<span style="color:#f92672">),</span> DexGroup<span style="color:#f92672">.</span><span style="color:#a6e22e">wrap</span><span style="color:#f92672">(</span>newDex<span style="color:#f92672">));</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">startCheck</span><span style="color:#f92672">(</span>DexGroup oldDexGroup<span style="color:#f92672">,</span> DexGroup newDexGroup<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
<span style="color:#75715e">//add, delete, change三个列表必须都是empty，才算是逻辑上一致
</span><span style="color:#75715e"></span>Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> deletedClassDescs <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashSet<span style="color:#f92672">&lt;&gt;(</span>oldDescriptorOfClassesToCheck<span style="color:#f92672">);</span>
deletedClassDescs<span style="color:#f92672">.</span><span style="color:#a6e22e">removeAll</span><span style="color:#f92672">(</span>newDescriptorOfClassesToCheck<span style="color:#f92672">);</span>

Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> addedClassDescs <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashSet<span style="color:#f92672">&lt;&gt;(</span>newDescriptorOfClassesToCheck<span style="color:#f92672">);</span>
addedClassDescs<span style="color:#f92672">.</span><span style="color:#a6e22e">removeAll</span><span style="color:#f92672">(</span>oldDescriptorOfClassesToCheck<span style="color:#f92672">);</span>

Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> mayBeChangedClassDescs <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashSet<span style="color:#f92672">&lt;&gt;(</span>oldDescriptorOfClassesToCheck<span style="color:#f92672">);</span>
mayBeChangedClassDescs<span style="color:#f92672">.</span><span style="color:#a6e22e">retainAll</span><span style="color:#f92672">(</span>newDescriptorOfClassesToCheck<span style="color:#f92672">);</span>

<span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>String desc <span style="color:#f92672">:</span> mayBeChangedClassDescs<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   DexClassInfo oldClassInfo <span style="color:#f92672">=</span> oldClassDescriptorToClassInfoMap<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>desc<span style="color:#f92672">);</span>
   DexClassInfo newClassInfo <span style="color:#f92672">=</span> newClassDescriptorToClassInfoMap<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>desc<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">switch</span> <span style="color:#f92672">(</span>compareMode<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">case</span> COMPARE_MODE_NORMAL<span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
       <span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>isSameClass<span style="color:#f92672">(</span><span style="color:#75715e">//main
</span><span style="color:#75715e"></span>           oldClassInfo<span style="color:#f92672">.</span><span style="color:#a6e22e">owner</span><span style="color:#f92672">,</span>
           newClassInfo<span style="color:#f92672">.</span><span style="color:#a6e22e">owner</span><span style="color:#f92672">,</span>
           oldClassInfo<span style="color:#f92672">.</span><span style="color:#a6e22e">classDef</span><span style="color:#f92672">,</span>
           newClassInfo<span style="color:#f92672">.</span><span style="color:#a6e22e">classDef</span>
       <span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
         <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>Utils<span style="color:#f92672">.</span><span style="color:#a6e22e">isStringMatchesPatterns</span><span style="color:#f92672">(</span>desc<span style="color:#f92672">,</span> patternsOfIgnoredRemovedClassDesc<span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
           logger<span style="color:#f92672">.</span><span style="color:#a6e22e">i</span><span style="color:#f92672">(</span>TAG<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Ignored changed class: %s&#34;</span><span style="color:#f92672">,</span> desc<span style="color:#f92672">);</span>
         <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
           logger<span style="color:#f92672">.</span><span style="color:#a6e22e">i</span><span style="color:#f92672">(</span>TAG<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Changed class: %s&#34;</span><span style="color:#f92672">,</span> desc<span style="color:#f92672">);</span>
           changedClassDescToClassInfosMap<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span>
               desc<span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> DexClassInfo<span style="color:#f92672">[]{</span>oldClassInfo<span style="color:#f92672">,</span> newClassInfo<span style="color:#f92672">}</span>
           <span style="color:#f92672">);</span>
         <span style="color:#f92672">}</span>
</code></pre></div><h4 id="issameclass">isSameClass</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">isSameClass</span><span style="color:#f92672">(</span>
     Dex oldDex<span style="color:#f92672">,</span>
     Dex newDex<span style="color:#f92672">,</span>
     ClassDef oldClassDef<span style="color:#f92672">,</span>
     ClassDef newClassDef
 <span style="color:#f92672">)</span> <span style="color:#f92672">{</span><span style="color:#75715e">//内部会有各种界别same的判断，内部还会调用isSameMethod，isSameCode等等，判断是否逻辑一致
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>oldClassDef<span style="color:#f92672">.</span><span style="color:#a6e22e">accessFlags</span> <span style="color:#f92672">!=</span> newClassDef<span style="color:#f92672">.</span><span style="color:#a6e22e">accessFlags</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
   <span style="color:#f92672">}</span>
 
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>isSameClassDesc<span style="color:#f92672">(</span>
       oldDex<span style="color:#f92672">,</span> newDex<span style="color:#f92672">,</span> oldClassDef<span style="color:#f92672">.</span><span style="color:#a6e22e">supertypeIndex</span><span style="color:#f92672">,</span> newClassDef<span style="color:#f92672">.</span><span style="color:#a6e22e">supertypeIndex</span>
   <span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
   <span style="color:#f92672">}</span>
 
   <span style="color:#66d9ef">short</span><span style="color:#f92672">[]</span> oldInterfaceIndices <span style="color:#f92672">=</span> oldDex<span style="color:#f92672">.</span><span style="color:#a6e22e">interfaceTypeIndicesFromClassDef</span><span style="color:#f92672">(</span>oldClassDef<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">short</span><span style="color:#f92672">[]</span> newInterfaceIndices <span style="color:#f92672">=</span> newDex<span style="color:#f92672">.</span><span style="color:#a6e22e">interfaceTypeIndicesFromClassDef</span><span style="color:#f92672">(</span>newClassDef<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>oldInterfaceIndices<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> newInterfaceIndices<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
   <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> oldInterfaceIndices<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> <span style="color:#f92672">++</span>i<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
       <span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>isSameClassDesc<span style="color:#f92672">(</span>oldDex<span style="color:#f92672">,</span> newDex<span style="color:#f92672">,</span> oldInterfaceIndices<span style="color:#f92672">[</span>i<span style="color:#f92672">],</span> newInterfaceIndices<span style="color:#f92672">[</span>i<span style="color:#f92672">]))</span> <span style="color:#f92672">{</span>
         <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
       <span style="color:#f92672">}</span>
     <span style="color:#f92672">}</span>
   <span style="color:#f92672">}</span>
 
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>isSameName<span style="color:#f92672">(</span>oldDex<span style="color:#f92672">,</span> newDex<span style="color:#f92672">,</span> oldClassDef<span style="color:#f92672">.</span><span style="color:#a6e22e">sourceFileIndex</span><span style="color:#f92672">,</span> newClassDef<span style="color:#f92672">.</span><span style="color:#a6e22e">sourceFileIndex</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
   <span style="color:#f92672">}</span>
 
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>isSameAnnotationDirectory<span style="color:#f92672">(</span>
       oldDex<span style="color:#f92672">,</span>
       newDex<span style="color:#f92672">,</span>
       oldClassDef<span style="color:#f92672">.</span><span style="color:#a6e22e">annotationsOffset</span><span style="color:#f92672">,</span>
       newClassDef<span style="color:#f92672">.</span><span style="color:#a6e22e">annotationsOffset</span>
   <span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
   <span style="color:#f92672">}</span>
 
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>isSameClassData<span style="color:#f92672">(</span>
       oldDex<span style="color:#f92672">,</span>
       newDex<span style="color:#f92672">,</span>
       oldClassDef<span style="color:#f92672">.</span><span style="color:#a6e22e">classDataOffset</span><span style="color:#f92672">,</span>
       newClassDef<span style="color:#f92672">.</span><span style="color:#a6e22e">classDataOffset</span>
   <span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
   <span style="color:#f92672">}</span>
 
   <span style="color:#66d9ef">return</span> isSameStaticValue<span style="color:#f92672">(</span>
       oldDex<span style="color:#f92672">,</span>
       newDex<span style="color:#f92672">,</span>
       oldClassDef<span style="color:#f92672">.</span><span style="color:#a6e22e">staticValuesOffset</span><span style="color:#f92672">,</span>
       newClassDef<span style="color:#f92672">.</span><span style="color:#a6e22e">staticValuesOffset</span>
   <span style="color:#f92672">);</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h3 id="dex差分">Dex差分</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">dexPatchGen<span style="color:#f92672">.</span><span style="color:#a6e22e">executeAndSaveTo</span><span style="color:#f92672">(</span>dexDiffOut<span style="color:#f92672">);</span><span style="color:#75715e">//Dex差分
</span></code></pre></div><h4 id="dexsectiondiffalgorithm类设计">DexSectionDiffAlgorithm类设计</h4>
<p>二路归并算法是较小的指针+1，从而判断是删除old还是新增new</p>
<p><img src="/img/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkergradlepluginsource.assets/dexdiff.png" alt=""></p>
<h4 id="dexpatchgenerator">DexPatchGenerator</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"> <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>StringData<span style="color:#f92672">&gt;</span> stringDataSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> typeIdSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>ProtoId<span style="color:#f92672">&gt;</span> protoIdSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>FieldId<span style="color:#f92672">&gt;</span> fieldIdSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>MethodId<span style="color:#f92672">&gt;</span> methodIdSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>ClassDef<span style="color:#f92672">&gt;</span> classDefSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>TypeList<span style="color:#f92672">&gt;</span> typeListSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>AnnotationSetRefList<span style="color:#f92672">&gt;</span> annotationSetRefListSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>AnnotationSet<span style="color:#f92672">&gt;</span> annotationSetSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>ClassData<span style="color:#f92672">&gt;</span> classDataSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>Code<span style="color:#f92672">&gt;</span> codeSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>DebugInfoItem<span style="color:#f92672">&gt;</span> debugInfoSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>Annotation<span style="color:#f92672">&gt;</span> annotationSectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>EncodedValue<span style="color:#f92672">&gt;</span> encodedArraySectionDiffAlg<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">private</span> DexSectionDiffAlgorithm<span style="color:#f92672">&lt;</span>AnnotationsDirectory<span style="color:#f92672">&gt;</span> annotationsDirectorySectionDiffAlg<span style="color:#f92672">;</span>

<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DexPatchGenerator</span><span style="color:#f92672">(</span>File oldDexFile<span style="color:#f92672">,</span> File newDexFile<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Dex<span style="color:#f92672">(</span>oldDexFile<span style="color:#f92672">),</span> <span style="color:#66d9ef">new</span> Dex<span style="color:#f92672">(</span>newDexFile<span style="color:#f92672">));</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DexPatchGenerator</span><span style="color:#f92672">(</span>Dex oldDex<span style="color:#f92672">,</span> Dex newDex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">oldDex</span> <span style="color:#f92672">=</span> oldDex<span style="color:#f92672">;</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">newDex</span> <span style="color:#f92672">=</span> newDex<span style="color:#f92672">;</span>
   SparseIndexMap oldToNewIndexMap <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SparseIndexMap<span style="color:#f92672">();</span>
   SparseIndexMap oldToPatchedIndexMap <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SparseIndexMap<span style="color:#f92672">();</span>
   SparseIndexMap newToPatchedIndexMap <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SparseIndexMap<span style="color:#f92672">();</span>
   SparseIndexMap selfIndexMapForSkip <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SparseIndexMap<span style="color:#f92672">();</span>

<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">stringDataSectionDiffAlg</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringDataSectionDiffAlgorithm<span style="color:#f92672">(</span>
     oldDex<span style="color:#f92672">,</span> newDex<span style="color:#f92672">,</span>
     oldToNewIndexMap<span style="color:#f92672">,</span>
     oldToPatchedIndexMap<span style="color:#f92672">,</span>
     newToPatchedIndexMap<span style="color:#f92672">,</span>
     selfIndexMapForSkip
 <span style="color:#f92672">);</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">typeIdSectionDiffAlg</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> TypeIdSectionDiffAlgorithm<span style="color:#f92672">(</span>
     oldDex<span style="color:#f92672">,</span> newDex<span style="color:#f92672">,</span>
     oldToNewIndexMap<span style="color:#f92672">,</span>
     oldToPatchedIndexMap<span style="color:#f92672">,</span>
     newToPatchedIndexMap<span style="color:#f92672">,</span>
     selfIndexMapForSkip
 <span style="color:#f92672">);</span>
</code></pre></div><h4 id="executeandsaveto">executeAndSaveTo</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">executeAndSaveTo</span><span style="color:#f92672">(</span>File file<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
   OutputStream os <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
   <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
     os <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span>file<span style="color:#f92672">));</span>
     executeAndSaveTo<span style="color:#f92672">(</span>os<span style="color:#f92672">);</span>
   <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
     StreamUtil<span style="color:#f92672">.</span><span style="color:#a6e22e">closeQuietly</span><span style="color:#f92672">(</span>os<span style="color:#f92672">);</span>
   <span style="color:#f92672">}</span>
 <span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">executeAndSaveTo</span><span style="color:#f92672">(</span>OutputStream out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
   <span style="color:#75715e">// Firstly, collect information of items we want to remove additionally
</span><span style="color:#75715e"></span>   <span style="color:#75715e">// in new dex and set them to corresponding diff algorithm implementations.
</span><span style="color:#75715e"></span>
<span style="color:#75715e">//首先移除需要ignore变更的class，如loader包中的，SampleApplication和BaseBuildInfo，这些类的差异无法通过tinker修复
</span><span style="color:#75715e"></span><span style="color:#f92672">......</span>

<span style="color:#f92672">((</span>ClassDefSectionDiffAlgorithm<span style="color:#f92672">)</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">classDefSectionDiffAlg</span><span style="color:#f92672">)</span>
     <span style="color:#f92672">.</span><span style="color:#a6e22e">setTypeIdOfClassDefsToRemove</span><span style="color:#f92672">(</span>typeIdOfClassDefsToRemove<span style="color:#f92672">);</span>
 <span style="color:#f92672">((</span>ClassDataSectionDiffAlgorithm<span style="color:#f92672">)</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">classDataSectionDiffAlg</span><span style="color:#f92672">)</span>
     <span style="color:#f92672">.</span><span style="color:#a6e22e">setOffsetOfClassDatasToRemove</span><span style="color:#f92672">(</span>offsetOfClassDatasToRemove<span style="color:#f92672">);</span>

<span style="color:#75715e">// Then, run diff algorithms according to sections&#39; dependencies.
</span><span style="color:#75715e"></span>
<span style="color:#75715e">// The diff works on each sections obey such procedure:
</span><span style="color:#75715e"></span> <span style="color:#75715e">// 1. Execute diff algorithms to calculate indices of items we need to add, del and replace.
</span><span style="color:#75715e"></span> <span style="color:#75715e">// 2. Execute patch algorithm simulation to calculate indices and offsets mappings that is
</span><span style="color:#75715e"></span> <span style="color:#75715e">// necessary to next section&#39;s diff works.
</span><span style="color:#75715e"></span>
 <span style="color:#75715e">// Immediately do the patch simulation so that we can know:
</span><span style="color:#75715e"></span> <span style="color:#75715e">// 1. Indices and offsets mapping between old dex and patched dex.
</span><span style="color:#75715e"></span> <span style="color:#75715e">// 2. Indices and offsets mapping between new dex and patched dex.
</span><span style="color:#75715e"></span> <span style="color:#75715e">// These information will be used to do next diff works.
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedStringIdsOffset</span> <span style="color:#f92672">=</span> patchedHeaderOffset <span style="color:#f92672">+</span> patchedheaderSize<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">oldDex</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getTableOfContents</span><span style="color:#f92672">().</span><span style="color:#a6e22e">stringIds</span><span style="color:#f92672">.</span><span style="color:#a6e22e">isElementFourByteAligned</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedStringIdsOffset</span> <span style="color:#f92672">=</span> SizeOf<span style="color:#f92672">.</span><span style="color:#a6e22e">roundToTimesOfFour</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedStringIdsOffset</span><span style="color:#f92672">);</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">stringDataSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span><span style="color:#75715e">//执行二路归并算法,结果存储到三种(add/del/replace)map中//main
</span><span style="color:#75715e"></span><span style="color:#f92672">...</span>

<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">stringDataSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">simulatePatchOperation</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedStringDataItemsOffset</span><span style="color:#f92672">);</span><span style="color:#75715e">//main
</span><span style="color:#75715e"></span><span style="color:#f92672">......</span>

<span style="color:#75715e">// Finally, write results to patch file.
</span><span style="color:#75715e"></span> writeResultToStream<span style="color:#f92672">(</span>out<span style="color:#f92672">);</span><span style="color:#75715e">//main
</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">writeResultToStream</span><span style="color:#f92672">(</span>OutputStream os<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
DexDataBuffer buffer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DexDataBuffer<span style="color:#f92672">();</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>DexPatchFile<span style="color:#f92672">.</span><span style="color:#a6e22e">MAGIC</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeShort</span><span style="color:#f92672">(</span>DexPatchFile<span style="color:#f92672">.</span><span style="color:#a6e22e">CURRENT_VERSION</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedDexSize</span><span style="color:#f92672">);</span>
 <span style="color:#75715e">// we will return here to write firstChunkOffset later.
</span><span style="color:#75715e"></span> <span style="color:#66d9ef">int</span> posOfFirstChunkOffsetField <span style="color:#f92672">=</span> buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">position</span><span style="color:#f92672">();</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span>0<span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedStringIdsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedTypeIdsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedProtoIdsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedFieldIdsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedMethodIdsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedClassDefsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedMapListOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedTypeListsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedAnnotationSetRefListItemsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedAnnotationSetItemsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedClassDataItemsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedCodeItemsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedStringDataItemsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedDebugInfoItemsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedAnnotationItemsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedEncodedArrayItemsOffset</span><span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedAnnotationsDirectoryItemsOffset</span><span style="color:#f92672">);</span>

 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">oldDex</span><span style="color:#f92672">.</span><span style="color:#a6e22e">computeSignature</span><span style="color:#f92672">(</span><span style="color:#66d9ef">false</span><span style="color:#f92672">));</span>
 <span style="color:#66d9ef">int</span> firstChunkOffset <span style="color:#f92672">=</span> buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">position</span><span style="color:#f92672">();</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">position</span><span style="color:#f92672">(</span>posOfFirstChunkOffsetField<span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span>firstChunkOffset<span style="color:#f92672">);</span>
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">position</span><span style="color:#f92672">(</span>firstChunkOffset<span style="color:#f92672">);</span>
 
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">stringDataSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">typeIdSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">typeListSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">protoIdSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">fieldIdSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">methodIdSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">annotationSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">annotationSetSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">annotationSetRefListSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">annotationsDirectorySectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">debugInfoSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">codeSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">classDataSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">encodedArraySectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 writePatchOperations<span style="color:#f92672">(</span>buffer<span style="color:#f92672">,</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">classDefSectionDiffAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchOperationList</span><span style="color:#f92672">());</span>
 
 <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> bufferData <span style="color:#f92672">=</span> buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">array</span><span style="color:#f92672">();</span>
 os<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>bufferData<span style="color:#f92672">);</span>
 os<span style="color:#f92672">.</span><span style="color:#a6e22e">flush</span><span style="color:#f92672">();</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#f92672">&lt;</span>T <span style="color:#66d9ef">extends</span> Comparable<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;&gt;</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">writePatchOperations</span><span style="color:#f92672">(</span>
     DexDataBuffer buffer<span style="color:#f92672">,</span> List<span style="color:#f92672">&lt;</span>PatchOperation<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;&gt;</span> patchOperationList
 <span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
<span style="color:#f92672">......</span>

buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeUleb128</span><span style="color:#f92672">(</span>delOpIndexList<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">());</span>
 <span style="color:#66d9ef">int</span> lastIndex <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Integer index <span style="color:#f92672">:</span> delOpIndexList<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeSleb128</span><span style="color:#f92672">(</span>index <span style="color:#f92672">-</span> lastIndex<span style="color:#f92672">);</span>
   lastIndex <span style="color:#f92672">=</span> index<span style="color:#f92672">;</span>
 <span style="color:#f92672">}</span>
 
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeUleb128</span><span style="color:#f92672">(</span>addOpIndexList<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">());</span>
 lastIndex <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Integer index <span style="color:#f92672">:</span> addOpIndexList<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeSleb128</span><span style="color:#f92672">(</span>index <span style="color:#f92672">-</span> lastIndex<span style="color:#f92672">);</span>
   lastIndex <span style="color:#f92672">=</span> index<span style="color:#f92672">;</span>
 <span style="color:#f92672">}</span>
 
 buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeUleb128</span><span style="color:#f92672">(</span>replaceOpIndexList<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">());</span>
 lastIndex <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Integer index <span style="color:#f92672">:</span> replaceOpIndexList<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeSleb128</span><span style="color:#f92672">(</span>index <span style="color:#f92672">-</span> lastIndex<span style="color:#f92672">);</span>
   lastIndex <span style="color:#f92672">=</span> index<span style="color:#f92672">;</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>T newItem <span style="color:#f92672">:</span> newItemList<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>newItem <span style="color:#66d9ef">instanceof</span> StringData<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     buffer<span style="color:#f92672">.</span><span style="color:#a6e22e">writeStringData</span><span style="color:#f92672">((</span>StringData<span style="color:#f92672">)</span> newItem<span style="color:#f92672">);</span>
   <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span>

<span style="color:#f92672">......</span>
</code></pre></div><h3 id="dex差分合成">Dex差分合成</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">new</span> DexPatchApplier<span style="color:#f92672">(</span>oldDexFile<span style="color:#f92672">,</span> dexDiffOut<span style="color:#f92672">).</span><span style="color:#a6e22e">executeAndSaveTo</span><span style="color:#f92672">(</span>tempFullPatchedDexFile<span style="color:#f92672">);</span><span style="color:#75715e">//Dex差分合成
</span></code></pre></div><h4 id="dexsectionpatchalgorithm类设计">DexSectionPatchAlgorithm类设计</h4>
<p><img src="/img/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkergradlepluginsource.assets/dexpatch.png" alt=""></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DexPatchApplier</span><span style="color:#f92672">(</span>File oldDexIn<span style="color:#f92672">,</span> File patchFileIn<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Dex<span style="color:#f92672">(</span>oldDexIn<span style="color:#f92672">),</span> <span style="color:#66d9ef">new</span> DexPatchFile<span style="color:#f92672">(</span>patchFileIn<span style="color:#f92672">));</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DexPatchApplier</span><span style="color:#f92672">(</span>Dex oldDexIn<span style="color:#f92672">,</span> DexPatchFile patchFileIn<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">oldDex</span> <span style="color:#f92672">=</span> oldDexIn<span style="color:#f92672">;</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span> <span style="color:#f92672">=</span> patchFileIn<span style="color:#f92672">;</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedDex</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Dex<span style="color:#f92672">(</span>patchFileIn<span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedDexSize</span><span style="color:#f92672">());</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">oldToPatchedIndexMap</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SparseIndexMap<span style="color:#f92672">();</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h4 id="dexpatchapplierexecuteandsaveto">DexPatchApplier.executeAndSaveTo</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">executeAndSaveTo</span><span style="color:#f92672">(</span>File file<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
   OutputStream os <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
   <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
     os <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedOutputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileOutputStream<span style="color:#f92672">(</span>file<span style="color:#f92672">));</span>
     executeAndSaveTo<span style="color:#f92672">(</span>os<span style="color:#f92672">);</span>
   <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
     StreamUtil<span style="color:#f92672">.</span><span style="color:#a6e22e">closeQuietly</span><span style="color:#f92672">(</span>os<span style="color:#f92672">);</span>
   <span style="color:#f92672">}</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">executeAndSaveTo</span><span style="color:#f92672">(</span>OutputStream out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
   <span style="color:#75715e">// Before executing, we should check if this patch can be applied to
</span><span style="color:#75715e"></span>   <span style="color:#75715e">// old dex we passed in.
</span><span style="color:#75715e"></span>
 <span style="color:#75715e">// Firstly, set sections&#39; offset after patched, sort according to their offset so that
</span><span style="color:#75715e"></span> <span style="color:#75715e">// the dex lib of aosp can calculate section size.
</span><span style="color:#75715e"></span> TableOfContents patchedToc <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedDex</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getTableOfContents</span><span style="color:#f92672">();</span>
 
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">header</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">header</span><span style="color:#f92672">.</span><span style="color:#a6e22e">size</span> <span style="color:#f92672">=</span> 1<span style="color:#f92672">;</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">mapList</span><span style="color:#f92672">.</span><span style="color:#a6e22e">size</span> <span style="color:#f92672">=</span> 1<span style="color:#f92672">;</span>
 
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">stringIds</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedStringIdSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">typeIds</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedTypeIdSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">typeLists</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedTypeListSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">protoIds</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedProtoIdSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">fieldIds</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedFieldIdSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">methodIds</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedMethodIdSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">classDefs</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedClassDefSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">mapList</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedMapListSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">stringDatas</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedStringDataSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">annotations</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedAnnotationSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">annotationSets</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedAnnotationSetSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">annotationSetRefLists</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedAnnotationSetRefListSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">annotationsDirectories</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedAnnotationsDirectorySectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">encodedArrays</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedEncodedArraySectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">debugInfos</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedDebugInfoSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">codes</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedCodeSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">classDatas</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedClassDataSectionOffset</span><span style="color:#f92672">();</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">fileSize</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchFile</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getPatchedDexSize</span><span style="color:#f92672">();</span>
 
 Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">sort</span><span style="color:#f92672">(</span>patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">sections</span><span style="color:#f92672">);</span>
 
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">computeSizesFromOffsets</span><span style="color:#f92672">();</span>
<span style="color:#75715e">// Secondly, run patch algorithms according to sections&#39; dependencies.
</span><span style="color:#75715e"></span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">stringDataSectionPatchAlg</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringDataSectionPatchAlgorithm<span style="color:#f92672">(</span>patchFile<span style="color:#f92672">,</span> oldDex<span style="color:#f92672">,</span> patchedDex<span style="color:#f92672">,</span> oldToPatchedIndexMap<span style="color:#f92672">);</span>
<span style="color:#f92672">....</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">stringDataSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">typeIdSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">typeListSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">protoIdSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">fieldIdSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">methodIdSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">annotationSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">annotationSetSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">annotationSetRefListSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">annotationsDirectorySectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">debugInfoSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">codeSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">classDataSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">encodedArraySectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>
 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">classDefSectionPatchAlg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">();</span>

<span style="color:#75715e">// Thirdly, write header, mapList. Calculate and write patched dex&#39;s sign and checksum.
</span><span style="color:#75715e"></span> Dex<span style="color:#f92672">.</span><span style="color:#a6e22e">Section</span> headerOut <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedDex</span><span style="color:#f92672">.</span><span style="color:#a6e22e">openSection</span><span style="color:#f92672">(</span>patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">header</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span><span style="color:#f92672">);</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">writeHeader</span><span style="color:#f92672">(</span>headerOut<span style="color:#f92672">);</span>

 Dex<span style="color:#f92672">.</span><span style="color:#a6e22e">Section</span> mapListOut <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedDex</span><span style="color:#f92672">.</span><span style="color:#a6e22e">openSection</span><span style="color:#f92672">(</span>patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">mapList</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span><span style="color:#f92672">);</span>
 patchedToc<span style="color:#f92672">.</span><span style="color:#a6e22e">writeMap</span><span style="color:#f92672">(</span>mapListOut<span style="color:#f92672">);</span>

 <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedDex</span><span style="color:#f92672">.</span><span style="color:#a6e22e">writeHashes</span><span style="color:#f92672">();</span>

 <span style="color:#75715e">// Finally, write patched dex to file.
</span><span style="color:#75715e"></span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedDex</span><span style="color:#f92672">.</span><span style="color:#a6e22e">writeTo</span><span style="color:#f92672">(</span>out<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><h4 id="dexpatchfile">DexPatchFile</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DexPatchFile</span><span style="color:#f92672">(</span>File file<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DexDataBuffer<span style="color:#f92672">(</span>ByteBuffer<span style="color:#f92672">.</span><span style="color:#a6e22e">wrap</span><span style="color:#f92672">(</span>FileUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">readFile</span><span style="color:#f92672">(</span>file<span style="color:#f92672">)));</span>
   init<span style="color:#f92672">();</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">init</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> magic <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readByteArray</span><span style="color:#f92672">(</span>MAGIC<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">);</span>
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>CompareUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">uArrCompare</span><span style="color:#f92672">(</span>magic<span style="color:#f92672">,</span> MAGIC<span style="color:#f92672">)</span> <span style="color:#f92672">!=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalStateException<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;bad dex patch file magic: &#34;</span> <span style="color:#f92672">+</span> Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span>magic<span style="color:#f92672">));</span>
   <span style="color:#f92672">}</span>

   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">version</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readShort</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>CompareUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">uCompare</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">version</span><span style="color:#f92672">,</span> CURRENT_VERSION<span style="color:#f92672">)</span> <span style="color:#f92672">!=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalStateException<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;bad dex patch file version: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">version</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, expected: &#34;</span> <span style="color:#f92672">+</span> CURRENT_VERSION<span style="color:#f92672">);</span>
   <span style="color:#f92672">}</span>

   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedDexSize</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">firstChunkOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedStringIdSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedTypeIdSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedProtoIdSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedFieldIdSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedMethodIdSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedClassDefSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedMapListSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedTypeListSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedAnnotationSetRefListSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedAnnotationSetSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedClassDataSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedCodeSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedStringDataSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedDebugInfoSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedAnnotationSectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedEncodedArraySectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">patchedAnnotationsDirectorySectionOffset</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">oldDexSignature</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readByteArray</span><span style="color:#f92672">(</span>SizeOf<span style="color:#f92672">.</span><span style="color:#a6e22e">SIGNATURE</span><span style="color:#f92672">);</span>

   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">buffer</span><span style="color:#f92672">.</span><span style="color:#a6e22e">position</span><span style="color:#f92672">(</span>firstChunkOffset<span style="color:#f92672">);</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">public</span> DexDataBuffer <span style="color:#a6e22e">getBuffer</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">return</span> buffer<span style="color:#f92672">;</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h3 id="checkdexchange">checkDexChange</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">checkDexChange<span style="color:#f92672">(</span>origNewDex<span style="color:#f92672">,</span> patchedNewDex<span style="color:#f92672">);</span><span style="color:#75715e">//检查是否patchedNewDex(打完补丁的new dex)和原本的newDex在逻辑上保持一致
</span></code></pre></div><h3 id="addtestdex">addTestDex</h3>
<p>tinker-build/tinker-patch-lib/src/main/resources/test.dex代码中固定的文件通过getResourceAsStream复制到当前patch的输出目录mTempResultDir</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">addTestDex</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
    <span style="color:#75715e">//write test dex
</span><span style="color:#75715e"></span>    String dexMode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jar&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>config<span style="color:#f92672">.</span><span style="color:#a6e22e">mDexRaw</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        dexMode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;raw&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">final</span> InputStream is <span style="color:#f92672">=</span> DexDiffDecoder<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getResourceAsStream</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> TEST_DEX_NAME<span style="color:#f92672">);</span>
    String md5 <span style="color:#f92672">=</span> MD5<span style="color:#f92672">.</span><span style="color:#a6e22e">getMD5</span><span style="color:#f92672">(</span>is<span style="color:#f92672">,</span> 1024<span style="color:#f92672">);</span>
    is<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>

    String meta <span style="color:#f92672">=</span> TEST_DEX_NAME <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;,&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;,&#34;</span> <span style="color:#f92672">+</span> md5 <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;,&#34;</span> <span style="color:#f92672">+</span> md5 <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;,&#34;</span> <span style="color:#f92672">+</span> 0 <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;,&#34;</span> <span style="color:#f92672">+</span> 0 <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;,&#34;</span> <span style="color:#f92672">+</span> 0 <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;,&#34;</span> <span style="color:#f92672">+</span> dexMode<span style="color:#f92672">;</span>

    File dest <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span>config<span style="color:#f92672">.</span><span style="color:#a6e22e">mTempResultDir</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> TEST_DEX_NAME<span style="color:#f92672">);</span>
    FileOperation<span style="color:#f92672">.</span><span style="color:#a6e22e">copyResourceUsingStream</span><span style="color:#f92672">(</span>TEST_DEX_NAME<span style="color:#f92672">,</span> dest<span style="color:#f92672">);</span>
    Logger<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\nAdd test install result dex: %s, size:%d&#34;</span><span style="color:#f92672">,</span> dest<span style="color:#f92672">.</span><span style="color:#a6e22e">getAbsolutePath</span><span style="color:#f92672">(),</span> dest<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">());</span>
    Logger<span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;DexDecoder:write test dex meta file data: %s&#34;</span><span style="color:#f92672">,</span> meta<span style="color:#f92672">);</span>

    metaWriter<span style="color:#f92672">.</span><span style="color:#a6e22e">writeLineToInfoFile</span><span style="color:#f92672">(</span>meta<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="patchbuilderbuildpatch">PatchBuilder.buildPatch</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">buildPatch</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">final</span> File resultDir <span style="color:#f92672">=</span> config<span style="color:#f92672">.</span><span style="color:#a6e22e">mTempResultDir</span><span style="color:#f92672">;</span>
   generateUnsignedApk<span style="color:#f92672">(</span>unSignedApk<span style="color:#f92672">);</span><span style="color:#75715e">//将tinker_result文件夹下的内容打包到patch apk
</span><span style="color:#75715e"></span>   signApk<span style="color:#f92672">(</span>unSignedApk<span style="color:#f92672">,</span> signedApk<span style="color:#f92672">);</span>执行jarsigner命令进行sign
   <span style="color:#a6e22e">use7zApk</span><span style="color:#f92672">(</span>signedApk<span style="color:#f92672">,</span> signedWith7ZipApk<span style="color:#f92672">,</span> sevenZipOutPutDir<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="dex解析">Dex解析</h2>
<p>aosp-dexutils-1.9.14.jar中包含dex字节码的处理库如Code类</p>
<h3 id="dex">Dex</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> \* Creates a new dex buffer from the dex file {@code file}.
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Dex</span><span style="color:#f92672">(</span>File file<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
 <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>file<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">().</span><span style="color:#a6e22e">endsWith</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;.dex&#34;</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
   InputStream in <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
   <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
     in <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedInputStream<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FileInputStream<span style="color:#f92672">(</span>file<span style="color:#f92672">));</span>
     loadFrom<span style="color:#f92672">(</span>in<span style="color:#f92672">,</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span><span style="color:#f92672">)</span> file<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">());</span>
   <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DexException<span style="color:#f92672">(</span>e<span style="color:#f92672">);</span>
   <span style="color:#f92672">}</span>
 <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loadFrom</span><span style="color:#f92672">(</span>InputStream in<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> initSize<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> rawData <span style="color:#f92672">=</span> FileUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">readStream</span><span style="color:#f92672">(</span>in<span style="color:#f92672">,</span> initSize<span style="color:#f92672">);</span><span style="color:#75715e">//rawData表示dex文件的byte数组
</span><span style="color:#75715e"></span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> ByteBuffer<span style="color:#f92672">.</span><span style="color:#a6e22e">wrap</span><span style="color:#f92672">(</span>rawData<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">data</span><span style="color:#f92672">.</span><span style="color:#a6e22e">order</span><span style="color:#f92672">(</span>ByteOrder<span style="color:#f92672">.</span><span style="color:#a6e22e">LITTLE_ENDIAN</span><span style="color:#f92672">);</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">tableOfContents</span><span style="color:#f92672">.</span><span style="color:#a6e22e">readFrom</span><span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">);</span><span style="color:#75715e">//main
</span><span style="color:#75715e"></span> <span style="color:#f92672">}</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">writeTo</span><span style="color:#f92672">(</span>OutputStream out<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> rawData <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span><span style="color:#a6e22e">array</span><span style="color:#f92672">();</span>
   out<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>rawData<span style="color:#f92672">);</span>
   out<span style="color:#f92672">.</span><span style="color:#a6e22e">flush</span><span style="color:#f92672">();</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h3 id="tableofcontents">TableOfContents</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> \* The file header and map.
</span><span style="color:#75715e"> */</span>

TableOfContents <span style="color:#f92672">{</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section header <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_HEADER<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span><span style="color:#75715e">//无Algorithm对应
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section stringIds <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_STRINGIDS<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span><span style="color:#75715e">//ref StringDataSectionDiffAlgorithm
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section typeIds <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_TYPEIDS<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span><span style="color:#75715e">//ref TypeIdSectionDiffAlgorithm
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section protoIds <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_PROTOIDS<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span><span style="color:#75715e">//ref ProtoIdSectionDiffAlgorithm
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section fieldIds <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_FIELDIDS<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span><span style="color:#75715e">//ref FieldIdSectionDiffAlgorithm
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section methodIds <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_METHODIDS<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span><span style="color:#75715e">//ref MethodIdSectionDiffAlgorithm
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section classDefs <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_CLASSDEFS<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span><span style="color:#75715e">//ref ClassDefSectionDiffAlgorithm
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section mapList <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_MAPLIST<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span><span style="color:#75715e">//无Algorithm对应
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section typeLists <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_TYPELISTS<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span><span style="color:#75715e">//TypeListSectionDiffAlgorithm
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section annotationSetRefLists <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_ANNOTATIONSETREFLISTS<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span><span style="color:#75715e">//ref ...
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section annotationSets <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_ANNOTATIONSETS<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>ref<span style="color:#f92672">...</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section classDatas <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_CLASSDATA<span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>ref<span style="color:#f92672">...</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section codes <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_CODES<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>ref<span style="color:#f92672">...</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section stringDatas <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_STRINGDATAS<span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>ref<span style="color:#f92672">...</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section debugInfos <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_DEBUGINFOS<span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>ref<span style="color:#f92672">...</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section annotations <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_ANNOTATIONS<span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>ref<span style="color:#f92672">...</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section encodedArrays <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_ENCODEDARRAYS<span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span><span style="color:#75715e">//无Algorithm对应
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section annotationsDirectories <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span>SECTION_TYPE_ANNOTATIONSDIRECTORIES<span style="color:#f92672">,</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>ref<span style="color:#f92672">...</span>

<span style="color:#75715e">//18个section，对应map size = 18,其中15个都一一对应一个SectionDiffAlgorithm类进行差分，在Algorithm子类的getTocSection方法中返回对应的Section
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Section<span style="color:#f92672">[]</span> sections <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
     header<span style="color:#f92672">,</span> stringIds<span style="color:#f92672">,</span> typeIds<span style="color:#f92672">,</span> protoIds<span style="color:#f92672">,</span> fieldIds<span style="color:#f92672">,</span> methodIds<span style="color:#f92672">,</span> classDefs<span style="color:#f92672">,</span> mapList<span style="color:#f92672">,</span>
     typeLists<span style="color:#f92672">,</span> annotationSetRefLists<span style="color:#f92672">,</span> annotationSets<span style="color:#f92672">,</span> classDatas<span style="color:#f92672">,</span> codes<span style="color:#f92672">,</span> stringDatas<span style="color:#f92672">,</span>
     debugInfos<span style="color:#f92672">,</span> annotations<span style="color:#f92672">,</span> encodedArrays<span style="color:#f92672">,</span> annotationsDirectories
 <span style="color:#f92672">};</span>

 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> checksum<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> signature<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> fileSize<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> linkSize<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> linkOff<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> dataSize<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> dataOff<span style="color:#f92672">;</span>

<span style="color:#f92672">}</span>
</code></pre></div><h4 id="readfromdex">readFromDex</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">readFrom</span><span style="color:#f92672">(</span>Dex dex<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
   readHeader<span style="color:#f92672">(</span>dex<span style="color:#f92672">.</span><span style="color:#a6e22e">openSection</span><span style="color:#f92672">(</span>header<span style="color:#f92672">));</span>
   <span style="color:#75715e">// special case, since mapList.byteCount is available only after
</span><span style="color:#75715e"></span>   <span style="color:#75715e">// computeSizesFromOffsets() was invoked, so here we can&#39;t use
</span><span style="color:#75715e"></span>   <span style="color:#75715e">// dex.openSection(mapList) to get dex section. Or
</span><span style="color:#75715e"></span>   <span style="color:#75715e">// an {@code java.nio.BufferUnderflowException} will be thrown.
</span><span style="color:#75715e"></span>   readMap<span style="color:#f92672">(</span>dex<span style="color:#f92672">.</span><span style="color:#a6e22e">openSection</span><span style="color:#f92672">(</span>mapList<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span><span style="color:#f92672">));</span>
   computeSizesFromOffsets<span style="color:#f92672">();</span>
 <span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">//Dex
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> Section <span style="color:#a6e22e">openSection</span><span style="color:#f92672">(</span>TableOfContents<span style="color:#f92672">.</span><span style="color:#a6e22e">Section</span> tocSec<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">int</span> position <span style="color:#f92672">=</span> tocSec<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span><span style="color:#f92672">;</span>
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>position <span style="color:#f92672">&lt;</span> 0 <span style="color:#f92672">||</span> position <span style="color:#f92672">&gt;=</span> data<span style="color:#f92672">.</span><span style="color:#a6e22e">capacity</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException<span style="color:#f92672">(</span>
         <span style="color:#e6db74">&#34;position=&#34;</span> <span style="color:#f92672">+</span> position <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; length=&#34;</span> <span style="color:#f92672">+</span> data<span style="color:#f92672">.</span><span style="color:#a6e22e">capacity</span><span style="color:#f92672">()</span>
     <span style="color:#f92672">);</span>
   <span style="color:#f92672">}</span>
   ByteBuffer sectionData <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span><span style="color:#a6e22e">duplicate</span><span style="color:#f92672">();</span>
   sectionData<span style="color:#f92672">.</span><span style="color:#a6e22e">order</span><span style="color:#f92672">(</span>ByteOrder<span style="color:#f92672">.</span><span style="color:#a6e22e">LITTLE_ENDIAN</span><span style="color:#f92672">);</span> <span style="color:#75715e">// necessary?
</span><span style="color:#75715e"></span>   sectionData<span style="color:#f92672">.</span><span style="color:#a6e22e">position</span><span style="color:#f92672">(</span>position<span style="color:#f92672">);</span><span style="color:#75715e">//设定指定section的起始地址position和大小byteCount
</span><span style="color:#75715e"></span>
   sectionData<span style="color:#f92672">.</span><span style="color:#a6e22e">limit</span><span style="color:#f92672">(</span>position <span style="color:#f92672">+</span> tocSec<span style="color:#f92672">.</span><span style="color:#a6e22e">byteCount</span><span style="color:#f92672">);</span>
   <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Section<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;section&#34;</span><span style="color:#f92672">,</span> sectionData<span style="color:#f92672">);</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h5 id="readheader">readHeader</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">readHeader</span><span style="color:#f92672">(</span>Dex<span style="color:#f92672">.</span><span style="color:#a6e22e">Section</span> headerIn<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> UnsupportedEncodingException <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> magic <span style="color:#f92672">=</span> headerIn<span style="color:#f92672">.</span><span style="color:#a6e22e">readByteArray</span><span style="color:#f92672">(</span>8<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">int</span> apiTarget <span style="color:#f92672">=</span> DexFormat<span style="color:#f92672">.</span><span style="color:#a6e22e">magicToApi</span><span style="color:#f92672">(</span>magic<span style="color:#f92672">);</span>
 
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>apiTarget <span style="color:#f92672">!=</span> DexFormat<span style="color:#f92672">.</span><span style="color:#a6e22e">API_NO_EXTENDED_OPCODES</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DexException<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Unexpected magic: &#34;</span> <span style="color:#f92672">+</span> Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span>magic<span style="color:#f92672">));</span>
   <span style="color:#f92672">}</span>
 
   checksum <span style="color:#f92672">=</span> headerIn<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   signature <span style="color:#f92672">=</span> headerIn<span style="color:#f92672">.</span><span style="color:#a6e22e">readByteArray</span><span style="color:#f92672">(</span>20<span style="color:#f92672">);</span>
   fileSize <span style="color:#f92672">=</span> headerIn<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>

<span style="color:#f92672">......</span>
 stringIds<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span> <span style="color:#f92672">=</span> headerIn<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
 stringIds<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> headerIn<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
 typeIds<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span> <span style="color:#f92672">=</span> headerIn<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
 typeIds<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> headerIn<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
 protoIds<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span> <span style="color:#f92672">=</span> headerIn<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
 protoIds<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> headerIn<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
<span style="color:#f92672">......</span>
 dataSize <span style="color:#f92672">=</span> headerIn<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
 dataOff <span style="color:#f92672">=</span> headerIn<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
</code></pre></div><h5 id="readmap">readMap</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">readMap</span><span style="color:#f92672">(</span>Dex<span style="color:#f92672">.</span><span style="color:#a6e22e">Section</span> in<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> IOException <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">int</span> mapSize <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
   Section previous <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
   <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> mapSize<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">short</span> type <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">readShort</span><span style="color:#f92672">();</span>
     in<span style="color:#f92672">.</span><span style="color:#a6e22e">readShort</span><span style="color:#f92672">();</span> <span style="color:#75715e">// unused
</span><span style="color:#75715e"></span>     Section section <span style="color:#f92672">=</span> getSection<span style="color:#f92672">(</span>type<span style="color:#f92672">);</span>
     <span style="color:#66d9ef">int</span> size <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
     <span style="color:#66d9ef">int</span> offset <span style="color:#f92672">=</span> in<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span>
     <span style="color:#66d9ef">if</span> <span style="color:#f92672">((</span>section<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span> <span style="color:#f92672">!=</span> 0 <span style="color:#f92672">&amp;&amp;</span> section<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span> <span style="color:#f92672">!=</span> size<span style="color:#f92672">)</span>
         <span style="color:#f92672">||</span> <span style="color:#f92672">(</span>section<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">!=</span> Section<span style="color:#f92672">.</span><span style="color:#a6e22e">UNDEF_OFFSET</span> <span style="color:#f92672">&amp;&amp;</span> section<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">!=</span> offset<span style="color:#f92672">))</span> <span style="color:#f92672">{</span><span style="color:#75715e">//末尾map中的size和offset应该和header中的size,offset一致
</span><span style="color:#75715e"></span>       <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DexException<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Unexpected map value for 0x&#34;</span> <span style="color:#f92672">+</span> Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">toHexString</span><span style="color:#f92672">(</span>type<span style="color:#f92672">));</span>
     <span style="color:#f92672">}</span>
     section<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span> <span style="color:#f92672">=</span> size<span style="color:#f92672">;</span>
     section<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> offset<span style="color:#f92672">;</span>

     <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>previous <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;&amp;</span> previous<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">&gt;</span> section<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
       <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DexException<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Map is unsorted at &#34;</span> <span style="color:#f92672">+</span> previous <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, &#34;</span> <span style="color:#f92672">+</span> section<span style="color:#f92672">);</span>
     <span style="color:#f92672">}</span>
     previous <span style="color:#f92672">=</span> section<span style="color:#f92672">;</span>
   <span style="color:#f92672">}</span>

   header<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
   Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">sort</span><span style="color:#f92672">(</span>sections<span style="color:#f92672">);</span>
   <span style="color:#75715e">// Skip header section, since its offset must be zero.
</span><span style="color:#75715e"></span>   <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 1<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> sections<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> <span style="color:#f92672">++</span>i<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>sections<span style="color:#f92672">[</span>i<span style="color:#f92672">].</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">==</span> Section<span style="color:#f92672">.</span><span style="color:#a6e22e">UNDEF_OFFSET</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
       sections<span style="color:#f92672">[</span>i<span style="color:#f92672">].</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> sections<span style="color:#f92672">[</span>i <span style="color:#f92672">-</span> 1<span style="color:#f92672">].</span><span style="color:#a6e22e">off</span><span style="color:#f92672">;</span>
     <span style="color:#f92672">}</span>
   <span style="color:#f92672">}</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h5 id="computesizesfromoffsets">computeSizesFromOffsets</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">computeSizesFromOffsets</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">int</span> end <span style="color:#f92672">=</span> fileSize<span style="color:#f92672">;</span>
   <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> sections<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> 1<span style="color:#f92672">;</span> i <span style="color:#f92672">&gt;=</span> 0<span style="color:#f92672">;</span> i<span style="color:#f92672">--)</span> <span style="color:#f92672">{</span><span style="color:#75715e">//18个Section反向迭代，计算出每个Section的byteCount
</span><span style="color:#75715e"></span>
     Section section <span style="color:#f92672">=</span> sections<span style="color:#f92672">[</span>i<span style="color:#f92672">];</span>
     <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>section<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">==</span> Section<span style="color:#f92672">.</span><span style="color:#a6e22e">UNDEF_OFFSET</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
       <span style="color:#66d9ef">continue</span><span style="color:#f92672">;</span>
     <span style="color:#f92672">}</span>
     <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>section<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">&gt;</span> end<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
       <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DexException<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Map is unsorted at &#34;</span> <span style="color:#f92672">+</span> section<span style="color:#f92672">);</span>
     <span style="color:#f92672">}</span>
     section<span style="color:#f92672">.</span><span style="color:#a6e22e">byteCount</span> <span style="color:#f92672">=</span> end <span style="color:#f92672">-</span> section<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span><span style="color:#f92672">;</span>
     end <span style="color:#f92672">=</span> section<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span><span style="color:#f92672">;</span>
   <span style="color:#f92672">}</span>
 
   dataOff <span style="color:#f92672">=</span> header<span style="color:#f92672">.</span><span style="color:#a6e22e">byteCount</span>
       <span style="color:#960050;background-color:#1e0010">\</span><span style="color:#f92672">+</span> stringIds<span style="color:#f92672">.</span><span style="color:#a6e22e">byteCount</span>
       <span style="color:#960050;background-color:#1e0010">\</span><span style="color:#f92672">+</span> typeIds<span style="color:#f92672">.</span><span style="color:#a6e22e">byteCount</span>
       <span style="color:#960050;background-color:#1e0010">\</span><span style="color:#f92672">+</span> protoIds<span style="color:#f92672">.</span><span style="color:#a6e22e">byteCount</span>
       <span style="color:#960050;background-color:#1e0010">\</span><span style="color:#f92672">+</span> fieldIds<span style="color:#f92672">.</span><span style="color:#a6e22e">byteCount</span>
       <span style="color:#960050;background-color:#1e0010">\</span><span style="color:#f92672">+</span> methodIds<span style="color:#f92672">.</span><span style="color:#a6e22e">byteCount</span>
       <span style="color:#960050;background-color:#1e0010">\</span><span style="color:#f92672">+</span> classDefs<span style="color:#f92672">.</span><span style="color:#a6e22e">byteCount</span><span style="color:#f92672">;</span>
 
   dataSize <span style="color:#f92672">=</span> fileSize <span style="color:#f92672">-</span> dataOff<span style="color:#f92672">;</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h3 id="tableofcontentssection">TableOfContents.Section</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Section</span> <span style="color:#66d9ef">implements</span> Comparable<span style="color:#f92672">&lt;</span>Section<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">short</span> type<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> isElementFourByteAligned<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> size <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span><span style="color:#75715e">//数组大小
</span><span style="color:#75715e"></span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> off <span style="color:#f92672">=</span> UNDEF_OFFSET<span style="color:#f92672">;</span><span style="color:#75715e">//起始地址
</span><span style="color:#75715e"></span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> byteCount <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span><span style="color:#75715e">//整个Section所占区域大小
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Section</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> type<span style="color:#f92672">,</span> <span style="color:#66d9ef">boolean</span> isElementFourByteAligned<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">type</span> <span style="color:#f92672">=</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">short</span><span style="color:#f92672">)</span> type<span style="color:#f92672">;</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">isElementFourByteAligned</span> <span style="color:#f92672">=</span> isElementFourByteAligned<span style="color:#f92672">;</span>
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>type <span style="color:#f92672">==</span> SECTION_TYPE_HEADER<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     off <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
     size <span style="color:#f92672">=</span> 1<span style="color:#f92672">;</span>
     byteCount <span style="color:#f92672">=</span> SizeOf<span style="color:#f92672">.</span><span style="color:#a6e22e">HEADER_ITEM</span><span style="color:#f92672">;</span>
   <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span>
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>type <span style="color:#f92672">==</span> SECTION_TYPE_MAPLIST<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     size <span style="color:#f92672">=</span> 1<span style="color:#f92672">;</span>
   <span style="color:#f92672">}</span>
 <span style="color:#f92672">}</span>

  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Item</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">implements</span> Comparable<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> off<span style="color:#f92672">;</span>
 
     <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Item</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> off<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
       <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">off</span> <span style="color:#f92672">=</span> off<span style="color:#f92672">;</span>
     <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="dexsection">Dex.Section</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Section</span> <span style="color:#66d9ef">extends</span> DexDataBuffer <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> String name<span style="color:#f92672">;</span>

   <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">Section</span><span style="color:#f92672">(</span>String name<span style="color:#f92672">,</span> ByteBuffer data<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">super</span><span style="color:#f92672">(</span>data<span style="color:#f92672">);</span>
     <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> name<span style="color:#f92672">;</span>
   <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DexDataBuffer</span> <span style="color:#f92672">{</span>
  <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DexDataBuffer</span><span style="color:#f92672">(</span>ByteBuffer data<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> data<span style="color:#f92672">;</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">data</span><span style="color:#f92672">.</span><span style="color:#a6e22e">order</span><span style="color:#f92672">(</span>ByteOrder<span style="color:#f92672">.</span><span style="color:#a6e22e">LITTLE_ENDIAN</span><span style="color:#f92672">);</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">dataBound</span> <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span><span style="color:#a6e22e">limit</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">isResizeAllowed</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
 <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="abstractindexmapadjustcode">AbstractIndexMap.adjust(Code)</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> Code <span style="color:#a6e22e">adjust</span><span style="color:#f92672">(</span>Code code<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">int</span> adjustedDebugInfoOffset <span style="color:#f92672">=</span> adjustDebugInfoItemOffset<span style="color:#f92672">(</span>code<span style="color:#f92672">.</span><span style="color:#a6e22e">debugInfoOffset</span><span style="color:#f92672">);</span>
   <span style="color:#66d9ef">short</span><span style="color:#f92672">[]</span> adjustedInstructions <span style="color:#f92672">=</span> adjustInstructions<span style="color:#f92672">(</span>code<span style="color:#f92672">.</span><span style="color:#a6e22e">instructions</span><span style="color:#f92672">);</span><span style="color:#75715e">//main
</span><span style="color:#75715e"></span>   Code<span style="color:#f92672">.</span><span style="color:#a6e22e">CatchHandler</span><span style="color:#f92672">[]</span> adjustedCatchHandlers <span style="color:#f92672">=</span> adjustCatchHandlers<span style="color:#f92672">(</span>code<span style="color:#f92672">.</span><span style="color:#a6e22e">catchHandlers</span><span style="color:#f92672">);</span>
   <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Code<span style="color:#f92672">(</span>
       code<span style="color:#f92672">.</span><span style="color:#a6e22e">off</span><span style="color:#f92672">,</span> code<span style="color:#f92672">.</span><span style="color:#a6e22e">registersSize</span><span style="color:#f92672">,</span> code<span style="color:#f92672">.</span><span style="color:#a6e22e">insSize</span><span style="color:#f92672">,</span> code<span style="color:#f92672">.</span><span style="color:#a6e22e">outsSize</span><span style="color:#f92672">,</span>
       adjustedDebugInfoOffset<span style="color:#f92672">,</span> adjustedInstructions<span style="color:#f92672">,</span> code<span style="color:#f92672">.</span><span style="color:#a6e22e">tries</span><span style="color:#f92672">,</span> adjustedCatchHandlers
   <span style="color:#f92672">);</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">short</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">adjustInstructions</span><span style="color:#f92672">(</span><span style="color:#66d9ef">short</span><span style="color:#f92672">[]</span> instructions<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>instructions <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">||</span> instructions<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span> <span style="color:#f92672">==</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">return</span> instructions<span style="color:#f92672">;</span>
   <span style="color:#f92672">}</span>
   InstructionTransformer insTrans <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> InstructionTransformer<span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">);</span>
   <span style="color:#66d9ef">return</span> insTrans<span style="color:#f92672">.</span><span style="color:#a6e22e">transform</span><span style="color:#f92672">(</span>instructions<span style="color:#f92672">);</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h3 id="instructiontransformer">InstructionTransformer</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">short</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">transform</span><span style="color:#f92672">(</span><span style="color:#66d9ef">short</span><span style="color:#f92672">[]</span> encodedInstructions<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> DexException <span style="color:#f92672">{</span>
   ShortArrayCodeOutput out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ShortArrayCodeOutput<span style="color:#f92672">(</span>encodedInstructions<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">);</span><span style="color:#75715e">//因为每个指令的长度是u1 也就是0~255
</span><span style="color:#75715e"></span>
  InstructionPromoter ipmo <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> InstructionPromoter<span style="color:#f92672">();</span><span style="color:#75715e">//地址转换，应对类似const-string 到const-string/jumbo的地址扩展情况
</span><span style="color:#75715e"></span>
  InstructionWriter iw <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> InstructionWriter<span style="color:#f92672">(</span>out<span style="color:#f92672">,</span> ipmo<span style="color:#f92672">);</span>
   InstructionReader ir <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> InstructionReader<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> ShortArrayCodeInput<span style="color:#f92672">(</span>encodedInstructions<span style="color:#f92672">));</span>
 
   <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
     <span style="color:#75715e">// First visit, we collect mappings from original target address to promoted target address.
</span><span style="color:#75715e"></span>     ir<span style="color:#f92672">.</span><span style="color:#a6e22e">accept</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> InstructionTransformVisitor<span style="color:#f92672">(</span>ipmo<span style="color:#f92672">));</span><span style="color:#75715e">//main
</span><span style="color:#75715e"></span> 
     <span style="color:#75715e">// Then do the real transformation work.
</span><span style="color:#75715e"></span>     ir<span style="color:#f92672">.</span><span style="color:#a6e22e">accept</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> InstructionTransformVisitor<span style="color:#f92672">(</span>iw<span style="color:#f92672">));</span><span style="color:#75715e">//main
</span><span style="color:#75715e"></span>   <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>EOFException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DexException<span style="color:#f92672">(</span>e<span style="color:#f92672">);</span>
   <span style="color:#f92672">}</span>
 
   <span style="color:#66d9ef">return</span> out<span style="color:#f92672">.</span><span style="color:#a6e22e">getArray</span><span style="color:#f92672">();</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h3 id="instructionreader被访问者">InstructionReader(被访问者)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> ShortArrayCodeInput codeIn<span style="color:#f92672">;</span>

 <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">InstructionReader</span><span style="color:#f92672">(</span>ShortArrayCodeInput in<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">codeIn</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">;</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">accept</span><span style="color:#f92672">(</span>InstructionVisitor iv<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> EOFException <span style="color:#f92672">{</span>
   codeIn<span style="color:#f92672">.</span><span style="color:#a6e22e">reset</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>codeIn<span style="color:#f92672">.</span><span style="color:#a6e22e">hasMore</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">int</span> currentAddress <span style="color:#f92672">=</span> codeIn<span style="color:#f92672">.</span><span style="color:#a6e22e">cursor</span><span style="color:#f92672">();</span>
     <span style="color:#66d9ef">int</span> opcodeUnit <span style="color:#f92672">=</span> codeIn<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">();</span>
     <span style="color:#66d9ef">int</span> opcodeForSwitch <span style="color:#f92672">=</span> Opcodes<span style="color:#f92672">.</span><span style="color:#a6e22e">extractOpcodeFromUnit</span><span style="color:#f92672">(</span>opcodeUnit<span style="color:#f92672">);</span><span style="color:#75715e">//main
</span><span style="color:#75715e"></span>     <span style="color:#66d9ef">switch</span> <span style="color:#f92672">(</span>opcodeForSwitch<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
       <span style="color:#66d9ef">case</span> Opcodes<span style="color:#f92672">.</span><span style="color:#a6e22e">SPECIAL_FORMAT</span><span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
         iv<span style="color:#f92672">.</span><span style="color:#a6e22e">visitZeroRegisterInsn</span><span style="color:#f92672">(</span>currentAddress<span style="color:#f92672">,</span> opcodeUnit<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">INDEX_TYPE_NONE</span><span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> 0L<span style="color:#f92672">);</span>
         <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
       <span style="color:#f92672">}</span>
       <span style="color:#66d9ef">case</span> Opcodes<span style="color:#f92672">.</span><span style="color:#a6e22e">GOTO</span><span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
         <span style="color:#66d9ef">int</span> opcode <span style="color:#f92672">=</span> InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">byte0</span><span style="color:#f92672">(</span>opcodeUnit<span style="color:#f92672">);</span><span style="color:#75715e">//main
</span><span style="color:#75715e"></span>         <span style="color:#66d9ef">int</span> target <span style="color:#f92672">=</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">byte</span><span style="color:#f92672">)</span> InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">byte1</span><span style="color:#f92672">(</span>opcodeUnit<span style="color:#f92672">);</span> <span style="color:#75715e">// sign-extend
</span><span style="color:#75715e"></span>         iv<span style="color:#f92672">.</span><span style="color:#a6e22e">visitZeroRegisterInsn</span><span style="color:#f92672">(</span>currentAddress<span style="color:#f92672">,</span> opcode<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">INDEX_TYPE_NONE</span><span style="color:#f92672">,</span> currentAddress <span style="color:#f92672">+</span> target<span style="color:#f92672">,</span> 0L<span style="color:#f92672">);</span>
         <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
       <span style="color:#f92672">}</span>

<span style="color:#f92672">......</span>

<span style="color:#66d9ef">case</span> Opcodes<span style="color:#f92672">.</span><span style="color:#a6e22e">INVOKE_STATIC</span><span style="color:#f92672">:</span>
 <span style="color:#66d9ef">case</span> Opcodes<span style="color:#f92672">.</span><span style="color:#a6e22e">INVOKE_INTERFACE</span><span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">int</span> opcode <span style="color:#f92672">=</span> InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">byte0</span><span style="color:#f92672">(</span>opcodeUnit<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">int</span> e <span style="color:#f92672">=</span> InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">nibble2</span><span style="color:#f92672">(</span>opcodeUnit<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">int</span> registerCount <span style="color:#f92672">=</span> InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">nibble3</span><span style="color:#f92672">(</span>opcodeUnit<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">int</span> index <span style="color:#f92672">=</span> codeIn<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">int</span> abcd <span style="color:#f92672">=</span> codeIn<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">();</span>
   <span style="color:#66d9ef">int</span> a <span style="color:#f92672">=</span> InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">nibble0</span><span style="color:#f92672">(</span>abcd<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">int</span> b <span style="color:#f92672">=</span> InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">nibble1</span><span style="color:#f92672">(</span>abcd<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">int</span> c <span style="color:#f92672">=</span> InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">nibble2</span><span style="color:#f92672">(</span>abcd<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">int</span> d <span style="color:#f92672">=</span> InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">nibble3</span><span style="color:#f92672">(</span>abcd<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">int</span> indexType <span style="color:#f92672">=</span> InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstructionIndexType</span><span style="color:#f92672">(</span>opcode<span style="color:#f92672">);</span>
 
   <span style="color:#66d9ef">switch</span> <span style="color:#f92672">(</span>registerCount<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">case</span> 0<span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
       iv<span style="color:#f92672">.</span><span style="color:#a6e22e">visitZeroRegisterInsn</span><span style="color:#f92672">(</span>currentAddress<span style="color:#f92672">,</span> opcode<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span> indexType<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> 0L<span style="color:#f92672">);</span>
       <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
     <span style="color:#f92672">}</span>
     <span style="color:#66d9ef">case</span> 1<span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
       iv<span style="color:#f92672">.</span><span style="color:#a6e22e">visitOneRegisterInsn</span><span style="color:#f92672">(</span>currentAddress<span style="color:#f92672">,</span> opcode<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span> indexType<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> 0L<span style="color:#f92672">,</span> a<span style="color:#f92672">);</span>
       <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
     <span style="color:#f92672">}</span>
     <span style="color:#66d9ef">case</span> 2<span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
       iv<span style="color:#f92672">.</span><span style="color:#a6e22e">visitTwoRegisterInsn</span><span style="color:#f92672">(</span>currentAddress<span style="color:#f92672">,</span> opcode<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span> indexType<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> 0L<span style="color:#f92672">,</span> a<span style="color:#f92672">,</span> b<span style="color:#f92672">);</span>
       <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
     <span style="color:#f92672">}</span>
     <span style="color:#66d9ef">case</span> 3<span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
       iv<span style="color:#f92672">.</span><span style="color:#a6e22e">visitThreeRegisterInsn</span><span style="color:#f92672">(</span>currentAddress<span style="color:#f92672">,</span> opcode<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span> indexType<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> 0L<span style="color:#f92672">,</span> a<span style="color:#f92672">,</span> b<span style="color:#f92672">,</span> c<span style="color:#f92672">);</span>
       <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
     <span style="color:#f92672">}</span>
     <span style="color:#66d9ef">case</span> 4<span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
       iv<span style="color:#f92672">.</span><span style="color:#a6e22e">visitFourRegisterInsn</span><span style="color:#f92672">(</span>currentAddress<span style="color:#f92672">,</span> opcode<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span> indexType<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> 0L<span style="color:#f92672">,</span> a<span style="color:#f92672">,</span> b<span style="color:#f92672">,</span> c<span style="color:#f92672">,</span> d<span style="color:#f92672">);</span>
       <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
     <span style="color:#f92672">}</span>
     <span style="color:#66d9ef">case</span> 5<span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
       iv<span style="color:#f92672">.</span><span style="color:#a6e22e">visitFiveRegisterInsn</span><span style="color:#f92672">(</span>currentAddress<span style="color:#f92672">,</span> opcode<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span> indexType<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> 0L<span style="color:#f92672">,</span> a<span style="color:#f92672">,</span> b<span style="color:#f92672">,</span> c<span style="color:#f92672">,</span> d<span style="color:#f92672">,</span> e<span style="color:#f92672">);</span>
       <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
     <span style="color:#f92672">}</span>
     <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
       <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DexException<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;bogus registerCount: &#34;</span> <span style="color:#f92672">+</span> Hex<span style="color:#f92672">.</span><span style="color:#a6e22e">uNibble</span><span style="color:#f92672">(</span>registerCount<span style="color:#f92672">));</span>
     <span style="color:#f92672">}</span>
</code></pre></div><h3 id="instructionvisitor类设计">InstructionVisitor类设计</h3>
<pre><code class="language-mermaid" data-lang="mermaid">classDiagram
class InstructionVisitor {
+visitZeroRegisterInsn(int currentAddress, int opcode, int index, int indexType, int target, long literal) void
+visitOneRegisterInsn(int currentAddress, int opcode, int index, int indexType, int target, long literal, int a) void
}

InstructionVisitor&lt;|--InstructionTransformVisitor
InstructionTransformVisitor--*InstructionPromoter:delegate
InstructionVisitor&lt;|--InstructionPromoter

InstructionVisitor&lt;|--InstructionWriter
InstructionTransformVisitor--*InstructionWriter:delegate
</code></pre><h4 id="instructionvisitor">InstructionVisitor</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> InstructionVisitor prevIv<span style="color:#f92672">;</span>
 <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">InstructionVisitor</span><span style="color:#f92672">(</span>InstructionVisitor iv<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">prevIv</span> <span style="color:#f92672">=</span> iv<span style="color:#f92672">;</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visitZeroRegisterInsn</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> currentAddress<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> opcode<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> index<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> indexType<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> target<span style="color:#f92672">,</span> <span style="color:#66d9ef">long</span> literal<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>prevIv <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     prevIv<span style="color:#f92672">.</span><span style="color:#a6e22e">visitZeroRegisterInsn</span><span style="color:#f92672">(</span>currentAddress<span style="color:#f92672">,</span> opcode<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span> indexType<span style="color:#f92672">,</span> target<span style="color:#f92672">,</span> literal<span style="color:#f92672">);</span>
   <span style="color:#f92672">}</span>
 <span style="color:#f92672">}</span>

<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visitOneRegisterInsn</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> currentAddress<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> opcode<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> index<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> indexType<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> target<span style="color:#f92672">,</span> <span style="color:#66d9ef">long</span> literal<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> a<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>prevIv <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     prevIv<span style="color:#f92672">.</span><span style="color:#a6e22e">visitOneRegisterInsn</span><span style="color:#f92672">(</span>currentAddress<span style="color:#f92672">,</span> opcode<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span> indexType<span style="color:#f92672">,</span> target<span style="color:#f92672">,</span> literal<span style="color:#f92672">,</span> a<span style="color:#f92672">);</span>
   <span style="color:#f92672">}</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h4 id="instructiontransformvisitor">InstructionTransformVisitor</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Override</span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visitZeroRegisterInsn</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> currentAddress<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> opcode<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> index<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> indexType<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> target<span style="color:#f92672">,</span> <span style="color:#66d9ef">long</span> literal<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">int</span> mappedIndex <span style="color:#f92672">=</span> transformIndexIfNeeded<span style="color:#f92672">(</span>index<span style="color:#f92672">,</span> indexType<span style="color:#f92672">);</span>
   <span style="color:#66d9ef">super</span><span style="color:#f92672">.</span><span style="color:#a6e22e">visitZeroRegisterInsn</span><span style="color:#f92672">(</span>currentAddress<span style="color:#f92672">,</span> opcode<span style="color:#f92672">,</span> mappedIndex<span style="color:#f92672">,</span> indexType<span style="color:#f92672">,</span> target<span style="color:#f92672">,</span> literal<span style="color:#f92672">);</span>
 <span style="color:#f92672">}</span>

<span style="color:#a6e22e">@Override</span>
 <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visitOneRegisterInsn</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> currentAddress<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> opcode<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> index<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> indexType<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> target<span style="color:#f92672">,</span> <span style="color:#66d9ef">long</span> literal<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> a<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">int</span> mappedIndex <span style="color:#f92672">=</span> transformIndexIfNeeded<span style="color:#f92672">(</span>index<span style="color:#f92672">,</span> indexType<span style="color:#f92672">);</span><span style="color:#75715e">//这里index为old index， mappedIndex为new dex中的 index
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">super</span><span style="color:#f92672">.</span><span style="color:#a6e22e">visitOneRegisterInsn</span><span style="color:#f92672">(</span>currentAddress<span style="color:#f92672">,</span> opcode<span style="color:#f92672">,</span> mappedIndex<span style="color:#f92672">,</span> indexType<span style="color:#f92672">,</span> target<span style="color:#f92672">,</span> literal<span style="color:#f92672">,</span> a<span style="color:#f92672">);</span>
 <span style="color:#f92672">}</span>
</code></pre></div><h4 id="instructionwriter">InstructionWriter</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visitZeroRegisterInsn</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> currentAddress<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> opcode<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> index<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> indexType<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> target<span style="color:#f92672">,</span> <span style="color:#66d9ef">long</span> literal<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
<span style="color:#f92672">}</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visitOneRegisterInsn</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> currentAddress<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> opcode<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> index<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> indexType<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> target<span style="color:#f92672">,</span> <span style="color:#66d9ef">long</span> literal<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> a<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
 <span style="color:#66d9ef">switch</span> <span style="color:#f92672">(</span>opcode<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>

  <span style="color:#66d9ef">case</span> Opcodes<span style="color:#f92672">.</span><span style="color:#a6e22e">CONST_STRING</span><span style="color:#f92672">:</span> <span style="color:#f92672">{</span>
   <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">hasPromoter</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
     <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>index <span style="color:#f92672">&gt;</span> 0xFFFF<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
       codeOut<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>
           InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">codeUnit</span><span style="color:#f92672">(</span>Opcodes<span style="color:#f92672">.</span><span style="color:#a6e22e">CONST_STRING_JUMBO</span><span style="color:#f92672">,</span> a<span style="color:#f92672">),</span>
           InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">unit0</span><span style="color:#f92672">(</span>index<span style="color:#f92672">),</span>
           InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">unit1</span><span style="color:#f92672">(</span>index<span style="color:#f92672">)</span>
       <span style="color:#f92672">);</span>
     <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
       <span style="color:#66d9ef">short</span> indexUnit <span style="color:#f92672">=</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">short</span><span style="color:#f92672">)</span> index<span style="color:#f92672">;</span>
       codeOut<span style="color:#f92672">.</span><span style="color:#a6e22e">write</span><span style="color:#f92672">(</span>InstructionCodec<span style="color:#f92672">.</span><span style="color:#a6e22e">codeUnit</span><span style="color:#f92672">(</span>opcode<span style="color:#f92672">,</span> a<span style="color:#f92672">),</span> indexUnit<span style="color:#f92672">);</span>
 <span style="color:#75715e">//写入到out字节码中的字符串 index 是new dex中的索引，这里把旧的 Code 字节码强行改变，所以在做对比的时候这两个的字节码是完全一样的，这个方法也不会将该方法打入补丁包中，这个过程对补丁包的大小影响很大，能减少好多原本没有改变的方法打入补丁包中   
</span><span style="color:#75715e"></span>     <span style="color:#f92672">}</span>
</code></pre></div><h2 id="参考">参考</h2>
<p><a href="https://www.zybuluo.com/dodola/note/554061">https://www.zybuluo.com/dodola/note/554061</a></p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/resource.arsc%E7%94%9F%E6%88%90%E5%92%8C%E7%BB%93%E6%9E%84/" title="Resource.arsc生成和结构"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/en/android/%E7%83%AD%E4%BF%AE%E5%A4%8D%E5%AD%97%E8%8A%82%E7%A0%81/tinker/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/tinkersource/" title="TinkerSource" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1623725418"></script>
    <script src="/js/perfect-scrollbar.min.js?1623725418"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1623725418"></script>
    <script src="/js/jquery.sticky.js?1623725418"></script>
    <script src="/js/featherlight.min.js?1623725418"></script>
    <script src="/js/highlight.pack.js?1623725418"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1623725418"></script>
    <script src="/js/learn.js?1623725418"></script>
    <script src="/js/hugo-learn.js?1623725418"></script>
    
        
            <script src="/mermaid/mermaid.js?1623725418"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

